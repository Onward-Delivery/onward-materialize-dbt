

============================== 2022-11-30 21:57:05.278386 | 65011b94-4722-47b3-9864-a96d8e0daab7 ==============================
[0m21:57:05.278399 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:57:05.278631 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_name': 'onward-materialize', 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m21:57:05.278722 [debug] [MainThread]: Tracking: tracking
[0m21:57:05.304607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f982859dc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f982859c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f982859ceb0>]}
[0m21:57:05.305510 [info ] [MainThread]: Setting up your profile.
[0m21:57:36.600694 [info ] [MainThread]: No sample profile found for materialize.
[0m21:57:36.601034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985a19b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985a199a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985a19ac80>]}
[0m21:57:36.601212 [debug] [MainThread]: Flushing usage events


============================== 2022-11-30 22:00:20.334156 | 17ff1ee8-e84c-4c57-83be-eca5afe2b090 ==============================
[0m22:00:20.334170 [info ] [MainThread]: Running with dbt=1.3.1
[0m22:00:20.334610 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_name': 'onward-materialize', 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m22:00:20.334706 [debug] [MainThread]: Tracking: tracking
[0m22:00:20.363208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca886b5cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca886b6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca886b6ce0>]}
[0m22:00:20.364315 [info ] [MainThread]: Setting up your profile.
[0m22:00:21.816692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca886b5240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca886b4430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5815fcd0>]}
[0m22:00:21.816944 [debug] [MainThread]: Flushing usage events


============================== 2022-11-30 22:01:20.796820 | cbb9001b-851b-4868-baf4-3f63967ad9ba ==============================
[0m22:01:20.796833 [info ] [MainThread]: Running with dbt=1.3.1
[0m22:01:20.797228 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
[0m22:01:20.797321 [debug] [MainThread]: Tracking: tracking
[0m22:01:20.822282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64a6f6fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64a6f77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64a6f7400>]}
[0m22:01:20.823286 [info ] [MainThread]: To view your profiles.yml file, run:

open /Users/claytonvanhovel/Desktop/onward-materialize-dbt
[0m22:01:20.823692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64a6f77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64a6f7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64a6f7df0>]}
[0m22:01:20.823845 [debug] [MainThread]: Flushing usage events


============================== 2022-11-30 23:40:37.116530 | 344d003c-87fe-49e4-ae60-417174748ba9 ==============================
[0m23:40:37.116541 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:40:37.116939 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
[0m23:40:37.117046 [debug] [MainThread]: Tracking: tracking
[0m23:40:37.153121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a221ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a221f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a221f1f0>]}
[0m23:40:37.154074 [info ] [MainThread]: To view your profiles.yml file, run:

open /Users/claytonvanhovel/Desktop/onward-materialize-dbt
[0m23:40:37.154432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a221f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a221f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a221fe50>]}
[0m23:40:37.154572 [debug] [MainThread]: Flushing usage events


============================== 2022-11-30 23:43:19.468005 | cd9b6005-bb63-4c9e-a6da-869d15f7311a ==============================
[0m23:43:19.468017 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:43:19.468420 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
[0m23:43:19.468516 [debug] [MainThread]: Tracking: tracking
[0m23:43:19.494763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9294ceb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9294cf250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9294cedd0>]}
[0m23:43:19.495847 [info ] [MainThread]: To view your profiles.yml file, run:

open /Users/claytonvanhovel/Desktop/onward-materialize-dbt
[0m23:43:19.496131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9294cf250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9294cedd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9294cf820>]}
[0m23:43:19.496281 [debug] [MainThread]: Flushing usage events


============================== 2022-11-30 23:47:59.009637 | 31873c44-4c7a-4d9b-8fc9-35a36fea41c6 ==============================
[0m23:47:59.009703 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:47:59.011006 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:47:59.011152 [debug] [MainThread]: Tracking: tracking
[0m23:47:59.051867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea2fa830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea2f8e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea2fa950>]}
[0m23:47:59.064680 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m23:47:59.064918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '31873c44-4c7a-4d9b-8fc9-35a36fea41c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea2f8fd0>]}
[0m23:47:59.081406 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
[0m23:47:59.082992 [debug] [MainThread]: Parsing macros/catalog.sql
[0m23:47:59.084283 [debug] [MainThread]: Parsing macros/adapters.sql
[0m23:47:59.091152 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
[0m23:47:59.093290 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m23:47:59.096343 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m23:47:59.102483 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m23:47:59.104542 [debug] [MainThread]: Parsing macros/materializations/source.sql
[0m23:47:59.106545 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m23:47:59.108522 [debug] [MainThread]: Parsing macros/materializations/sink.sql
[0m23:47:59.110447 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m23:47:59.111035 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m23:47:59.112190 [debug] [MainThread]: Parsing macros/catalog.sql
[0m23:47:59.113636 [debug] [MainThread]: Parsing macros/relations.sql
[0m23:47:59.114546 [debug] [MainThread]: Parsing macros/adapters.sql
[0m23:47:59.130474 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m23:47:59.131172 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m23:47:59.132205 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:47:59.132578 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:47:59.133494 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:47:59.138363 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:47:59.138660 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:47:59.139433 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:47:59.140075 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m23:47:59.142446 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m23:47:59.143868 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m23:47:59.144898 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m23:47:59.155608 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m23:47:59.164394 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m23:47:59.172263 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m23:47:59.175124 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m23:47:59.176245 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m23:47:59.177368 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m23:47:59.182555 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m23:47:59.192907 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m23:47:59.193884 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m23:47:59.198138 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m23:47:59.204984 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m23:47:59.216132 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m23:47:59.219699 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m23:47:59.221820 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m23:47:59.225408 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m23:47:59.226180 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m23:47:59.228278 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m23:47:59.229668 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m23:47:59.234206 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m23:47:59.246263 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m23:47:59.247162 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m23:47:59.248688 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m23:47:59.249619 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m23:47:59.250165 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m23:47:59.250652 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m23:47:59.251071 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m23:47:59.251897 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m23:47:59.255191 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m23:47:59.260551 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m23:47:59.261033 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m23:47:59.261789 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m23:47:59.262367 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m23:47:59.262920 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:47:59.263669 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m23:47:59.264159 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m23:47:59.264779 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m23:47:59.265510 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:47:59.266945 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:47:59.267688 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m23:47:59.268324 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m23:47:59.268952 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m23:47:59.269563 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:47:59.270116 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m23:47:59.270763 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m23:47:59.271308 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m23:47:59.276960 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m23:47:59.277619 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m23:47:59.278179 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:47:59.279254 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:47:59.280595 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m23:47:59.281222 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m23:47:59.282119 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m23:47:59.282750 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m23:47:59.284021 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m23:47:59.286135 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m23:47:59.288029 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m23:47:59.297573 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m23:47:59.298793 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m23:47:59.307334 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m23:47:59.310097 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m23:47:59.314602 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m23:47:59.320785 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m23:47:59.324622 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m23:47:59.503863 [debug] [MainThread]: 1699: static parser successfully parsed sources/driver_location.sql
[0m23:47:59.549056 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

[0m23:47:59.552531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31873c44-4c7a-4d9b-8fc9-35a36fea41c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f8853700>]}
[0m23:47:59.557586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31873c44-4c7a-4d9b-8fc9-35a36fea41c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea2f00d0>]}
[0m23:47:59.557787 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m23:47:59.557948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31873c44-4c7a-4d9b-8fc9-35a36fea41c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea3c1e40>]}
[0m23:47:59.558817 [info ] [MainThread]: 
[0m23:47:59.559223 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m23:47:59.559858 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m23:47:59.567367 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m23:47:59.567527 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m23:47:59.567616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:01.268607 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.7 seconds
[0m23:48:01.276785 [debug] [ThreadPool]: On list_materialize: Close
[0m23:48:01.279315 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m23:48:01.287109 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m23:48:01.287343 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m23:48:01.287499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:48:02.963345 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.68 seconds
[0m23:48:02.968985 [debug] [ThreadPool]: On list_materialize_public: Close
[0m23:48:02.970631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31873c44-4c7a-4d9b-8fc9-35a36fea41c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f883fa90>]}
[0m23:48:02.971465 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m23:48:02.971783 [info ] [MainThread]: 
[0m23:48:02.978615 [debug] [Thread-1 (]: Began running node model.onward_materialize.driver_location
[0m23:48:02.979038 [info ] [Thread-1 (]: 1 of 1 START sql source model public.driver_location ........................... [RUN]
[0m23:48:02.979797 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.driver_location"
[0m23:48:02.979942 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.driver_location
[0m23:48:02.980073 [debug] [Thread-1 (]: Compiling model.onward_materialize.driver_location
[0m23:48:02.982905 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.driver_location"
[0m23:48:02.983695 [debug] [Thread-1 (]: finished collecting timing info
[0m23:48:02.983866 [debug] [Thread-1 (]: Began executing node model.onward_materialize.driver_location
[0m23:48:02.999123 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.driver_location"
[0m23:48:02.999348 [debug] [Thread-1 (]: On model.onward_materialize.driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.driver_location"} */

      drop source if exists "materialize"."public"."driver_location" cascade
    
[0m23:48:02.999470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:04.540275 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.54 seconds
[0m23:48:04.553164 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.driver_location"
[0m23:48:04.554272 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.driver_location"
[0m23:48:04.554443 [debug] [Thread-1 (]: On model.onward_materialize.driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.driver_location"} */


CREATE SOURCE driver_location
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m23:48:05.677605 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.12 seconds
[0m23:48:05.695338 [debug] [Thread-1 (]: finished collecting timing info
[0m23:48:05.695723 [debug] [Thread-1 (]: On model.onward_materialize.driver_location: Close
[0m23:48:05.696701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31873c44-4c7a-4d9b-8fc9-35a36fea41c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea44bc10>]}
[0m23:48:05.697194 [info ] [Thread-1 (]: 1 of 1 OK created sql source model public.driver_location ...................... [[32mCREATE SOURCE[0m in 2.72s]
[0m23:48:05.699529 [debug] [Thread-1 (]: Finished running node model.onward_materialize.driver_location
[0m23:48:05.701191 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m23:48:05.701795 [info ] [MainThread]: 
[0m23:48:05.702066 [info ] [MainThread]: Finished running 1 source model in 0 hours 0 minutes and 6.14 seconds (6.14s).
[0m23:48:05.702314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:05.702444 [debug] [MainThread]: Connection 'model.onward_materialize.driver_location' was properly closed.
[0m23:48:05.712689 [info ] [MainThread]: 
[0m23:48:05.713042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:05.713302 [info ] [MainThread]: 
[0m23:48:05.713515 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:48:05.713879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea44a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea44b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea449c90>]}
[0m23:48:05.714155 [debug] [MainThread]: Flushing usage events


============================== 2022-11-30 23:50:53.032355 | 96fda9e9-154c-4290-8351-63c661247e7c ==============================
[0m23:50:53.032686 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:50:53.033719 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:50:53.033868 [debug] [MainThread]: Tracking: tracking
[0m23:50:53.058120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c2291d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c2292530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c2291ea0>]}
[0m23:50:53.086568 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:50:53.086847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '96fda9e9-154c-4290-8351-63c661247e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c0b40be0>]}
[0m23:50:53.102790 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
[0m23:50:53.104197 [debug] [MainThread]: Parsing macros/catalog.sql
[0m23:50:53.105420 [debug] [MainThread]: Parsing macros/adapters.sql
[0m23:50:53.111988 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
[0m23:50:53.114046 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m23:50:53.116861 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m23:50:53.122821 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m23:50:53.124946 [debug] [MainThread]: Parsing macros/materializations/source.sql
[0m23:50:53.126924 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m23:50:53.128837 [debug] [MainThread]: Parsing macros/materializations/sink.sql
[0m23:50:53.130685 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m23:50:53.131239 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m23:50:53.132332 [debug] [MainThread]: Parsing macros/catalog.sql
[0m23:50:53.133695 [debug] [MainThread]: Parsing macros/relations.sql
[0m23:50:53.134572 [debug] [MainThread]: Parsing macros/adapters.sql
[0m23:50:53.149438 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m23:50:53.150047 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m23:50:53.151081 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:50:53.151447 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:50:53.152314 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:50:53.156414 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:50:53.156696 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:50:53.157429 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:50:53.158053 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m23:50:53.160350 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m23:50:53.161725 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m23:50:53.162699 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m23:50:53.172818 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m23:50:53.180897 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m23:50:53.188411 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m23:50:53.191173 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m23:50:53.192220 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m23:50:53.193286 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m23:50:53.198168 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m23:50:53.207723 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m23:50:53.208625 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m23:50:53.212839 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m23:50:53.219379 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m23:50:53.229859 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m23:50:53.233251 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m23:50:53.235334 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m23:50:53.238695 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m23:50:53.239455 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m23:50:53.241507 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m23:50:53.242842 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m23:50:53.247131 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m23:50:53.258444 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m23:50:53.259322 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m23:50:53.260796 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m23:50:53.261703 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m23:50:53.262236 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m23:50:53.262708 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m23:50:53.263105 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m23:50:53.263905 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m23:50:53.267118 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m23:50:53.272219 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m23:50:53.272696 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m23:50:53.273419 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m23:50:53.273977 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m23:50:53.274521 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:50:53.275262 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m23:50:53.275747 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m23:50:53.276349 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m23:50:53.277082 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:50:53.278510 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:50:53.279263 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m23:50:53.279924 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m23:50:53.280576 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m23:50:53.281203 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:50:53.281761 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m23:50:53.282404 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m23:50:53.282953 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m23:50:53.288508 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m23:50:53.289264 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m23:50:53.289843 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:50:53.290927 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:50:53.292239 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m23:50:53.292849 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m23:50:53.293745 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m23:50:53.294387 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m23:50:53.295695 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m23:50:53.297675 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m23:50:53.299357 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m23:50:53.308389 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m23:50:53.309566 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m23:50:53.318050 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m23:50:53.320711 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m23:50:53.325030 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m23:50:53.330954 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m23:50:53.334678 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m23:50:53.509519 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m23:50:53.517594 [debug] [MainThread]: 1699: static parser successfully parsed sources/src_driver_location.sql
[0m23:50:53.537337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c242d3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c2435fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c24358a0>]}
[0m23:50:53.537544 [debug] [MainThread]: Flushing usage events
[0m23:50:53.916899 [error] [MainThread]: Encountered an error:
Compilation Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Model 'model.onward_materialize.json_driver_location' (models/materializedviews/json_driver_location.sql) depends on a node named 'driver_location' which was not found


============================== 2022-11-30 23:51:14.613020 | 6d78ed16-608f-4ff7-9666-6b0d357ff016 ==============================
[0m23:51:14.613074 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:51:14.613791 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:51:14.613936 [debug] [MainThread]: Tracking: tracking
[0m23:51:14.642177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3a2fd6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3a2fde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3a2ff700>]}
[0m23:51:14.671721 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:51:14.672018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d78ed16-608f-4ff7-9666-6b0d357ff016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c187d8be0>]}
[0m23:51:14.688188 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
[0m23:51:14.689723 [debug] [MainThread]: Parsing macros/catalog.sql
[0m23:51:14.691120 [debug] [MainThread]: Parsing macros/adapters.sql
[0m23:51:14.698145 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
[0m23:51:14.700260 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m23:51:14.703188 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m23:51:14.709228 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m23:51:14.711350 [debug] [MainThread]: Parsing macros/materializations/source.sql
[0m23:51:14.713425 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m23:51:14.715378 [debug] [MainThread]: Parsing macros/materializations/sink.sql
[0m23:51:14.717254 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m23:51:14.717834 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m23:51:14.719135 [debug] [MainThread]: Parsing macros/catalog.sql
[0m23:51:14.720641 [debug] [MainThread]: Parsing macros/relations.sql
[0m23:51:14.721576 [debug] [MainThread]: Parsing macros/adapters.sql
[0m23:51:14.737320 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m23:51:14.737937 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m23:51:14.738999 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:51:14.739367 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:51:14.740268 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:51:14.744609 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:51:14.744904 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:51:14.745660 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:51:14.746291 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m23:51:14.748629 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m23:51:14.750098 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m23:51:14.751303 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m23:51:14.761935 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m23:51:14.770668 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m23:51:14.778599 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m23:51:14.781475 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m23:51:14.782564 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m23:51:14.783632 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m23:51:14.789149 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m23:51:14.800271 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m23:51:14.801256 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m23:51:14.805504 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m23:51:14.812638 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m23:51:14.824096 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m23:51:14.827650 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m23:51:14.829846 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m23:51:14.833389 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m23:51:14.834165 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m23:51:14.836282 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m23:51:14.837655 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m23:51:14.842133 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m23:51:14.854126 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m23:51:14.855019 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m23:51:14.856562 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m23:51:14.857556 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m23:51:14.858098 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m23:51:14.858579 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m23:51:14.858980 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m23:51:14.859795 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m23:51:14.863100 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m23:51:14.868449 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m23:51:14.868943 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m23:51:14.869666 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m23:51:14.870231 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m23:51:14.870813 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:51:14.871555 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m23:51:14.872065 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m23:51:14.872677 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m23:51:14.873419 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:51:14.874836 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:51:14.875586 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m23:51:14.876219 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m23:51:14.876845 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m23:51:14.877456 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:51:14.878004 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m23:51:14.878649 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m23:51:14.879188 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m23:51:14.883531 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m23:51:14.884162 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m23:51:14.884700 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:51:14.885797 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:51:14.887142 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m23:51:14.887748 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m23:51:14.888639 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m23:51:14.889274 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m23:51:14.890550 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m23:51:14.892559 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m23:51:14.894255 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m23:51:14.903692 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m23:51:14.904881 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m23:51:14.913444 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m23:51:14.916154 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m23:51:14.920678 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m23:51:14.926855 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m23:51:14.930719 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m23:51:15.105590 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m23:51:15.113671 [debug] [MainThread]: 1699: static parser successfully parsed sources/src_driver_location.sql
[0m23:51:15.156147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d78ed16-608f-4ff7-9666-6b0d357ff016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2826d720>]}
[0m23:51:15.161158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d78ed16-608f-4ff7-9666-6b0d357ff016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3a204460>]}
[0m23:51:15.161352 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m23:51:15.161525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d78ed16-608f-4ff7-9666-6b0d357ff016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2825a980>]}
[0m23:51:15.162490 [info ] [MainThread]: 
[0m23:51:15.162893 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m23:51:15.163576 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m23:51:15.170937 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m23:51:15.171094 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m23:51:15.171189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:16.813903 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.64 seconds
[0m23:51:16.818912 [debug] [ThreadPool]: On list_materialize: Close
[0m23:51:16.821354 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m23:51:16.827962 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m23:51:16.828173 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m23:51:16.828325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:18.380116 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.55 seconds
[0m23:51:18.385147 [debug] [ThreadPool]: On list_materialize_public: Close
[0m23:51:18.386777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d78ed16-608f-4ff7-9666-6b0d357ff016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c282a7430>]}
[0m23:51:18.387794 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m23:51:18.388143 [info ] [MainThread]: 
[0m23:51:18.394457 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m23:51:18.394757 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m23:51:18.395636 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m23:51:18.395824 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m23:51:18.396012 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m23:51:18.399695 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m23:51:18.400256 [debug] [Thread-1 (]: finished collecting timing info
[0m23:51:18.400435 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m23:51:18.414897 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m23:51:18.415371 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m23:51:18.415512 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE driver_location
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m23:51:18.415647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:20.497290 [debug] [Thread-1 (]: Postgres adapter: Postgres error: catalog item 'driver_location' already exists

[0m23:51:20.499688 [debug] [Thread-1 (]: finished collecting timing info
[0m23:51:20.500172 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m23:51:20.501979 [debug] [Thread-1 (]: Database Error in model src_driver_location (models/sources/src_driver_location.sql)
  catalog item 'driver_location' already exists
  compiled Code at target/run/onward_materialize/models/sources/src_driver_location.sql
[0m23:51:20.502617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d78ed16-608f-4ff7-9666-6b0d357ff016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3a480e80>]}
[0m23:51:20.503205 [error] [Thread-1 (]: 1 of 2 ERROR creating sql source model public.src_driver_location .............. [[31mERROR[0m in 2.11s]
[0m23:51:20.505653 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m23:51:20.506657 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m23:51:20.506872 [info ] [Thread-1 (]: 2 of 2 SKIP relation public.json_driver_location ............................... [[33mSKIP[0m]
[0m23:51:20.507252 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m23:51:20.508449 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m23:51:20.509074 [info ] [MainThread]: 
[0m23:51:20.509341 [info ] [MainThread]: Finished running 1 source model, 1 materializedview model in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m23:51:20.509593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:20.509720 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m23:51:20.518178 [info ] [MainThread]: 
[0m23:51:20.518472 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:51:20.518733 [info ] [MainThread]: 
[0m23:51:20.518959 [error] [MainThread]: [33mDatabase Error in model src_driver_location (models/sources/src_driver_location.sql)[0m
[0m23:51:20.519186 [error] [MainThread]:   catalog item 'driver_location' already exists
[0m23:51:20.519396 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/sources/src_driver_location.sql
[0m23:51:20.519620 [info ] [MainThread]: 
[0m23:51:20.519844 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m23:51:20.520185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2826e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2826dd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3a4803d0>]}
[0m23:51:20.520438 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 17:43:48.558376 | cf9d5f86-85be-4667-be48-99059f9c80fa ==============================
[0m17:43:48.558447 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:43:48.559605 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m17:43:48.559806 [debug] [MainThread]: Tracking: tracking
[0m17:43:48.597226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32925750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32925de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32924760>]}
[0m17:43:48.645104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:43:48.645273 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:43:48.649994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf9d5f86-85be-4667-be48-99059f9c80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32ad8610>]}
[0m17:43:48.655653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf9d5f86-85be-4667-be48-99059f9c80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32aad570>]}
[0m17:43:48.655864 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m17:43:48.656039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf9d5f86-85be-4667-be48-99059f9c80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32aad600>]}
[0m17:43:48.656988 [info ] [MainThread]: 
[0m17:43:48.657398 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:43:48.658052 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m17:43:48.665648 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m17:43:48.665784 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m17:43:48.665877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:50.276675 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.61 seconds
[0m17:43:50.282861 [debug] [ThreadPool]: On list_materialize_public: Close
[0m17:43:50.284759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf9d5f86-85be-4667-be48-99059f9c80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32a8ff70>]}
[0m17:43:50.285594 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m17:43:50.285913 [info ] [MainThread]: 
[0m17:43:50.291427 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m17:43:50.292094 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m17:43:50.292297 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m17:43:50.292511 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m17:43:50.296583 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m17:43:50.298134 [debug] [Thread-1 (]: finished collecting timing info
[0m17:43:50.298323 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m17:43:50.298567 [debug] [Thread-1 (]: finished collecting timing info
[0m17:43:50.299370 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m17:43:50.300048 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m17:43:50.300589 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m17:43:50.300754 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m17:43:50.300889 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m17:43:50.304204 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m17:43:50.304853 [debug] [Thread-1 (]: finished collecting timing info
[0m17:43:50.305024 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m17:43:50.305174 [debug] [Thread-1 (]: finished collecting timing info
[0m17:43:50.305782 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m17:43:50.306832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:50.307037 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m17:43:50.314125 [info ] [MainThread]: Done.
[0m17:43:50.317330 [debug] [MainThread]: Acquiring new materialize connection "generate_catalog"
[0m17:43:50.317482 [info ] [MainThread]: Building catalog
[0m17:43:50.319003 [debug] [ThreadPool]: Acquiring new materialize connection "materialize.information_schema"
[0m17:43:50.325298 [debug] [ThreadPool]: Using materialize connection "materialize.information_schema"
[0m17:43:50.325503 [debug] [ThreadPool]: On materialize.information_schema: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "materialize.information_schema"} */
select
            d.name as table_database,
            s.name as table_schema,
            o.name as table_name,
            case when o.type = 'materialized-view' then 'materializedview' else o.type end as table_type,
            '' as table_comment,
            c.name as column_name,
            c.position as column_index,
            c.type as column_type,
            '' as column_comment,
            '' as table_owner
        from mz_objects o
        join mz_schemas s on o.schema_id = s.id
        join mz_databases d on s.database_id = d.id and d.name = 'materialize'
        join mz_columns c on c.id = o.id
        where s.name in ('public')
[0m17:43:50.325615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:51.655159 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.33 seconds
[0m17:43:51.664856 [debug] [ThreadPool]: On materialize.information_schema: Close
[0m17:43:51.675996 [info ] [MainThread]: Catalog written to /Users/claytonvanhovel/Desktop/onward-materialize-dbt/target/catalog.json
[0m17:43:51.676519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32925750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc104aa740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc104aa4a0>]}
[0m17:43:51.676846 [debug] [MainThread]: Flushing usage events
[0m17:43:52.042708 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:43:52.043312 [debug] [MainThread]: Connection 'materialize.information_schema' was properly closed.


============================== 2022-12-01 17:43:56.387046 | 0547d36c-1605-4f08-bea6-cca23fec0295 ==============================
[0m17:43:56.387118 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:43:56.387617 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m17:43:56.387737 [debug] [MainThread]: Tracking: tracking
[0m17:43:56.406823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda297fa920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda297fb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda297f9480>]}
[0m17:43:56.408846 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m17:43:56.409059 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m17:43:56.409204 [info ] [MainThread]: 
[0m17:43:56.409350 [info ] [MainThread]: 
[0m17:43:56.409489 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-12-01 17:58:40.190681 | 8fe1c4cb-a864-4cad-9cf6-347cadb45948 ==============================
[0m17:58:40.190723 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:58:40.191241 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:58:40.191360 [debug] [MainThread]: Tracking: tracking
[0m17:58:40.217963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd2801a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd2802230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd2801b70>]}
[0m17:58:40.261702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:58:40.262014 [debug] [MainThread]: Partial parsing: deleted source source.onward_materialize.kafka.driver_location
[0m17:58:40.262118 [debug] [MainThread]: Partial parsing: deleted source source.onward_materialize.postgres.postgres_table_a
[0m17:58:40.262198 [debug] [MainThread]: Partial parsing: deleted source source.onward_materialize.postgres.postgres_table_b
[0m17:58:40.262284 [debug] [MainThread]: Partial parsing: update schema file: onward_materialize://models/schema.yml
[0m17:58:40.262449 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m17:58:40.262591 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m17:58:40.273634 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m17:58:40.283031 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m17:58:40.285727 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m17:58:40.306984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fe1c4cb-a864-4cad-9cf6-347cadb45948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb042da80>]}
[0m17:58:40.312018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fe1c4cb-a864-4cad-9cf6-347cadb45948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb03c4520>]}
[0m17:58:40.312205 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:58:40.312371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fe1c4cb-a864-4cad-9cf6-347cadb45948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb03c5420>]}
[0m17:58:40.313195 [info ] [MainThread]: 
[0m17:58:40.313583 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:58:40.314222 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m17:58:40.321333 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m17:58:40.321497 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m17:58:40.321582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:41.825440 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.5 seconds
[0m17:58:41.831140 [debug] [ThreadPool]: On list_materialize: Close
[0m17:58:41.834501 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m17:58:41.842536 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m17:58:41.842790 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m17:58:41.842947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:43.262430 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.42 seconds
[0m17:58:43.267582 [debug] [ThreadPool]: On list_materialize_public: Close
[0m17:58:43.269296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fe1c4cb-a864-4cad-9cf6-347cadb45948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb03affd0>]}
[0m17:58:43.270143 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m17:58:43.270465 [info ] [MainThread]: 
[0m17:58:43.276865 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m17:58:43.277579 [info ] [Thread-1 (]: 1 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m17:58:43.278301 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m17:58:43.278475 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m17:58:43.278661 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m17:58:43.282696 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m17:58:43.283385 [debug] [Thread-1 (]: finished collecting timing info
[0m17:58:43.283569 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m17:58:43.299609 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m17:58:43.300229 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m17:58:43.300372 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    



 CREATE VIEW json_driver_location AS
  SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location";
  );
[0m17:58:43.300503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:44.608379 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected SELECT, VALUES, or a subquery in the query body, found CREATE
LINE 11:  CREATE VIEW json_driver_location AS
          ^

[0m17:58:44.610815 [debug] [Thread-1 (]: finished collecting timing info
[0m17:58:44.611249 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m17:58:44.612452 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Expected SELECT, VALUES, or a subquery in the query body, found CREATE
  LINE 11:  CREATE VIEW json_driver_location AS
            ^
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m17:58:44.612876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fe1c4cb-a864-4cad-9cf6-347cadb45948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb03affd0>]}
[0m17:58:44.613414 [error] [Thread-1 (]: 1 of 2 ERROR creating sql materializedview model public.json_driver_location ... [[31mERROR[0m in 1.33s]
[0m17:58:44.614938 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m17:58:44.615186 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m17:58:44.615435 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m17:58:44.616133 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m17:58:44.616477 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m17:58:44.616662 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m17:58:44.620153 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m17:58:44.620771 [debug] [Thread-1 (]: finished collecting timing info
[0m17:58:44.620942 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m17:58:44.632523 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m17:58:44.633008 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m17:58:44.633122 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m17:58:44.633221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:46.942940 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 2.31 seconds
[0m17:58:46.959243 [debug] [Thread-1 (]: finished collecting timing info
[0m17:58:46.959600 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m17:58:46.960453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fe1c4cb-a864-4cad-9cf6-347cadb45948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd29c6980>]}
[0m17:58:46.960857 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.34s]
[0m17:58:46.961277 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m17:58:46.962536 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:58:46.963065 [info ] [MainThread]: 
[0m17:58:46.963328 [info ] [MainThread]: Finished running 1 materializedview model, 1 source model in 0 hours 0 minutes and 6.65 seconds (6.65s).
[0m17:58:46.963572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:46.963701 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m17:58:46.971434 [info ] [MainThread]: 
[0m17:58:46.971750 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:58:46.972041 [info ] [MainThread]: 
[0m17:58:46.972290 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m17:58:46.972500 [error] [MainThread]:   Expected SELECT, VALUES, or a subquery in the query body, found CREATE
[0m17:58:46.972693 [error] [MainThread]:   LINE 11:  CREATE VIEW json_driver_location AS
[0m17:58:46.972885 [error] [MainThread]:             ^
[0m17:58:46.973074 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m17:58:46.973281 [info ] [MainThread]: 
[0m17:58:46.973497 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:58:46.973779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd29af5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb03d4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd29388e0>]}
[0m17:58:46.973991 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 17:59:15.121983 | 743b16ee-44fa-478e-a264-ff5486b6b450 ==============================
[0m17:59:15.122027 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:59:15.122616 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:59:15.122752 [debug] [MainThread]: Tracking: tracking
[0m17:59:15.148128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb92102980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb921030a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb921015a0>]}
[0m17:59:15.194570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:59:15.194925 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m17:59:15.204646 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m17:59:15.227526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '743b16ee-44fa-478e-a264-ff5486b6b450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8072c0d0>]}
[0m17:59:15.232561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '743b16ee-44fa-478e-a264-ff5486b6b450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9228c730>]}
[0m17:59:15.232762 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:59:15.232944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743b16ee-44fa-478e-a264-ff5486b6b450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb922adc00>]}
[0m17:59:15.233875 [info ] [MainThread]: 
[0m17:59:15.234325 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:59:15.235078 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m17:59:15.242389 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m17:59:15.242550 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m17:59:15.242639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:17.315001 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.07 seconds
[0m17:59:17.322657 [debug] [ThreadPool]: On list_materialize: Close
[0m17:59:17.325744 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m17:59:17.333084 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m17:59:17.333233 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m17:59:17.333320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:18.645293 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.31 seconds
[0m17:59:18.650867 [debug] [ThreadPool]: On list_materialize_public: Close
[0m17:59:18.652437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743b16ee-44fa-478e-a264-ff5486b6b450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb922bfd60>]}
[0m17:59:18.653287 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m17:59:18.653661 [info ] [MainThread]: 
[0m17:59:18.659909 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m17:59:18.660436 [info ] [Thread-1 (]: 1 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m17:59:18.660999 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m17:59:18.661195 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m17:59:18.661405 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m17:59:18.665896 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m17:59:18.666828 [debug] [Thread-1 (]: finished collecting timing info
[0m17:59:18.667061 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m17:59:18.684600 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m17:59:18.685250 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m17:59:18.685430 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    


  SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location";
  );
[0m17:59:18.685579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:20.016806 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected joined table, found comma
LINE 17:   FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS dat...
                           ^

[0m17:59:20.019381 [debug] [Thread-1 (]: finished collecting timing info
[0m17:59:20.019818 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m17:59:20.021414 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Expected joined table, found comma
  LINE 17:   FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS dat...
                             ^
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m17:59:20.022046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '743b16ee-44fa-478e-a264-ff5486b6b450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb922bfd60>]}
[0m17:59:20.022642 [error] [Thread-1 (]: 1 of 2 ERROR creating sql materializedview model public.json_driver_location ... [[31mERROR[0m in 1.36s]
[0m17:59:20.023681 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m17:59:20.023935 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m17:59:20.024459 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m17:59:20.025234 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m17:59:20.025408 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m17:59:20.025576 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m17:59:20.029690 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m17:59:20.030511 [debug] [Thread-1 (]: finished collecting timing info
[0m17:59:20.030689 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m17:59:20.047108 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m17:59:20.047327 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m17:59:20.047455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:21.527034 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.48 seconds
[0m17:59:21.533210 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m17:59:21.534277 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m17:59:21.534480 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m17:59:22.766107 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.23 seconds
[0m17:59:22.783262 [debug] [Thread-1 (]: finished collecting timing info
[0m17:59:22.783612 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m17:59:22.784549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '743b16ee-44fa-478e-a264-ff5486b6b450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb807e3b80>]}
[0m17:59:22.784945 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.76s]
[0m17:59:22.785379 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m17:59:22.786658 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:59:22.787213 [info ] [MainThread]: 
[0m17:59:22.787508 [info ] [MainThread]: Finished running 1 materializedview model, 1 source model in 0 hours 0 minutes and 7.55 seconds (7.55s).
[0m17:59:22.787759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:22.787884 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m17:59:22.795697 [info ] [MainThread]: 
[0m17:59:22.795991 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:59:22.796252 [info ] [MainThread]: 
[0m17:59:22.796461 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m17:59:22.796664 [error] [MainThread]:   Expected joined table, found comma
[0m17:59:22.796862 [error] [MainThread]:   LINE 17:   FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS dat...
[0m17:59:22.797056 [error] [MainThread]:                              ^
[0m17:59:22.797244 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m17:59:22.797449 [info ] [MainThread]: 
[0m17:59:22.797656 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:59:22.797939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb922adc00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb807eba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb807e9630>]}
[0m17:59:22.798149 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:02:44.048240 | e20110ad-abd9-4d60-ac2b-4c7e61423506 ==============================
[0m18:02:44.048422 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:02:44.049132 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:02:44.049253 [debug] [MainThread]: Tracking: tracking
[0m18:02:44.078477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa642980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa6430a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa6415a0>]}
[0m18:02:44.122872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:02:44.123201 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m18:02:44.132660 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m18:02:44.153958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e20110ad-abd9-4d60-ac2b-4c7e61423506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde85240d0>]}
[0m18:02:44.158684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e20110ad-abd9-4d60-ac2b-4c7e61423506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa774910>]}
[0m18:02:44.158887 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:02:44.159056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e20110ad-abd9-4d60-ac2b-4c7e61423506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa799c00>]}
[0m18:02:44.159931 [info ] [MainThread]: 
[0m18:02:44.160321 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:02:44.160987 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m18:02:44.168041 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m18:02:44.168178 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m18:02:44.168272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:45.690437 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.52 seconds
[0m18:02:45.700560 [debug] [ThreadPool]: On list_materialize: Close
[0m18:02:45.702538 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m18:02:45.707642 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m18:02:45.707811 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m18:02:45.707921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:47.330437 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.62 seconds
[0m18:02:47.335859 [debug] [ThreadPool]: On list_materialize_public: Close
[0m18:02:47.337528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e20110ad-abd9-4d60-ac2b-4c7e61423506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa7a7d60>]}
[0m18:02:47.338358 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:02:47.338683 [info ] [MainThread]: 
[0m18:02:47.345075 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m18:02:47.345781 [info ] [Thread-1 (]: 1 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m18:02:47.346555 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m18:02:47.346751 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m18:02:47.347004 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m18:02:47.351285 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m18:02:47.352262 [debug] [Thread-1 (]: finished collecting timing info
[0m18:02:47.352488 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m18:02:47.367930 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m18:02:47.368490 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m18:02:47.368637 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    

with

src_driver_location as (
    select key, CONVERT_FROM(data, 'utf8')::jsonb as data from "materialize"."public"."src_driver_location";
)

,final as (

  SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM src_driver_location;
)

select * from final;
  );
[0m18:02:47.368768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:48.669001 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected right parenthesis, found semicolon
LINE 12: ...b as data from "materialize"."public"."src_driver_location";
                                                                       ^

[0m18:02:48.670982 [debug] [Thread-1 (]: finished collecting timing info
[0m18:02:48.671381 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m18:02:48.672652 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Expected right parenthesis, found semicolon
  LINE 12: ...b as data from "materialize"."public"."src_driver_location";
                                                                         ^
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m18:02:48.673085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e20110ad-abd9-4d60-ac2b-4c7e61423506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa7a7d60>]}
[0m18:02:48.673636 [error] [Thread-1 (]: 1 of 2 ERROR creating sql materializedview model public.json_driver_location ... [[31mERROR[0m in 1.33s]
[0m18:02:48.674614 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m18:02:48.674854 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m18:02:48.675088 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m18:02:48.675817 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m18:02:48.676049 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m18:02:48.676233 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m18:02:48.680138 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m18:02:48.681867 [debug] [Thread-1 (]: finished collecting timing info
[0m18:02:48.682046 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m18:02:48.696305 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:02:48.696571 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m18:02:48.696739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:50.243999 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.55 seconds
[0m18:02:50.247535 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m18:02:50.248393 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:02:50.248556 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m18:02:51.463523 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.21 seconds
[0m18:02:51.480260 [debug] [Thread-1 (]: finished collecting timing info
[0m18:02:51.480587 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m18:02:51.481376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e20110ad-abd9-4d60-ac2b-4c7e61423506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde8525db0>]}
[0m18:02:51.481768 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.81s]
[0m18:02:51.482183 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m18:02:51.483400 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:02:51.483978 [info ] [MainThread]: 
[0m18:02:51.484281 [info ] [MainThread]: Finished running 1 materializedview model, 1 source model in 0 hours 0 minutes and 7.32 seconds (7.32s).
[0m18:02:51.484531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:51.484657 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m18:02:51.494049 [info ] [MainThread]: 
[0m18:02:51.494349 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:02:51.494610 [info ] [MainThread]: 
[0m18:02:51.494848 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m18:02:51.495079 [error] [MainThread]:   Expected right parenthesis, found semicolon
[0m18:02:51.495300 [error] [MainThread]:   LINE 12: ...b as data from "materialize"."public"."src_driver_location";
[0m18:02:51.495516 [error] [MainThread]:                                                                          ^
[0m18:02:51.495733 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m18:02:51.495951 [info ] [MainThread]: 
[0m18:02:51.496154 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:02:51.496439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa799c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde85e1720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde85e2110>]}
[0m18:02:51.496660 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:03:05.779663 | 7f03f511-95f7-411f-b8c0-36f9235dd11e ==============================
[0m18:03:05.779730 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:03:05.786586 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:03:05.786873 [debug] [MainThread]: Tracking: tracking
[0m18:03:05.812043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc402c2a9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc402c2af80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc402c28d90>]}
[0m18:03:05.856493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:03:05.856826 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m18:03:05.866272 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m18:03:05.887988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f03f511-95f7-411f-b8c0-36f9235dd11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f05c40d0>]}
[0m18:03:05.892845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f03f511-95f7-411f-b8c0-36f9235dd11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f052fe50>]}
[0m18:03:05.893066 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:03:05.893238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f03f511-95f7-411f-b8c0-36f9235dd11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc402c203d0>]}
[0m18:03:05.894164 [info ] [MainThread]: 
[0m18:03:05.894569 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:03:05.895256 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m18:03:05.902527 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m18:03:05.902683 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m18:03:05.902784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:07.331740 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.43 seconds
[0m18:03:07.337673 [debug] [ThreadPool]: On list_materialize: Close
[0m18:03:07.340296 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m18:03:07.348198 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m18:03:07.348426 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m18:03:07.348588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:08.716768 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.37 seconds
[0m18:03:08.722540 [debug] [ThreadPool]: On list_materialize_public: Close
[0m18:03:08.724079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f03f511-95f7-411f-b8c0-36f9235dd11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f052fa30>]}
[0m18:03:08.724753 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:03:08.724990 [info ] [MainThread]: 
[0m18:03:08.730988 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m18:03:08.731675 [info ] [Thread-1 (]: 1 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m18:03:08.732405 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m18:03:08.732593 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m18:03:08.732797 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m18:03:08.736788 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m18:03:08.737352 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:08.737541 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m18:03:08.754115 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m18:03:08.754755 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m18:03:08.754908 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    

with

src_driver_location as (
    select key, CONVERT_FROM(data, 'utf8')::jsonb as data from "materialize"."public"."src_driver_location"
)

,final as (

  SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM src_driver_location
)

select * from final;
  );
[0m18:03:08.755041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:10.088627 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected right parenthesis, found semicolon
LINE 27: select * from final;
                            ^

[0m18:03:10.091754 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:10.092241 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m18:03:10.094122 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Expected right parenthesis, found semicolon
  LINE 27: select * from final;
                              ^
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m18:03:10.094833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f03f511-95f7-411f-b8c0-36f9235dd11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f04fc790>]}
[0m18:03:10.095377 [error] [Thread-1 (]: 1 of 2 ERROR creating sql materializedview model public.json_driver_location ... [[31mERROR[0m in 1.36s]
[0m18:03:10.096370 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m18:03:10.096620 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m18:03:10.097077 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m18:03:10.097796 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m18:03:10.097979 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m18:03:10.098153 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m18:03:10.102418 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m18:03:10.103136 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:10.103312 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m18:03:10.120255 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:03:10.120510 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m18:03:10.120641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:11.556670 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.44 seconds
[0m18:03:11.563148 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m18:03:11.564148 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:03:11.564323 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m18:03:12.819554 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.25 seconds
[0m18:03:12.836945 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:12.837323 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m18:03:12.838216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f03f511-95f7-411f-b8c0-36f9235dd11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f067bc40>]}
[0m18:03:12.838669 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.74s]
[0m18:03:12.839138 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m18:03:12.840791 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:03:12.841388 [info ] [MainThread]: 
[0m18:03:12.841674 [info ] [MainThread]: Finished running 1 materializedview model, 1 source model in 0 hours 0 minutes and 6.95 seconds (6.95s).
[0m18:03:12.841935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:12.842061 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m18:03:12.851583 [info ] [MainThread]: 
[0m18:03:12.851889 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:03:12.852131 [info ] [MainThread]: 
[0m18:03:12.852346 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m18:03:12.852550 [error] [MainThread]:   Expected right parenthesis, found semicolon
[0m18:03:12.852747 [error] [MainThread]:   LINE 27: select * from final;
[0m18:03:12.852939 [error] [MainThread]:                               ^
[0m18:03:12.853131 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m18:03:12.853335 [info ] [MainThread]: 
[0m18:03:12.853543 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:03:12.853847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f0680af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f06805b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f0680fa0>]}
[0m18:03:12.854074 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:03:24.637909 | 152cefc5-b92e-4535-92fc-c0193ae0a55b ==============================
[0m18:03:24.638070 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:03:24.638593 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:03:24.638708 [debug] [MainThread]: Tracking: tracking
[0m18:03:24.662016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1cd9a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1cda230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1cd9b70>]}
[0m18:03:24.706315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:03:24.706643 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m18:03:24.716109 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m18:03:24.738211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '152cefc5-b92e-4535-92fc-c0193ae0a55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1dd40d0>]}
[0m18:03:24.744353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '152cefc5-b92e-4535-92fc-c0193ae0a55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe990ad7d60>]}
[0m18:03:24.744605 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:03:24.744780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '152cefc5-b92e-4535-92fc-c0193ae0a55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe990ac5c90>]}
[0m18:03:24.745873 [info ] [MainThread]: 
[0m18:03:24.746301 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:03:24.747051 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m18:03:24.754387 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m18:03:24.754519 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m18:03:24.754607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:26.141747 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.39 seconds
[0m18:03:26.147820 [debug] [ThreadPool]: On list_materialize: Close
[0m18:03:26.150611 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m18:03:26.158471 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m18:03:26.158658 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m18:03:26.158777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:27.531307 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.37 seconds
[0m18:03:27.538458 [debug] [ThreadPool]: On list_materialize_public: Close
[0m18:03:27.540243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '152cefc5-b92e-4535-92fc-c0193ae0a55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe990ad7fd0>]}
[0m18:03:27.541027 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:03:27.541277 [info ] [MainThread]: 
[0m18:03:27.546837 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m18:03:27.547514 [info ] [Thread-1 (]: 1 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m18:03:27.548265 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m18:03:27.548467 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m18:03:27.548674 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m18:03:27.553138 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m18:03:27.553744 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:27.553936 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m18:03:27.570066 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m18:03:27.570564 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m18:03:27.570709 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    

with

src_driver_location as (
    select key, CONVERT_FROM(data, 'utf8')::jsonb as data from "materialize"."public"."src_driver_location"
)

,final as (

  SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM src_driver_location
)

select * from final
  );
[0m18:03:27.570835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:29.084733 [debug] [Thread-1 (]: SQL status: CREATE MATERIALIZED VIEW in 1.51 seconds
[0m18:03:29.097530 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:29.097718 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m18:03:29.098270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '152cefc5-b92e-4535-92fc-c0193ae0a55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe990aa4790>]}
[0m18:03:29.098654 [info ] [Thread-1 (]: 1 of 2 OK created sql materializedview model public.json_driver_location ....... [[32mCREATE MATERIALIZED VIEW[0m in 1.55s]
[0m18:03:29.099382 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m18:03:29.099588 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m18:03:29.099905 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m18:03:29.100573 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m18:03:29.100741 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m18:03:29.100890 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m18:03:29.104266 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m18:03:29.104822 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:29.104994 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m18:03:29.119986 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:03:29.120232 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m18:03:29.120352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:30.484920 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.36 seconds
[0m18:03:30.491864 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m18:03:30.492783 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:03:30.492951 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m18:03:31.704420 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.21 seconds
[0m18:03:31.709013 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:31.709312 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m18:03:31.710223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '152cefc5-b92e-4535-92fc-c0193ae0a55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1dd5990>]}
[0m18:03:31.710661 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.61s]
[0m18:03:31.711101 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m18:03:31.712432 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:03:31.713034 [info ] [MainThread]: 
[0m18:03:31.713319 [info ] [MainThread]: Finished running 1 materializedview model, 1 source model in 0 hours 0 minutes and 6.97 seconds (6.97s).
[0m18:03:31.713583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:31.713720 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m18:03:31.722980 [info ] [MainThread]: 
[0m18:03:31.723359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:03:31.723651 [info ] [MainThread]: 
[0m18:03:31.723894 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:03:31.724264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1e99e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1e9a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1e9a440>]}
[0m18:03:31.724527 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:04:06.464574 | 32863423-f02a-4bdd-9b95-42385e5c2422 ==============================
[0m18:04:06.464641 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:04:06.465109 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m18:04:06.465224 [debug] [MainThread]: Tracking: tracking
[0m18:04:06.485985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0a9d1d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0a9d2530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0a9d1ea0>]}
[0m18:04:06.529607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:04:06.529796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:04:06.534658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32863423-f02a-4bdd-9b95-42385e5c2422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd8258280>]}
[0m18:04:06.539419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32863423-f02a-4bdd-9b95-42385e5c2422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd822d240>]}
[0m18:04:06.539616 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:04:06.539788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32863423-f02a-4bdd-9b95-42385e5c2422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd822d270>]}
[0m18:04:06.540684 [info ] [MainThread]: 
[0m18:04:06.541078 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:04:06.541788 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m18:04:06.549347 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m18:04:06.549490 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m18:04:06.549580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:08.362297 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.81 seconds
[0m18:04:08.370684 [debug] [ThreadPool]: On list_materialize_public: Close
[0m18:04:08.372620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32863423-f02a-4bdd-9b95-42385e5c2422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd820fd90>]}
[0m18:04:08.373458 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:04:08.373788 [info ] [MainThread]: 
[0m18:04:08.380689 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m18:04:08.381338 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m18:04:08.381540 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m18:04:08.381764 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m18:04:08.386526 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m18:04:08.387121 [debug] [Thread-1 (]: finished collecting timing info
[0m18:04:08.387295 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m18:04:08.387469 [debug] [Thread-1 (]: finished collecting timing info
[0m18:04:08.388123 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m18:04:08.388315 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m18:04:08.388927 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m18:04:08.389111 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m18:04:08.389267 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m18:04:08.392325 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m18:04:08.392759 [debug] [Thread-1 (]: finished collecting timing info
[0m18:04:08.392921 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m18:04:08.393165 [debug] [Thread-1 (]: finished collecting timing info
[0m18:04:08.393810 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m18:04:08.394614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:08.394780 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m18:04:08.401636 [info ] [MainThread]: Done.
[0m18:04:08.403867 [debug] [MainThread]: Acquiring new materialize connection "generate_catalog"
[0m18:04:08.404012 [info ] [MainThread]: Building catalog
[0m18:04:08.405143 [debug] [ThreadPool]: Acquiring new materialize connection "materialize.information_schema"
[0m18:04:08.411539 [debug] [ThreadPool]: Using materialize connection "materialize.information_schema"
[0m18:04:08.411717 [debug] [ThreadPool]: On materialize.information_schema: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "materialize.information_schema"} */
select
            d.name as table_database,
            s.name as table_schema,
            o.name as table_name,
            case when o.type = 'materialized-view' then 'materializedview' else o.type end as table_type,
            '' as table_comment,
            c.name as column_name,
            c.position as column_index,
            c.type as column_type,
            '' as column_comment,
            '' as table_owner
        from mz_objects o
        join mz_schemas s on o.schema_id = s.id
        join mz_databases d on s.database_id = d.id and d.name = 'materialize'
        join mz_columns c on c.id = o.id
        where s.name in ('public')
[0m18:04:08.411828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:09.806399 [debug] [ThreadPool]: SQL status: SELECT 4 in 1.39 seconds
[0m18:04:09.818371 [debug] [ThreadPool]: On materialize.information_schema: Close
[0m18:04:09.829421 [info ] [MainThread]: Catalog written to /Users/claytonvanhovel/Desktop/onward-materialize-dbt/target/catalog.json
[0m18:04:09.829897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0a9d1d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf83cbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf83cbd60>]}
[0m18:04:09.830198 [debug] [MainThread]: Flushing usage events
[0m18:04:10.150568 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:04:10.151006 [debug] [MainThread]: Connection 'materialize.information_schema' was properly closed.


============================== 2022-12-01 18:04:15.072798 | 1e779dd9-47fc-44ec-ac97-75a8fd872ebf ==============================
[0m18:04:15.072883 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:04:15.073384 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m18:04:15.073499 [debug] [MainThread]: Tracking: tracking
[0m18:04:15.092085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b1c85690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b1c862f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b1c87850>]}
[0m18:04:15.093968 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m18:04:15.094290 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m18:04:15.094445 [info ] [MainThread]: 
[0m18:04:15.094582 [info ] [MainThread]: 
[0m18:04:15.094720 [info ] [MainThread]: Press Ctrl+C to exit.
[0m18:04:15.095404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b1c85e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b1c86da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b1c85cc0>]}
[0m18:04:15.095591 [debug] [MainThread]: Flushing usage events
[0m18:04:15.392423 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m18:04:15.397937 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/task/serve.py", line 30, in run
    httpd = TCPServer(  # type: ignore
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use



============================== 2022-12-01 18:04:24.636653 | 778b165b-069f-4143-b21f-b1fc74ded8f2 ==============================
[0m18:04:24.636740 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:04:24.637260 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m18:04:24.637380 [debug] [MainThread]: Tracking: tracking
[0m18:04:24.663938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a1ee5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a1ee5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a1ee7820>]}
[0m18:04:24.666508 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m18:04:24.666795 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m18:04:24.666952 [info ] [MainThread]: 
[0m18:04:24.667090 [info ] [MainThread]: 
[0m18:04:24.667224 [info ] [MainThread]: Press Ctrl+C to exit.
[0m18:04:24.667737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a1ee5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a1ee57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a1ee5cf0>]}
[0m18:04:24.667935 [debug] [MainThread]: Flushing usage events
[0m18:04:24.965350 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m18:04:24.968691 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/task/serve.py", line 30, in run
    httpd = TCPServer(  # type: ignore
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use



============================== 2022-12-01 18:05:33.490370 | c2af2d24-3b89-41b6-9a51-c58283eb5a28 ==============================
[0m18:05:33.490428 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:05:33.492359 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m18:05:33.492476 [debug] [MainThread]: Tracking: tracking
[0m18:05:33.517437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952a4f6da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952a4f5f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952a4f6950>]}
[0m18:05:33.520154 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m18:05:33.520410 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m18:05:33.520568 [info ] [MainThread]: 
[0m18:05:33.520702 [info ] [MainThread]: 
[0m18:05:33.520834 [info ] [MainThread]: Press Ctrl+C to exit.
[0m18:05:33.521380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952a4f5f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952a4f4c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952a4f6aa0>]}
[0m18:05:33.521560 [debug] [MainThread]: Flushing usage events
[0m18:05:33.844852 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m18:05:33.849863 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/task/serve.py", line 30, in run
    httpd = TCPServer(  # type: ignore
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use



============================== 2022-12-01 18:06:33.962118 | 15a7dda5-57ab-46a5-825e-cc3bedf4a2e5 ==============================
[0m18:06:33.962322 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:06:33.963146 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m18:06:33.963287 [debug] [MainThread]: Tracking: tracking
[0m18:06:33.992052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4dab9d780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4dab9ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4dab9fcd0>]}
[0m18:06:33.994658 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m18:06:33.994923 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m18:06:33.995084 [info ] [MainThread]: 
[0m18:06:33.995222 [info ] [MainThread]: 
[0m18:06:33.995356 [info ] [MainThread]: Press Ctrl+C to exit.
[0m18:12:36.079105 [debug] [MainThread]: Flushing usage events
[0m18:12:36.433375 [info ] [MainThread]: ctrl-c


============================== 2022-12-01 18:12:46.444854 | 33b9165b-0168-4e86-95b2-10baf911ea42 ==============================
[0m18:12:46.444922 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:12:46.445691 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m18:12:46.445843 [debug] [MainThread]: Tracking: tracking
[0m18:12:46.475522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91ab028f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91ab030d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91ab02a10>]}
[0m18:12:46.522432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:46.522609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:46.527476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33b9165b-0168-4e86-95b2-10baf911ea42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9085702b0>]}
[0m18:12:46.534851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33b9165b-0168-4e86-95b2-10baf911ea42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd908541270>]}
[0m18:12:46.535087 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:12:46.535263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33b9165b-0168-4e86-95b2-10baf911ea42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9085412a0>]}
[0m18:12:46.536427 [info ] [MainThread]: 
[0m18:12:46.537088 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:12:46.537882 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m18:12:46.546130 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m18:12:46.546340 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m18:12:46.546439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:48.378764 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.83 seconds
[0m18:12:48.384308 [debug] [ThreadPool]: On list_materialize_public: Close
[0m18:12:48.385844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33b9165b-0168-4e86-95b2-10baf911ea42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9084f0040>]}
[0m18:12:48.386638 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:12:48.387017 [info ] [MainThread]: 
[0m18:12:48.393698 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m18:12:48.394462 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m18:12:48.394792 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m18:12:48.395024 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m18:12:48.399667 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m18:12:48.400851 [debug] [Thread-1 (]: finished collecting timing info
[0m18:12:48.401033 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m18:12:48.401184 [debug] [Thread-1 (]: finished collecting timing info
[0m18:12:48.401744 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m18:12:48.401891 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m18:12:48.402412 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m18:12:48.402560 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m18:12:48.402696 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m18:12:48.405702 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m18:12:48.406419 [debug] [Thread-1 (]: finished collecting timing info
[0m18:12:48.406575 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m18:12:48.406722 [debug] [Thread-1 (]: finished collecting timing info
[0m18:12:48.407286 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m18:12:48.408066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:48.408248 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m18:12:48.415601 [info ] [MainThread]: Done.
[0m18:12:48.417680 [debug] [MainThread]: Acquiring new materialize connection "generate_catalog"
[0m18:12:48.417848 [info ] [MainThread]: Building catalog
[0m18:12:48.419240 [debug] [ThreadPool]: Acquiring new materialize connection "materialize.information_schema"
[0m18:12:48.425604 [debug] [ThreadPool]: Using materialize connection "materialize.information_schema"
[0m18:12:48.425789 [debug] [ThreadPool]: On materialize.information_schema: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "materialize.information_schema"} */
select
            d.name as table_database,
            s.name as table_schema,
            o.name as table_name,
            case when o.type = 'materialized-view' then 'materializedview' else o.type end as table_type,
            '' as table_comment,
            c.name as column_name,
            c.position as column_index,
            c.type as column_type,
            '' as column_comment,
            '' as table_owner
        from mz_objects o
        join mz_schemas s on o.schema_id = s.id
        join mz_databases d on s.database_id = d.id and d.name = 'materialize'
        join mz_columns c on c.id = o.id
        where s.name in ('public')
[0m18:12:48.425907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:50.293740 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.87 seconds
[0m18:12:50.304812 [debug] [ThreadPool]: On materialize.information_schema: Close
[0m18:12:50.315989 [info ] [MainThread]: Catalog written to /Users/claytonvanhovel/Desktop/onward-materialize-dbt/target/catalog.json
[0m18:12:50.316521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91ab028f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d80a7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d80a7970>]}
[0m18:12:50.316852 [debug] [MainThread]: Flushing usage events
[0m18:12:50.614737 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:12:50.615253 [debug] [MainThread]: Connection 'materialize.information_schema' was properly closed.


============================== 2022-12-01 18:12:57.538838 | 279b71ae-dcb6-4045-971f-1e6a30bff345 ==============================
[0m18:12:57.539049 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:12:57.539776 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:12:57.539904 [debug] [MainThread]: Tracking: tracking
[0m18:12:57.565146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5919ad6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5919ade10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5919af700>]}
[0m18:12:57.610303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:57.610495 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:57.615563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '279b71ae-dcb6-4045-971f-1e6a30bff345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb560c241f0>]}
[0m18:12:57.620405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '279b71ae-dcb6-4045-971f-1e6a30bff345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb560bf51b0>]}
[0m18:12:57.620602 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:12:57.620776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '279b71ae-dcb6-4045-971f-1e6a30bff345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb560bf51e0>]}
[0m18:12:57.621764 [info ] [MainThread]: 
[0m18:12:57.622178 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:12:57.622920 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m18:12:57.630966 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m18:12:57.631166 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m18:12:57.631279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:59.212325 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.58 seconds
[0m18:12:59.218359 [debug] [ThreadPool]: On list_materialize: Close
[0m18:12:59.221018 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m18:12:59.228950 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m18:12:59.229175 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m18:12:59.229332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:00.654217 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.42 seconds
[0m18:13:00.659524 [debug] [ThreadPool]: On list_materialize_public: Close
[0m18:13:00.661355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '279b71ae-dcb6-4045-971f-1e6a30bff345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5919afcd0>]}
[0m18:13:00.662241 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:13:00.662570 [info ] [MainThread]: 
[0m18:13:00.669332 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m18:13:00.669753 [info ] [Thread-1 (]: 1 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m18:13:00.670491 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m18:13:00.670683 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m18:13:00.670900 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m18:13:00.675136 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m18:13:00.676049 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:00.676263 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m18:13:00.692026 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m18:13:00.692862 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m18:13:00.692992 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    

with

src_driver_location as (
    select key, CONVERT_FROM(data, 'utf8')::jsonb as data from "materialize"."public"."src_driver_location"
)

,final as (

  SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM src_driver_location
)

select * from final
  );
[0m18:13:00.693103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:02.204030 [debug] [Thread-1 (]: SQL status: CREATE MATERIALIZED VIEW in 1.51 seconds
[0m18:13:02.219135 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:02.219428 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m18:13:02.220160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '279b71ae-dcb6-4045-971f-1e6a30bff345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb591a9bb80>]}
[0m18:13:02.220508 [info ] [Thread-1 (]: 1 of 2 OK created sql materializedview model public.json_driver_location ....... [[32mCREATE MATERIALIZED VIEW[0m in 1.55s]
[0m18:13:02.221240 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m18:13:02.221445 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m18:13:02.221661 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m18:13:02.222449 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m18:13:02.222639 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m18:13:02.222801 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m18:13:02.226598 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m18:13:02.228628 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:02.228857 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m18:13:02.245498 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:13:02.245731 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m18:13:02.245858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:03.662841 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.42 seconds
[0m18:13:03.671296 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m18:13:03.673506 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:13:03.673705 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m18:13:05.086114 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.41 seconds
[0m18:13:05.092525 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:05.092941 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m18:13:05.094267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '279b71ae-dcb6-4045-971f-1e6a30bff345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb591b25b10>]}
[0m18:13:05.094784 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.87s]
[0m18:13:05.095279 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m18:13:05.096931 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:13:05.097529 [info ] [MainThread]: 
[0m18:13:05.097794 [info ] [MainThread]: Finished running 1 materializedview model, 1 source model in 0 hours 0 minutes and 7.48 seconds (7.48s).
[0m18:13:05.098050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:05.098185 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m18:13:05.107185 [info ] [MainThread]: 
[0m18:13:05.107536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:05.107822 [info ] [MainThread]: 
[0m18:13:05.108061 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:13:05.108400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb560bf51e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb560bf4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb591b04160>]}
[0m18:13:05.108653 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:13:20.743071 | a50fb55f-8e84-4626-a41e-6f7bec35005b ==============================
[0m18:13:20.743258 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:13:20.743983 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m18:13:20.744101 [debug] [MainThread]: Tracking: tracking
[0m18:13:20.767503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba224e1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba224e2200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba224e1b70>]}
[0m18:13:20.812290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:20.812460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:20.817573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a50fb55f-8e84-4626-a41e-6f7bec35005b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba22690280>]}
[0m18:13:20.823263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a50fb55f-8e84-4626-a41e-6f7bec35005b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba22665240>]}
[0m18:13:20.823473 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:13:20.823651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a50fb55f-8e84-4626-a41e-6f7bec35005b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba22665270>]}
[0m18:13:20.825201 [info ] [MainThread]: 
[0m18:13:20.825640 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:13:20.826408 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m18:13:20.835814 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m18:13:20.836028 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m18:13:20.836126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:22.348300 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.51 seconds
[0m18:13:22.354651 [debug] [ThreadPool]: On list_materialize_public: Close
[0m18:13:22.356793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a50fb55f-8e84-4626-a41e-6f7bec35005b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba224db490>]}
[0m18:13:22.357677 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:13:22.358019 [info ] [MainThread]: 
[0m18:13:22.365337 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m18:13:22.365989 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m18:13:22.366188 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m18:13:22.366390 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m18:13:22.371151 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m18:13:22.371962 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:22.372152 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m18:13:22.372325 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:22.372948 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m18:13:22.373146 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m18:13:22.373710 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m18:13:22.373858 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m18:13:22.374001 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m18:13:22.377053 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m18:13:22.377498 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:22.377652 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m18:13:22.377785 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:22.378284 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m18:13:22.379342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:22.379543 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m18:13:22.386439 [info ] [MainThread]: Done.
[0m18:13:22.388537 [debug] [MainThread]: Acquiring new materialize connection "generate_catalog"
[0m18:13:22.388695 [info ] [MainThread]: Building catalog
[0m18:13:22.390016 [debug] [ThreadPool]: Acquiring new materialize connection "materialize.information_schema"
[0m18:13:22.396376 [debug] [ThreadPool]: Using materialize connection "materialize.information_schema"
[0m18:13:22.396532 [debug] [ThreadPool]: On materialize.information_schema: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "materialize.information_schema"} */
select
            d.name as table_database,
            s.name as table_schema,
            o.name as table_name,
            case when o.type = 'materialized-view' then 'materializedview' else o.type end as table_type,
            '' as table_comment,
            c.name as column_name,
            c.position as column_index,
            c.type as column_type,
            '' as column_comment,
            '' as table_owner
        from mz_objects o
        join mz_schemas s on o.schema_id = s.id
        join mz_databases d on s.database_id = d.id and d.name = 'materialize'
        join mz_columns c on c.id = o.id
        where s.name in ('public')
[0m18:13:22.396640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:23.710155 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.31 seconds
[0m18:13:23.719137 [debug] [ThreadPool]: On materialize.information_schema: Close
[0m18:13:23.728672 [info ] [MainThread]: Catalog written to /Users/claytonvanhovel/Desktop/onward-materialize-dbt/target/catalog.json
[0m18:13:23.729105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba224e1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba00173e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba00173a90>]}
[0m18:13:23.729374 [debug] [MainThread]: Flushing usage events
[0m18:13:24.037752 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:13:24.038378 [debug] [MainThread]: Connection 'materialize.information_schema' was properly closed.


============================== 2022-12-01 18:13:29.799731 | d9c37d61-e418-4e0a-babc-64d2f2607b30 ==============================
[0m18:13:29.799996 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:13:29.800533 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m18:13:29.800659 [debug] [MainThread]: Tracking: tracking
[0m18:13:29.819107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d1cc2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d1cc3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d1cc09a0>]}
[0m18:13:29.821472 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m18:13:29.821737 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m18:13:29.821891 [info ] [MainThread]: 
[0m18:13:29.822028 [info ] [MainThread]: 
[0m18:13:29.822161 [info ] [MainThread]: Press Ctrl+C to exit.
[0m18:14:10.888858 [debug] [MainThread]: Flushing usage events
[0m18:14:11.225685 [info ] [MainThread]: ctrl-c


============================== 2022-12-02 00:10:18.679479 | 1c954ab1-e97e-4e79-8c25-92b1bdd0f0ee ==============================
[0m00:10:18.679554 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:10:18.681042 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:10:18.681218 [debug] [MainThread]: Tracking: tracking
[0m00:10:18.717055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6d0281a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6d0282230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6d0281b70>]}
[0m00:10:18.768016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:10:18.768223 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:10:18.773660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c954ab1-e97e-4e79-8c25-92b1bdd0f0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712540280>]}
[0m00:10:18.779221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c954ab1-e97e-4e79-8c25-92b1bdd0f0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712515240>]}
[0m00:10:18.779455 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:10:18.779635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c954ab1-e97e-4e79-8c25-92b1bdd0f0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712515270>]}
[0m00:10:18.780699 [info ] [MainThread]: 
[0m00:10:18.781133 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:10:18.781886 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m00:10:18.789895 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m00:10:18.790072 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m00:10:18.790164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:20.346406 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.56 seconds
[0m00:10:20.355598 [debug] [ThreadPool]: On list_materialize: Close
[0m00:10:20.361226 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m00:10:20.375378 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m00:10:20.375772 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m00:10:20.375929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:21.732009 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.36 seconds
[0m00:10:21.734989 [debug] [ThreadPool]: On list_materialize_public: Close
[0m00:10:21.737310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c954ab1-e97e-4e79-8c25-92b1bdd0f0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6d0283be0>]}
[0m00:10:21.740889 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:10:21.742218 [info ] [MainThread]: 
[0m00:10:21.757312 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m00:10:21.759019 [info ] [Thread-1 (]: 1 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m00:10:21.761393 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m00:10:21.762826 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m00:10:21.763422 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m00:10:21.767835 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m00:10:21.768754 [debug] [Thread-1 (]: finished collecting timing info
[0m00:10:21.768960 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m00:10:21.786093 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m00:10:21.787324 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m00:10:21.787493 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    

with

src_driver_location as (
    select key, CONVERT_FROM(data, 'utf8')::jsonb as data from "materialize"."public"."src_driver_location"
)

,final as (

  SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM src_driver_location
)

select * from final
  );
[0m00:10:21.787639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:23.548343 [debug] [Thread-1 (]: SQL status: CREATE MATERIALIZED VIEW in 1.76 seconds
[0m00:10:23.579303 [debug] [Thread-1 (]: finished collecting timing info
[0m00:10:23.579786 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m00:10:23.581002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c954ab1-e97e-4e79-8c25-92b1bdd0f0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71257fc10>]}
[0m00:10:23.581522 [info ] [Thread-1 (]: 1 of 2 OK created sql materializedview model public.json_driver_location ....... [[32mCREATE MATERIALIZED VIEW[0m in 1.82s]
[0m00:10:23.583946 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m00:10:23.584177 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m00:10:23.584587 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m00:10:23.585306 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m00:10:23.585490 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m00:10:23.585650 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m00:10:23.589326 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m00:10:23.590363 [debug] [Thread-1 (]: finished collecting timing info
[0m00:10:23.590550 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m00:10:23.607515 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:10:23.607804 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m00:10:23.607943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:26.654265 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 3.05 seconds
[0m00:10:26.662885 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m00:10:26.663897 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:10:26.664066 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m00:10:27.839768 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.18 seconds
[0m00:10:27.843066 [debug] [Thread-1 (]: finished collecting timing info
[0m00:10:27.843398 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m00:10:27.844322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c954ab1-e97e-4e79-8c25-92b1bdd0f0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712605ba0>]}
[0m00:10:27.844762 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 4.26s]
[0m00:10:27.845196 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m00:10:27.846479 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:10:27.847038 [info ] [MainThread]: 
[0m00:10:27.847301 [info ] [MainThread]: Finished running 1 materializedview model, 1 source model in 0 hours 0 minutes and 9.07 seconds (9.07s).
[0m00:10:27.847546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:27.847674 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m00:10:27.855466 [info ] [MainThread]: 
[0m00:10:27.855723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:10:27.855930 [info ] [MainThread]: 
[0m00:10:27.856110 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:10:27.856352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712515270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712514f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7125e4160>]}
[0m00:10:27.856535 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 00:13:26.993051 | 9d097134-ef96-4b5b-a0b3-b2e9b65afc7b ==============================
[0m00:13:26.993120 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:13:26.993848 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:13:26.993974 [debug] [MainThread]: Tracking: tracking
[0m00:13:27.016904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eabb1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eabb2230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eabb1b70>]}
[0m00:13:27.061433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:13:27.061750 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m00:13:27.071565 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m00:13:27.093246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d097134-ef96-4b5b-a0b3-b2e9b65afc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d83e40d0>]}
[0m00:13:27.097895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d097134-ef96-4b5b-a0b3-b2e9b65afc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ead17e50>]}
[0m00:13:27.098090 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:13:27.098257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d097134-ef96-4b5b-a0b3-b2e9b65afc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ead05c90>]}
[0m00:13:27.099118 [info ] [MainThread]: 
[0m00:13:27.099512 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:13:27.100177 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m00:13:27.107326 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m00:13:27.107518 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m00:13:27.107625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:31.524551 [debug] [ThreadPool]: SQL status: SELECT 5 in 4.42 seconds
[0m00:13:31.529179 [debug] [ThreadPool]: On list_materialize: Close
[0m00:13:31.531806 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m00:13:31.539202 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m00:13:31.539433 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m00:13:31.539582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:33.300094 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.76 seconds
[0m00:13:33.305861 [debug] [ThreadPool]: On list_materialize_public: Close
[0m00:13:33.307290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d097134-ef96-4b5b-a0b3-b2e9b65afc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ead17fd0>]}
[0m00:13:33.308104 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:13:33.308429 [info ] [MainThread]: 
[0m00:13:33.314296 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m00:13:33.314898 [info ] [Thread-1 (]: 1 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m00:13:33.315624 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m00:13:33.315801 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m00:13:33.315995 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m00:13:33.318117 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m00:13:33.319068 [debug] [Thread-1 (]: finished collecting timing info
[0m00:13:33.319280 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m00:13:33.334977 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m00:13:33.335510 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m00:13:33.335651 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM driver_location)
  );
[0m00:13:33.335776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:34.754847 [debug] [Thread-1 (]: Postgres adapter: Postgres error: unknown catalog item 'driver_location'

[0m00:13:34.757694 [debug] [Thread-1 (]: finished collecting timing info
[0m00:13:34.758122 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m00:13:34.760420 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  unknown catalog item 'driver_location'
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m00:13:34.761164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d097134-ef96-4b5b-a0b3-b2e9b65afc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eace4790>]}
[0m00:13:34.761884 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 1.45s]
[0m00:13:34.762939 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m00:13:34.763178 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m00:13:34.763625 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m00:13:34.764427 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m00:13:34.764606 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m00:13:34.764783 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m00:13:34.768527 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m00:13:34.769204 [debug] [Thread-1 (]: finished collecting timing info
[0m00:13:34.769380 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m00:13:34.785075 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:13:34.785325 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m00:13:34.785453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:36.302015 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.52 seconds
[0m00:13:36.307787 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m00:13:36.308436 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:13:36.308574 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m00:13:37.362723 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.05 seconds
[0m00:13:37.380088 [debug] [Thread-1 (]: finished collecting timing info
[0m00:13:37.380534 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m00:13:37.381632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d097134-ef96-4b5b-a0b3-b2e9b65afc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d848fee0>]}
[0m00:13:37.382105 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.62s]
[0m00:13:37.382622 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m00:13:37.384139 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:13:37.384719 [info ] [MainThread]: 
[0m00:13:37.385003 [info ] [MainThread]: Finished running 1 view model, 1 source model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m00:13:37.385256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:37.385444 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m00:13:37.394601 [info ] [MainThread]: 
[0m00:13:37.394911 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:13:37.395166 [info ] [MainThread]: 
[0m00:13:37.395394 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m00:13:37.395615 [error] [MainThread]:   unknown catalog item 'driver_location'
[0m00:13:37.395807 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m00:13:37.395971 [info ] [MainThread]: 
[0m00:13:37.396369 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:13:37.396869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ead05c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d8495750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d8496590>]}
[0m00:13:37.397150 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 00:14:06.068000 | 54214db4-7f46-4268-af4b-8b0d0e50b340 ==============================
[0m00:14:06.068058 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:14:06.068572 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:14:06.068694 [debug] [MainThread]: Tracking: tracking
[0m00:14:06.090423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3489f9d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3489f9600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3489fb100>]}
[0m00:14:06.130245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:14:06.130582 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m00:14:06.139900 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m00:14:06.161140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54214db4-7f46-4268-af4b-8b0d0e50b340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378c680d0>]}
[0m00:14:06.165974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54214db4-7f46-4268-af4b-8b0d0e50b340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378b9c910>]}
[0m00:14:06.166179 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:14:06.166355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54214db4-7f46-4268-af4b-8b0d0e50b340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378bb9c00>]}
[0m00:14:06.167228 [info ] [MainThread]: 
[0m00:14:06.167648 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:14:06.168313 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m00:14:06.175658 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m00:14:06.175833 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m00:14:06.175928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:07.633353 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.46 seconds
[0m00:14:07.638965 [debug] [ThreadPool]: On list_materialize: Close
[0m00:14:07.641646 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m00:14:07.649196 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m00:14:07.649424 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m00:14:07.649609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:09.362240 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.71 seconds
[0m00:14:09.370297 [debug] [ThreadPool]: On list_materialize_public: Close
[0m00:14:09.372111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54214db4-7f46-4268-af4b-8b0d0e50b340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378bcfd60>]}
[0m00:14:09.372972 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:14:09.373305 [info ] [MainThread]: 
[0m00:14:09.377815 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m00:14:09.378419 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m00:14:09.379115 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:09.379299 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m00:14:09.379490 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m00:14:09.383418 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m00:14:09.384326 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:09.384525 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m00:14:09.400767 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:09.401005 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m00:14:09.401127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:10.826019 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.42 seconds
[0m00:14:10.839087 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m00:14:10.840018 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:10.840188 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m00:14:11.879049 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.04 seconds
[0m00:14:11.896013 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:11.896407 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m00:14:11.897550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54214db4-7f46-4268-af4b-8b0d0e50b340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378bcfd60>]}
[0m00:14:11.898057 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.52s]
[0m00:14:11.898875 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m00:14:11.899646 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m00:14:11.899895 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m00:14:11.900498 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m00:14:11.900661 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m00:14:11.900816 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m00:14:11.904214 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m00:14:11.904952 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:11.905121 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m00:14:11.914816 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m00:14:11.915225 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m00:14:11.915336 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location"
  );
[0m00:14:11.915434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:13.308070 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected right parenthesis, found semicolon
LINE 12:   );
            ^

[0m00:14:13.310081 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:13.310495 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m00:14:13.312125 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Expected right parenthesis, found semicolon
  LINE 12:   );
              ^
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m00:14:13.312683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54214db4-7f46-4268-af4b-8b0d0e50b340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378d20e20>]}
[0m00:14:13.313175 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 1.41s]
[0m00:14:13.313711 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m00:14:13.315352 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:14:13.316011 [info ] [MainThread]: 
[0m00:14:13.316310 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 7.15 seconds (7.15s).
[0m00:14:13.316625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:13.316760 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m00:14:13.325457 [info ] [MainThread]: 
[0m00:14:13.325746 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:14:13.326008 [info ] [MainThread]: 
[0m00:14:13.326240 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m00:14:13.326480 [error] [MainThread]:   Expected right parenthesis, found semicolon
[0m00:14:13.326720 [error] [MainThread]:   LINE 12:   );
[0m00:14:13.326967 [error] [MainThread]:               ^
[0m00:14:13.327210 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m00:14:13.327440 [info ] [MainThread]: 
[0m00:14:13.327670 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:14:13.328016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378bb9c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378d03280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378d00700>]}
[0m00:14:13.328280 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 00:14:31.210445 | 8f579815-62b1-41dc-a6e3-9f61e0fac170 ==============================
[0m00:14:31.210517 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:14:31.211161 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:14:31.211276 [debug] [MainThread]: Tracking: tracking
[0m00:14:31.230724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca691a5660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca691a5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca691a5780>]}
[0m00:14:31.270850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:14:31.271034 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:14:31.275855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f579815-62b1-41dc-a6e3-9f61e0fac170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca693b0280>]}
[0m00:14:31.280851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f579815-62b1-41dc-a6e3-9f61e0fac170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca69381240>]}
[0m00:14:31.281067 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:14:31.281235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f579815-62b1-41dc-a6e3-9f61e0fac170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca69381270>]}
[0m00:14:31.282208 [info ] [MainThread]: 
[0m00:14:31.282622 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:14:31.283393 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m00:14:31.291049 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m00:14:31.291200 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m00:14:31.291295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:32.654058 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.36 seconds
[0m00:14:32.660379 [debug] [ThreadPool]: On list_materialize: Close
[0m00:14:32.662984 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m00:14:32.670851 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m00:14:32.671091 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m00:14:32.671259 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:34.339151 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.67 seconds
[0m00:14:34.340786 [debug] [ThreadPool]: On list_materialize_public: Close
[0m00:14:34.341760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f579815-62b1-41dc-a6e3-9f61e0fac170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca693efc10>]}
[0m00:14:34.342386 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:14:34.342641 [info ] [MainThread]: 
[0m00:14:34.345565 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m00:14:34.346136 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m00:14:34.346783 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:34.346973 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m00:14:34.347126 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m00:14:34.349814 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m00:14:34.350280 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:34.350427 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m00:14:34.363274 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:34.363521 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m00:14:34.363631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:35.911682 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.55 seconds
[0m00:14:35.924994 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m00:14:35.926106 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:35.926282 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m00:14:37.042832 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.12 seconds
[0m00:14:37.055590 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:37.055854 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m00:14:37.056584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f579815-62b1-41dc-a6e3-9f61e0fac170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca693efc10>]}
[0m00:14:37.056935 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.71s]
[0m00:14:37.057604 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m00:14:37.058168 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m00:14:37.058409 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m00:14:37.058974 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m00:14:37.059118 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m00:14:37.059255 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m00:14:37.061958 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m00:14:37.062367 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:37.062498 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m00:14:37.071924 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m00:14:37.072311 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m00:14:37.072427 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location"
  );
[0m00:14:37.072528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:38.408545 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected right parenthesis, found semicolon
LINE 12:   );
            ^

[0m00:14:38.410119 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:38.410441 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m00:14:38.411799 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Expected right parenthesis, found semicolon
  LINE 12:   );
              ^
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m00:14:38.412261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f579815-62b1-41dc-a6e3-9f61e0fac170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca69418520>]}
[0m00:14:38.412687 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 1.35s]
[0m00:14:38.413135 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m00:14:38.414319 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:14:38.414936 [info ] [MainThread]: 
[0m00:14:38.415221 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 7.13 seconds (7.13s).
[0m00:14:38.415491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:38.415620 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m00:14:38.424588 [info ] [MainThread]: 
[0m00:14:38.424951 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:14:38.425231 [info ] [MainThread]: 
[0m00:14:38.425473 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m00:14:38.425717 [error] [MainThread]:   Expected right parenthesis, found semicolon
[0m00:14:38.425954 [error] [MainThread]:   LINE 12:   );
[0m00:14:38.426182 [error] [MainThread]:               ^
[0m00:14:38.426406 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m00:14:38.426642 [info ] [MainThread]: 
[0m00:14:38.426878 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:14:38.427255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca69380e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca69380dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6941a170>]}
[0m00:14:38.427549 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 00:14:51.055795 | b5470d84-a2b2-44ca-91f8-cc91940babfa ==============================
[0m00:14:51.055921 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:14:51.056445 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:14:51.056568 [debug] [MainThread]: Tracking: tracking
[0m00:14:51.075800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf9739e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf9739660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf9739d20>]}
[0m00:14:51.114997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:14:51.115349 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m00:14:51.124860 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m00:14:51.147344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5470d84-a2b2-44ca-91f8-cc91940babfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc81d80d0>]}
[0m00:14:51.152428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5470d84-a2b2-44ca-91f8-cc91940babfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc813bd60>]}
[0m00:14:51.152639 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:14:51.152815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5470d84-a2b2-44ca-91f8-cc91940babfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc8129c90>]}
[0m00:14:51.153740 [info ] [MainThread]: 
[0m00:14:51.154146 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:14:51.154908 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m00:14:51.162450 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m00:14:51.162628 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m00:14:51.162721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:52.529277 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.37 seconds
[0m00:14:52.534473 [debug] [ThreadPool]: On list_materialize: Close
[0m00:14:52.537000 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m00:14:52.544706 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m00:14:52.544938 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m00:14:52.545092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:54.353973 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.81 seconds
[0m00:14:54.360675 [debug] [ThreadPool]: On list_materialize_public: Close
[0m00:14:54.362314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5470d84-a2b2-44ca-91f8-cc91940babfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc813bfd0>]}
[0m00:14:54.363074 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:14:54.363330 [info ] [MainThread]: 
[0m00:14:54.367854 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m00:14:54.368516 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m00:14:54.369272 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:54.369472 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m00:14:54.369690 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m00:14:54.373634 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m00:14:54.374484 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:54.374688 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m00:14:54.390573 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:54.390812 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m00:14:54.390946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:55.816188 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.43 seconds
[0m00:14:55.831361 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m00:14:55.832307 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:55.832482 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m00:14:56.865228 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.03 seconds
[0m00:14:56.881487 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:56.881872 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m00:14:56.883044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5470d84-a2b2-44ca-91f8-cc91940babfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc810c880>]}
[0m00:14:56.883559 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.51s]
[0m00:14:56.884516 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m00:14:56.885407 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m00:14:56.885737 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m00:14:56.886485 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m00:14:56.886683 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m00:14:56.886852 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m00:14:56.890190 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m00:14:56.890902 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:56.891082 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m00:14:56.900871 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m00:14:56.901347 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m00:14:56.901474 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m00:14:56.901586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:58.274447 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 1.37 seconds
[0m00:14:58.280115 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:58.280529 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m00:14:58.281665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5470d84-a2b2-44ca-91f8-cc91940babfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc828d540>]}
[0m00:14:58.282405 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 1.40s]
[0m00:14:58.282953 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m00:14:58.284437 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:14:58.285048 [info ] [MainThread]: 
[0m00:14:58.285347 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 7.13 seconds (7.13s).
[0m00:14:58.285626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:58.285757 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m00:14:58.295095 [info ] [MainThread]: 
[0m00:14:58.295371 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:14:58.295650 [info ] [MainThread]: 
[0m00:14:58.295892 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:14:58.296240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc8129c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc8275240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc8274ca0>]}
[0m00:14:58.296482 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 15:03:47.471421 | 47f5aa6a-faef-424b-8a04-f7040fd3521d ==============================
[0m15:03:47.471478 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:03:47.472349 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:03:47.472502 [debug] [MainThread]: Tracking: tracking
[0m15:03:47.500694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a8d2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a8d30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a8d1600>]}
[0m15:03:47.547346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:03:47.547643 [debug] [MainThread]: Partial parsing: deleted source source.onward_materialize.kafka.src_driver_location
[0m15:03:47.547741 [debug] [MainThread]: Partial parsing: update schema file: onward_materialize://models/schema.yml
[0m15:03:47.547906 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m15:03:47.559081 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m15:03:47.569576 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m15:03:47.584811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47f5aa6a-faef-424b-8a04-f7040fd3521d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8aa06650>]}
[0m15:03:47.590580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47f5aa6a-faef-424b-8a04-f7040fd3521d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a9d3e20>]}
[0m15:03:47.590798 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:03:47.590971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47f5aa6a-faef-424b-8a04-f7040fd3521d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a9d3e80>]}
[0m15:03:47.591815 [info ] [MainThread]: 
[0m15:03:47.592197 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:03:47.592879 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m15:03:47.599849 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m15:03:47.599963 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m15:03:47.600050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:50.231527 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.63 seconds
[0m15:03:50.238470 [debug] [ThreadPool]: On list_materialize: Close
[0m15:03:50.242329 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m15:03:50.251944 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m15:03:50.252197 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m15:03:50.252371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:51.645105 [debug] [ThreadPool]: SQL status: SELECT 0 in 1.39 seconds
[0m15:03:51.650942 [debug] [ThreadPool]: On list_materialize_public: Close
[0m15:03:51.652975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47f5aa6a-faef-424b-8a04-f7040fd3521d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a8d1ae0>]}
[0m15:03:51.654142 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m15:03:51.654567 [info ] [MainThread]: 
[0m15:03:51.662263 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m15:03:51.662734 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m15:03:51.663784 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m15:03:51.663998 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m15:03:51.664225 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m15:03:51.668639 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m15:03:51.669581 [debug] [Thread-1 (]: finished collecting timing info
[0m15:03:51.669783 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m15:03:51.684158 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m15:03:51.684910 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:03:51.685076 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m15:03:51.685207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:53.002650 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected end of statement, found VALUE
LINE 15:   VALUE FORMAT BYTES
           ^

[0m15:03:53.004102 [debug] [Thread-1 (]: finished collecting timing info
[0m15:03:53.004829 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m15:03:53.006908 [debug] [Thread-1 (]: Database Error in model src_driver_location (models/sources/src_driver_location.sql)
  Expected end of statement, found VALUE
  LINE 15:   VALUE FORMAT BYTES
             ^
  compiled Code at target/run/onward_materialize/models/sources/src_driver_location.sql
[0m15:03:53.007732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f5aa6a-faef-424b-8a04-f7040fd3521d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8aa4ee00>]}
[0m15:03:53.008760 [error] [Thread-1 (]: 1 of 2 ERROR creating sql source model public.src_driver_location .............. [[31mERROR[0m in 1.34s]
[0m15:03:53.010051 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m15:03:53.011191 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m15:03:53.011635 [info ] [Thread-1 (]: 2 of 2 SKIP relation public.json_driver_location ............................... [[33mSKIP[0m]
[0m15:03:53.012344 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m15:03:53.014031 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:03:53.014802 [info ] [MainThread]: 
[0m15:03:53.015178 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 5.42 seconds (5.42s).
[0m15:03:53.015511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:53.015690 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m15:03:53.025304 [info ] [MainThread]: 
[0m15:03:53.025621 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:03:53.025885 [info ] [MainThread]: 
[0m15:03:53.026120 [error] [MainThread]: [33mDatabase Error in model src_driver_location (models/sources/src_driver_location.sql)[0m
[0m15:03:53.026364 [error] [MainThread]:   Expected end of statement, found VALUE
[0m15:03:53.026589 [error] [MainThread]:   LINE 15:   VALUE FORMAT BYTES
[0m15:03:53.026807 [error] [MainThread]:              ^
[0m15:03:53.027023 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/sources/src_driver_location.sql
[0m15:03:53.027248 [info ] [MainThread]: 
[0m15:03:53.027482 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m15:03:53.027832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a9d3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a9d3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8aa12aa0>]}
[0m15:03:53.028073 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 15:04:39.677339 | af9546c5-9bb1-47bc-b46a-2117101e4080 ==============================
[0m15:04:39.677392 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:04:39.677883 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:04:39.678003 [debug] [MainThread]: Tracking: tracking
[0m15:04:39.702129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6a9056f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6a905e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6a907700>]}
[0m15:04:39.746434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:04:39.746767 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m15:04:39.757517 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m15:04:39.767792 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m15:04:39.780405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af9546c5-9bb1-47bc-b46a-2117101e4080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6ab200d0>]}
[0m15:04:39.785223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af9546c5-9bb1-47bc-b46a-2117101e4080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6aa3c910>]}
[0m15:04:39.785428 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:04:39.785594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af9546c5-9bb1-47bc-b46a-2117101e4080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6aa597b0>]}
[0m15:04:39.786417 [info ] [MainThread]: 
[0m15:04:39.786806 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:04:39.787498 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m15:04:39.794878 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m15:04:39.795045 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m15:04:39.795139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:41.245866 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.45 seconds
[0m15:04:41.252393 [debug] [ThreadPool]: On list_materialize: Close
[0m15:04:41.255174 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m15:04:41.264582 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m15:04:41.264862 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m15:04:41.265041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:42.602954 [debug] [ThreadPool]: SQL status: SELECT 0 in 1.34 seconds
[0m15:04:42.609974 [debug] [ThreadPool]: On list_materialize_public: Close
[0m15:04:42.611727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af9546c5-9bb1-47bc-b46a-2117101e4080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6aa6fee0>]}
[0m15:04:42.612592 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m15:04:42.612900 [info ] [MainThread]: 
[0m15:04:42.619435 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m15:04:42.619784 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m15:04:42.620403 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m15:04:42.620560 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m15:04:42.620722 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m15:04:42.623918 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m15:04:42.624387 [debug] [Thread-1 (]: finished collecting timing info
[0m15:04:42.624540 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m15:04:42.636651 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m15:04:42.637189 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:04:42.637303 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m15:04:42.637403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:45.033511 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 2.4 seconds
[0m15:04:45.054476 [debug] [Thread-1 (]: finished collecting timing info
[0m15:04:45.054912 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m15:04:45.056020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9546c5-9bb1-47bc-b46a-2117101e4080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6ab3d570>]}
[0m15:04:45.056513 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.44s]
[0m15:04:45.057409 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m15:04:45.058074 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m15:04:45.058553 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m15:04:45.059119 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m15:04:45.059267 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m15:04:45.059409 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m15:04:45.062414 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m15:04:45.063389 [debug] [Thread-1 (]: finished collecting timing info
[0m15:04:45.063575 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m15:04:45.071994 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m15:04:45.072647 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m15:04:45.072777 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m15:04:45.072887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:46.398744 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "key" does not exist

[0m15:04:46.400998 [debug] [Thread-1 (]: finished collecting timing info
[0m15:04:46.401700 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m15:04:46.403754 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  column "key" does not exist
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m15:04:46.404508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9546c5-9bb1-47bc-b46a-2117101e4080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6abad420>]}
[0m15:04:46.405248 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 1.35s]
[0m15:04:46.406008 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m15:04:46.408046 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:04:46.408871 [info ] [MainThread]: 
[0m15:04:46.409263 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 6.62 seconds (6.62s).
[0m15:04:46.409613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:46.409790 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m15:04:46.419274 [info ] [MainThread]: 
[0m15:04:46.419620 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:04:46.419921 [info ] [MainThread]: 
[0m15:04:46.420164 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m15:04:46.420413 [error] [MainThread]:   column "key" does not exist
[0m15:04:46.420633 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m15:04:46.420870 [info ] [MainThread]: 
[0m15:04:46.421116 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:04:46.421505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6a9054b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6aa6ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6ab3d8a0>]}
[0m15:04:46.421789 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 15:05:21.524046 | 3b0d40fb-019e-4338-b7eb-f0f63f0ded55 ==============================
[0m15:05:21.524103 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:05:21.525080 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:05:21.525220 [debug] [MainThread]: Tracking: tracking
[0m15:05:21.546907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89223f9e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89223fa500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89223f8e80>]}
[0m15:05:21.591333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:05:21.591679 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m15:05:21.602547 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m15:05:21.625414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b0d40fb-019e-4338-b7eb-f0f63f0ded55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890095c0d0>]}
[0m15:05:21.630014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b0d40fb-019e-4338-b7eb-f0f63f0ded55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8920ba12d0>]}
[0m15:05:21.630231 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:05:21.630402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0d40fb-019e-4338-b7eb-f0f63f0ded55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89225496f0>]}
[0m15:05:21.631326 [info ] [MainThread]: 
[0m15:05:21.631728 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:05:21.632422 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m15:05:21.639518 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m15:05:21.639673 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m15:05:21.639763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:23.115498 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.48 seconds
[0m15:05:23.121748 [debug] [ThreadPool]: On list_materialize: Close
[0m15:05:23.125657 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m15:05:23.135057 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m15:05:23.135325 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m15:05:23.135502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:24.455742 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.32 seconds
[0m15:05:24.462805 [debug] [ThreadPool]: On list_materialize_public: Close
[0m15:05:24.464665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0d40fb-019e-4338-b7eb-f0f63f0ded55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89223f1600>]}
[0m15:05:24.465645 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m15:05:24.466011 [info ] [MainThread]: 
[0m15:05:24.472589 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m15:05:24.473173 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m15:05:24.473877 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m15:05:24.474063 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m15:05:24.474254 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m15:05:24.478072 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m15:05:24.478973 [debug] [Thread-1 (]: finished collecting timing info
[0m15:05:24.479138 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m15:05:24.492778 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:05:24.493021 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m15:05:24.493130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:25.938908 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.45 seconds
[0m15:05:25.953659 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m15:05:25.954784 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:05:25.954955 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m15:05:27.120585 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.17 seconds
[0m15:05:27.141993 [debug] [Thread-1 (]: finished collecting timing info
[0m15:05:27.142463 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m15:05:27.143604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0d40fb-019e-4338-b7eb-f0f63f0ded55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89223f1600>]}
[0m15:05:27.144100 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.67s]
[0m15:05:27.145140 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m15:05:27.146113 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m15:05:27.146435 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m15:05:27.147156 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m15:05:27.147331 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m15:05:27.147500 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m15:05:27.151416 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m15:05:27.153450 [debug] [Thread-1 (]: finished collecting timing info
[0m15:05:27.153646 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m15:05:27.163212 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m15:05:27.164280 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m15:05:27.164424 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m15:05:27.164536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:28.578686 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 1.41 seconds
[0m15:05:28.587348 [debug] [Thread-1 (]: finished collecting timing info
[0m15:05:28.587865 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m15:05:28.589095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0d40fb-019e-4338-b7eb-f0f63f0ded55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8900a0cf40>]}
[0m15:05:28.589712 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 1.44s]
[0m15:05:28.590349 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m15:05:28.592309 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:05:28.593200 [info ] [MainThread]: 
[0m15:05:28.593571 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 6.96 seconds (6.96s).
[0m15:05:28.593886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:28.594038 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m15:05:28.604465 [info ] [MainThread]: 
[0m15:05:28.604806 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:28.605084 [info ] [MainThread]: 
[0m15:05:28.605313 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:05:28.605608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8900987070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89009ef460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89009ee9e0>]}
[0m15:05:28.605831 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 15:07:56.459782 | 9364c8a4-a059-4b04-bd0b-9072fb987c3f ==============================
[0m15:07:56.459854 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:07:56.460579 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:07:56.460717 [debug] [MainThread]: Tracking: tracking
[0m15:07:56.481976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432b39b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432b3a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432b38b50>]}
[0m15:07:56.526471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:07:56.526802 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m15:07:56.536921 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m15:07:56.558532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9364c8a4-a059-4b04-bd0b-9072fb987c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432c3c0d0>]}
[0m15:07:56.563183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9364c8a4-a059-4b04-bd0b-9072fb987c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4312392d0>]}
[0m15:07:56.563375 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:07:56.563547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9364c8a4-a059-4b04-bd0b-9072fb987c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4207396f0>]}
[0m15:07:56.564396 [info ] [MainThread]: 
[0m15:07:56.564786 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:07:56.565453 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m15:07:56.572897 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m15:07:56.573065 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m15:07:56.573158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:58.370640 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.8 seconds
[0m15:07:58.374876 [debug] [ThreadPool]: On list_materialize: Close
[0m15:07:58.380497 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m15:07:58.390503 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m15:07:58.390919 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m15:07:58.391130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:59.811572 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.42 seconds
[0m15:07:59.817186 [debug] [ThreadPool]: On list_materialize_public: Close
[0m15:07:59.818893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9364c8a4-a059-4b04-bd0b-9072fb987c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432b31600>]}
[0m15:07:59.820067 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m15:07:59.820552 [info ] [MainThread]: 
[0m15:07:59.828212 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m15:07:59.828976 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m15:07:59.829875 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m15:07:59.830116 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m15:07:59.830374 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m15:07:59.834853 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m15:07:59.835635 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:59.835847 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m15:07:59.851421 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:07:59.851655 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m15:07:59.851783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:01.428902 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.58 seconds
[0m15:08:01.444737 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m15:08:01.445851 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:08:01.446042 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m15:08:02.551755 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.11 seconds
[0m15:08:02.573078 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:02.573538 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m15:08:02.574739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9364c8a4-a059-4b04-bd0b-9072fb987c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432b31600>]}
[0m15:08:02.575300 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.75s]
[0m15:08:02.576292 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m15:08:02.577228 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m15:08:02.577554 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m15:08:02.578259 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m15:08:02.578440 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m15:08:02.578607 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m15:08:02.582277 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m15:08:02.583039 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:02.583199 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m15:08:02.592419 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m15:08:02.592560 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m15:08:02.592672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:03.908389 [debug] [Thread-1 (]: SQL status: DROP VIEW in 1.32 seconds
[0m15:08:03.916395 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m15:08:03.917785 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m15:08:03.918058 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m15:08:04.139105 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.22 seconds
[0m15:08:04.141571 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:04.141765 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m15:08:04.142476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9364c8a4-a059-4b04-bd0b-9072fb987c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432d00eb0>]}
[0m15:08:04.143220 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 1.56s]
[0m15:08:04.143920 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m15:08:04.145827 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:08:04.147134 [info ] [MainThread]: 
[0m15:08:04.147612 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 7.58 seconds (7.58s).
[0m15:08:04.147968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:04.148163 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m15:08:04.160316 [info ] [MainThread]: 
[0m15:08:04.160684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:04.160980 [info ] [MainThread]: 
[0m15:08:04.161244 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:08:04.161673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432cce2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432cce980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432ccdcf0>]}
[0m15:08:04.161983 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 15:13:38.806878 | 468ab031-069c-4e39-938f-e0d8db5ce013 ==============================
[0m15:13:38.806950 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:13:38.807680 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:13:38.807831 [debug] [MainThread]: Tracking: tracking
[0m15:13:38.831822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfa839b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfa83a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfa838b50>]}
[0m15:13:38.876984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:13:38.877314 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m15:13:38.887380 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m15:13:38.908469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '468ab031-069c-4e39-938f-e0d8db5ce013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd87c40d0>]}
[0m15:13:38.912897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '468ab031-069c-4e39-938f-e0d8db5ce013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcf8f392d0>]}
[0m15:13:38.913082 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:13:38.913254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '468ab031-069c-4e39-938f-e0d8db5ce013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd87116f0>]}
[0m15:13:38.914094 [info ] [MainThread]: 
[0m15:13:38.914481 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:13:38.915145 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m15:13:38.922615 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m15:13:38.922806 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m15:13:38.922906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:40.375132 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.45 seconds
[0m15:13:40.383098 [debug] [ThreadPool]: On list_materialize: Close
[0m15:13:40.385679 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m15:13:40.392448 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m15:13:40.392612 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m15:13:40.392734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:41.770369 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.38 seconds
[0m15:13:41.777122 [debug] [ThreadPool]: On list_materialize_public: Close
[0m15:13:41.778963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '468ab031-069c-4e39-938f-e0d8db5ce013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd87eef50>]}
[0m15:13:41.779968 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m15:13:41.780361 [info ] [MainThread]: 
[0m15:13:41.787039 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m15:13:41.787755 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m15:13:41.788542 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m15:13:41.788749 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m15:13:41.788967 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m15:13:41.792896 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m15:13:41.793344 [debug] [Thread-1 (]: finished collecting timing info
[0m15:13:41.793500 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m15:13:41.806868 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:13:41.807127 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m15:13:41.807249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:43.261559 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.45 seconds
[0m15:13:43.278616 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m15:13:43.279937 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:13:43.280136 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m15:13:44.385067 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.1 seconds
[0m15:13:44.406767 [debug] [Thread-1 (]: finished collecting timing info
[0m15:13:44.407200 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m15:13:44.408303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468ab031-069c-4e39-938f-e0d8db5ce013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd87eef50>]}
[0m15:13:44.408821 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.62s]
[0m15:13:44.409813 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m15:13:44.410786 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m15:13:44.411095 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m15:13:44.411762 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m15:13:44.411938 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m15:13:44.412100 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m15:13:44.415993 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m15:13:44.416692 [debug] [Thread-1 (]: finished collecting timing info
[0m15:13:44.416850 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m15:13:44.426926 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m15:13:44.427160 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m15:13:44.427295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:45.846713 [debug] [Thread-1 (]: SQL status: DROP VIEW in 1.42 seconds
[0m15:13:45.852869 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m15:13:45.854014 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m15:13:45.854297 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m15:13:46.100264 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.25 seconds
[0m15:13:46.108901 [debug] [Thread-1 (]: finished collecting timing info
[0m15:13:46.109233 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m15:13:46.110265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468ab031-069c-4e39-938f-e0d8db5ce013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd8884eb0>]}
[0m15:13:46.110749 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 1.70s]
[0m15:13:46.111267 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m15:13:46.112762 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:13:46.113355 [info ] [MainThread]: 
[0m15:13:46.113625 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 7.20 seconds (7.20s).
[0m15:13:46.113864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:46.113981 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m15:13:46.122508 [info ] [MainThread]: 
[0m15:13:46.122772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:46.122986 [info ] [MainThread]: 
[0m15:13:46.123174 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:13:46.123433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd8855b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd8857430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd88553c0>]}
[0m15:13:46.123627 [debug] [MainThread]: Flushing usage events
