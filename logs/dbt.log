

============================== 2022-11-30 21:57:05.278386 | 65011b94-4722-47b3-9864-a96d8e0daab7 ==============================
[0m21:57:05.278399 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:57:05.278631 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_name': 'onward-materialize', 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m21:57:05.278722 [debug] [MainThread]: Tracking: tracking
[0m21:57:05.304607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f982859dc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f982859c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f982859ceb0>]}
[0m21:57:05.305510 [info ] [MainThread]: Setting up your profile.
[0m21:57:36.600694 [info ] [MainThread]: No sample profile found for materialize.
[0m21:57:36.601034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985a19b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985a199a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985a19ac80>]}
[0m21:57:36.601212 [debug] [MainThread]: Flushing usage events


============================== 2022-11-30 22:00:20.334156 | 17ff1ee8-e84c-4c57-83be-eca5afe2b090 ==============================
[0m22:00:20.334170 [info ] [MainThread]: Running with dbt=1.3.1
[0m22:00:20.334610 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_name': 'onward-materialize', 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m22:00:20.334706 [debug] [MainThread]: Tracking: tracking
[0m22:00:20.363208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca886b5cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca886b6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca886b6ce0>]}
[0m22:00:20.364315 [info ] [MainThread]: Setting up your profile.
[0m22:00:21.816692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca886b5240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca886b4430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5815fcd0>]}
[0m22:00:21.816944 [debug] [MainThread]: Flushing usage events


============================== 2022-11-30 22:01:20.796820 | cbb9001b-851b-4868-baf4-3f63967ad9ba ==============================
[0m22:01:20.796833 [info ] [MainThread]: Running with dbt=1.3.1
[0m22:01:20.797228 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
[0m22:01:20.797321 [debug] [MainThread]: Tracking: tracking
[0m22:01:20.822282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64a6f6fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64a6f77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64a6f7400>]}
[0m22:01:20.823286 [info ] [MainThread]: To view your profiles.yml file, run:

open /Users/claytonvanhovel/Desktop/onward-materialize-dbt
[0m22:01:20.823692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64a6f77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64a6f7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64a6f7df0>]}
[0m22:01:20.823845 [debug] [MainThread]: Flushing usage events


============================== 2022-11-30 23:40:37.116530 | 344d003c-87fe-49e4-ae60-417174748ba9 ==============================
[0m23:40:37.116541 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:40:37.116939 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
[0m23:40:37.117046 [debug] [MainThread]: Tracking: tracking
[0m23:40:37.153121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a221ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a221f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a221f1f0>]}
[0m23:40:37.154074 [info ] [MainThread]: To view your profiles.yml file, run:

open /Users/claytonvanhovel/Desktop/onward-materialize-dbt
[0m23:40:37.154432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a221f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a221f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a221fe50>]}
[0m23:40:37.154572 [debug] [MainThread]: Flushing usage events


============================== 2022-11-30 23:43:19.468005 | cd9b6005-bb63-4c9e-a6da-869d15f7311a ==============================
[0m23:43:19.468017 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:43:19.468420 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
[0m23:43:19.468516 [debug] [MainThread]: Tracking: tracking
[0m23:43:19.494763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9294ceb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9294cf250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9294cedd0>]}
[0m23:43:19.495847 [info ] [MainThread]: To view your profiles.yml file, run:

open /Users/claytonvanhovel/Desktop/onward-materialize-dbt
[0m23:43:19.496131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9294cf250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9294cedd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9294cf820>]}
[0m23:43:19.496281 [debug] [MainThread]: Flushing usage events


============================== 2022-11-30 23:47:59.009637 | 31873c44-4c7a-4d9b-8fc9-35a36fea41c6 ==============================
[0m23:47:59.009703 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:47:59.011006 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:47:59.011152 [debug] [MainThread]: Tracking: tracking
[0m23:47:59.051867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea2fa830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea2f8e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea2fa950>]}
[0m23:47:59.064680 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m23:47:59.064918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '31873c44-4c7a-4d9b-8fc9-35a36fea41c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea2f8fd0>]}
[0m23:47:59.081406 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
[0m23:47:59.082992 [debug] [MainThread]: Parsing macros/catalog.sql
[0m23:47:59.084283 [debug] [MainThread]: Parsing macros/adapters.sql
[0m23:47:59.091152 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
[0m23:47:59.093290 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m23:47:59.096343 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m23:47:59.102483 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m23:47:59.104542 [debug] [MainThread]: Parsing macros/materializations/source.sql
[0m23:47:59.106545 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m23:47:59.108522 [debug] [MainThread]: Parsing macros/materializations/sink.sql
[0m23:47:59.110447 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m23:47:59.111035 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m23:47:59.112190 [debug] [MainThread]: Parsing macros/catalog.sql
[0m23:47:59.113636 [debug] [MainThread]: Parsing macros/relations.sql
[0m23:47:59.114546 [debug] [MainThread]: Parsing macros/adapters.sql
[0m23:47:59.130474 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m23:47:59.131172 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m23:47:59.132205 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:47:59.132578 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:47:59.133494 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:47:59.138363 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:47:59.138660 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:47:59.139433 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:47:59.140075 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m23:47:59.142446 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m23:47:59.143868 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m23:47:59.144898 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m23:47:59.155608 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m23:47:59.164394 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m23:47:59.172263 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m23:47:59.175124 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m23:47:59.176245 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m23:47:59.177368 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m23:47:59.182555 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m23:47:59.192907 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m23:47:59.193884 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m23:47:59.198138 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m23:47:59.204984 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m23:47:59.216132 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m23:47:59.219699 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m23:47:59.221820 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m23:47:59.225408 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m23:47:59.226180 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m23:47:59.228278 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m23:47:59.229668 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m23:47:59.234206 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m23:47:59.246263 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m23:47:59.247162 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m23:47:59.248688 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m23:47:59.249619 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m23:47:59.250165 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m23:47:59.250652 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m23:47:59.251071 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m23:47:59.251897 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m23:47:59.255191 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m23:47:59.260551 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m23:47:59.261033 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m23:47:59.261789 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m23:47:59.262367 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m23:47:59.262920 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:47:59.263669 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m23:47:59.264159 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m23:47:59.264779 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m23:47:59.265510 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:47:59.266945 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:47:59.267688 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m23:47:59.268324 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m23:47:59.268952 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m23:47:59.269563 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:47:59.270116 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m23:47:59.270763 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m23:47:59.271308 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m23:47:59.276960 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m23:47:59.277619 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m23:47:59.278179 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:47:59.279254 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:47:59.280595 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m23:47:59.281222 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m23:47:59.282119 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m23:47:59.282750 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m23:47:59.284021 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m23:47:59.286135 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m23:47:59.288029 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m23:47:59.297573 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m23:47:59.298793 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m23:47:59.307334 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m23:47:59.310097 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m23:47:59.314602 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m23:47:59.320785 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m23:47:59.324622 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m23:47:59.503863 [debug] [MainThread]: 1699: static parser successfully parsed sources/driver_location.sql
[0m23:47:59.549056 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

[0m23:47:59.552531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31873c44-4c7a-4d9b-8fc9-35a36fea41c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f8853700>]}
[0m23:47:59.557586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31873c44-4c7a-4d9b-8fc9-35a36fea41c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea2f00d0>]}
[0m23:47:59.557787 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m23:47:59.557948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31873c44-4c7a-4d9b-8fc9-35a36fea41c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea3c1e40>]}
[0m23:47:59.558817 [info ] [MainThread]: 
[0m23:47:59.559223 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m23:47:59.559858 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m23:47:59.567367 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m23:47:59.567527 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m23:47:59.567616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:01.268607 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.7 seconds
[0m23:48:01.276785 [debug] [ThreadPool]: On list_materialize: Close
[0m23:48:01.279315 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m23:48:01.287109 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m23:48:01.287343 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m23:48:01.287499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:48:02.963345 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.68 seconds
[0m23:48:02.968985 [debug] [ThreadPool]: On list_materialize_public: Close
[0m23:48:02.970631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31873c44-4c7a-4d9b-8fc9-35a36fea41c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f883fa90>]}
[0m23:48:02.971465 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m23:48:02.971783 [info ] [MainThread]: 
[0m23:48:02.978615 [debug] [Thread-1 (]: Began running node model.onward_materialize.driver_location
[0m23:48:02.979038 [info ] [Thread-1 (]: 1 of 1 START sql source model public.driver_location ........................... [RUN]
[0m23:48:02.979797 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.driver_location"
[0m23:48:02.979942 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.driver_location
[0m23:48:02.980073 [debug] [Thread-1 (]: Compiling model.onward_materialize.driver_location
[0m23:48:02.982905 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.driver_location"
[0m23:48:02.983695 [debug] [Thread-1 (]: finished collecting timing info
[0m23:48:02.983866 [debug] [Thread-1 (]: Began executing node model.onward_materialize.driver_location
[0m23:48:02.999123 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.driver_location"
[0m23:48:02.999348 [debug] [Thread-1 (]: On model.onward_materialize.driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.driver_location"} */

      drop source if exists "materialize"."public"."driver_location" cascade
    
[0m23:48:02.999470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:04.540275 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.54 seconds
[0m23:48:04.553164 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.driver_location"
[0m23:48:04.554272 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.driver_location"
[0m23:48:04.554443 [debug] [Thread-1 (]: On model.onward_materialize.driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.driver_location"} */


CREATE SOURCE driver_location
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m23:48:05.677605 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.12 seconds
[0m23:48:05.695338 [debug] [Thread-1 (]: finished collecting timing info
[0m23:48:05.695723 [debug] [Thread-1 (]: On model.onward_materialize.driver_location: Close
[0m23:48:05.696701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31873c44-4c7a-4d9b-8fc9-35a36fea41c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea44bc10>]}
[0m23:48:05.697194 [info ] [Thread-1 (]: 1 of 1 OK created sql source model public.driver_location ...................... [[32mCREATE SOURCE[0m in 2.72s]
[0m23:48:05.699529 [debug] [Thread-1 (]: Finished running node model.onward_materialize.driver_location
[0m23:48:05.701191 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m23:48:05.701795 [info ] [MainThread]: 
[0m23:48:05.702066 [info ] [MainThread]: Finished running 1 source model in 0 hours 0 minutes and 6.14 seconds (6.14s).
[0m23:48:05.702314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:05.702444 [debug] [MainThread]: Connection 'model.onward_materialize.driver_location' was properly closed.
[0m23:48:05.712689 [info ] [MainThread]: 
[0m23:48:05.713042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:05.713302 [info ] [MainThread]: 
[0m23:48:05.713515 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:48:05.713879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea44a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea44b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ea449c90>]}
[0m23:48:05.714155 [debug] [MainThread]: Flushing usage events


============================== 2022-11-30 23:50:53.032355 | 96fda9e9-154c-4290-8351-63c661247e7c ==============================
[0m23:50:53.032686 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:50:53.033719 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:50:53.033868 [debug] [MainThread]: Tracking: tracking
[0m23:50:53.058120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c2291d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c2292530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c2291ea0>]}
[0m23:50:53.086568 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:50:53.086847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '96fda9e9-154c-4290-8351-63c661247e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c0b40be0>]}
[0m23:50:53.102790 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
[0m23:50:53.104197 [debug] [MainThread]: Parsing macros/catalog.sql
[0m23:50:53.105420 [debug] [MainThread]: Parsing macros/adapters.sql
[0m23:50:53.111988 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
[0m23:50:53.114046 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m23:50:53.116861 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m23:50:53.122821 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m23:50:53.124946 [debug] [MainThread]: Parsing macros/materializations/source.sql
[0m23:50:53.126924 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m23:50:53.128837 [debug] [MainThread]: Parsing macros/materializations/sink.sql
[0m23:50:53.130685 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m23:50:53.131239 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m23:50:53.132332 [debug] [MainThread]: Parsing macros/catalog.sql
[0m23:50:53.133695 [debug] [MainThread]: Parsing macros/relations.sql
[0m23:50:53.134572 [debug] [MainThread]: Parsing macros/adapters.sql
[0m23:50:53.149438 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m23:50:53.150047 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m23:50:53.151081 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:50:53.151447 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:50:53.152314 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:50:53.156414 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:50:53.156696 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:50:53.157429 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:50:53.158053 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m23:50:53.160350 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m23:50:53.161725 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m23:50:53.162699 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m23:50:53.172818 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m23:50:53.180897 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m23:50:53.188411 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m23:50:53.191173 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m23:50:53.192220 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m23:50:53.193286 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m23:50:53.198168 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m23:50:53.207723 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m23:50:53.208625 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m23:50:53.212839 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m23:50:53.219379 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m23:50:53.229859 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m23:50:53.233251 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m23:50:53.235334 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m23:50:53.238695 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m23:50:53.239455 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m23:50:53.241507 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m23:50:53.242842 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m23:50:53.247131 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m23:50:53.258444 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m23:50:53.259322 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m23:50:53.260796 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m23:50:53.261703 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m23:50:53.262236 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m23:50:53.262708 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m23:50:53.263105 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m23:50:53.263905 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m23:50:53.267118 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m23:50:53.272219 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m23:50:53.272696 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m23:50:53.273419 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m23:50:53.273977 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m23:50:53.274521 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:50:53.275262 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m23:50:53.275747 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m23:50:53.276349 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m23:50:53.277082 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:50:53.278510 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:50:53.279263 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m23:50:53.279924 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m23:50:53.280576 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m23:50:53.281203 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:50:53.281761 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m23:50:53.282404 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m23:50:53.282953 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m23:50:53.288508 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m23:50:53.289264 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m23:50:53.289843 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:50:53.290927 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:50:53.292239 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m23:50:53.292849 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m23:50:53.293745 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m23:50:53.294387 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m23:50:53.295695 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m23:50:53.297675 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m23:50:53.299357 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m23:50:53.308389 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m23:50:53.309566 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m23:50:53.318050 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m23:50:53.320711 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m23:50:53.325030 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m23:50:53.330954 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m23:50:53.334678 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m23:50:53.509519 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m23:50:53.517594 [debug] [MainThread]: 1699: static parser successfully parsed sources/src_driver_location.sql
[0m23:50:53.537337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c242d3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c2435fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c24358a0>]}
[0m23:50:53.537544 [debug] [MainThread]: Flushing usage events
[0m23:50:53.916899 [error] [MainThread]: Encountered an error:
Compilation Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Model 'model.onward_materialize.json_driver_location' (models/materializedviews/json_driver_location.sql) depends on a node named 'driver_location' which was not found


============================== 2022-11-30 23:51:14.613020 | 6d78ed16-608f-4ff7-9666-6b0d357ff016 ==============================
[0m23:51:14.613074 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:51:14.613791 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:51:14.613936 [debug] [MainThread]: Tracking: tracking
[0m23:51:14.642177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3a2fd6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3a2fde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3a2ff700>]}
[0m23:51:14.671721 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:51:14.672018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d78ed16-608f-4ff7-9666-6b0d357ff016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c187d8be0>]}
[0m23:51:14.688188 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
[0m23:51:14.689723 [debug] [MainThread]: Parsing macros/catalog.sql
[0m23:51:14.691120 [debug] [MainThread]: Parsing macros/adapters.sql
[0m23:51:14.698145 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
[0m23:51:14.700260 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m23:51:14.703188 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m23:51:14.709228 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m23:51:14.711350 [debug] [MainThread]: Parsing macros/materializations/source.sql
[0m23:51:14.713425 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m23:51:14.715378 [debug] [MainThread]: Parsing macros/materializations/sink.sql
[0m23:51:14.717254 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m23:51:14.717834 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m23:51:14.719135 [debug] [MainThread]: Parsing macros/catalog.sql
[0m23:51:14.720641 [debug] [MainThread]: Parsing macros/relations.sql
[0m23:51:14.721576 [debug] [MainThread]: Parsing macros/adapters.sql
[0m23:51:14.737320 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m23:51:14.737937 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m23:51:14.738999 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:51:14.739367 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:51:14.740268 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:51:14.744609 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:51:14.744904 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:51:14.745660 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:51:14.746291 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m23:51:14.748629 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m23:51:14.750098 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m23:51:14.751303 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m23:51:14.761935 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m23:51:14.770668 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m23:51:14.778599 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m23:51:14.781475 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m23:51:14.782564 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m23:51:14.783632 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m23:51:14.789149 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m23:51:14.800271 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m23:51:14.801256 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m23:51:14.805504 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m23:51:14.812638 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m23:51:14.824096 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m23:51:14.827650 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m23:51:14.829846 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m23:51:14.833389 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m23:51:14.834165 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m23:51:14.836282 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m23:51:14.837655 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m23:51:14.842133 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m23:51:14.854126 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m23:51:14.855019 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m23:51:14.856562 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m23:51:14.857556 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m23:51:14.858098 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m23:51:14.858579 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m23:51:14.858980 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m23:51:14.859795 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m23:51:14.863100 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m23:51:14.868449 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m23:51:14.868943 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m23:51:14.869666 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m23:51:14.870231 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m23:51:14.870813 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m23:51:14.871555 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m23:51:14.872065 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m23:51:14.872677 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m23:51:14.873419 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m23:51:14.874836 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m23:51:14.875586 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m23:51:14.876219 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m23:51:14.876845 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m23:51:14.877456 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m23:51:14.878004 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m23:51:14.878649 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m23:51:14.879188 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m23:51:14.883531 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m23:51:14.884162 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m23:51:14.884700 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m23:51:14.885797 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m23:51:14.887142 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m23:51:14.887748 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m23:51:14.888639 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m23:51:14.889274 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m23:51:14.890550 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m23:51:14.892559 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m23:51:14.894255 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m23:51:14.903692 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m23:51:14.904881 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m23:51:14.913444 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m23:51:14.916154 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m23:51:14.920678 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m23:51:14.926855 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m23:51:14.930719 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m23:51:15.105590 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m23:51:15.113671 [debug] [MainThread]: 1699: static parser successfully parsed sources/src_driver_location.sql
[0m23:51:15.156147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d78ed16-608f-4ff7-9666-6b0d357ff016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2826d720>]}
[0m23:51:15.161158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d78ed16-608f-4ff7-9666-6b0d357ff016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3a204460>]}
[0m23:51:15.161352 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m23:51:15.161525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d78ed16-608f-4ff7-9666-6b0d357ff016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2825a980>]}
[0m23:51:15.162490 [info ] [MainThread]: 
[0m23:51:15.162893 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m23:51:15.163576 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m23:51:15.170937 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m23:51:15.171094 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m23:51:15.171189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:16.813903 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.64 seconds
[0m23:51:16.818912 [debug] [ThreadPool]: On list_materialize: Close
[0m23:51:16.821354 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m23:51:16.827962 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m23:51:16.828173 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m23:51:16.828325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:18.380116 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.55 seconds
[0m23:51:18.385147 [debug] [ThreadPool]: On list_materialize_public: Close
[0m23:51:18.386777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d78ed16-608f-4ff7-9666-6b0d357ff016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c282a7430>]}
[0m23:51:18.387794 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m23:51:18.388143 [info ] [MainThread]: 
[0m23:51:18.394457 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m23:51:18.394757 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m23:51:18.395636 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m23:51:18.395824 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m23:51:18.396012 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m23:51:18.399695 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m23:51:18.400256 [debug] [Thread-1 (]: finished collecting timing info
[0m23:51:18.400435 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m23:51:18.414897 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m23:51:18.415371 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m23:51:18.415512 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE driver_location
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m23:51:18.415647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:20.497290 [debug] [Thread-1 (]: Postgres adapter: Postgres error: catalog item 'driver_location' already exists

[0m23:51:20.499688 [debug] [Thread-1 (]: finished collecting timing info
[0m23:51:20.500172 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m23:51:20.501979 [debug] [Thread-1 (]: Database Error in model src_driver_location (models/sources/src_driver_location.sql)
  catalog item 'driver_location' already exists
  compiled Code at target/run/onward_materialize/models/sources/src_driver_location.sql
[0m23:51:20.502617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d78ed16-608f-4ff7-9666-6b0d357ff016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3a480e80>]}
[0m23:51:20.503205 [error] [Thread-1 (]: 1 of 2 ERROR creating sql source model public.src_driver_location .............. [[31mERROR[0m in 2.11s]
[0m23:51:20.505653 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m23:51:20.506657 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m23:51:20.506872 [info ] [Thread-1 (]: 2 of 2 SKIP relation public.json_driver_location ............................... [[33mSKIP[0m]
[0m23:51:20.507252 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m23:51:20.508449 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m23:51:20.509074 [info ] [MainThread]: 
[0m23:51:20.509341 [info ] [MainThread]: Finished running 1 source model, 1 materializedview model in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m23:51:20.509593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:20.509720 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m23:51:20.518178 [info ] [MainThread]: 
[0m23:51:20.518472 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:51:20.518733 [info ] [MainThread]: 
[0m23:51:20.518959 [error] [MainThread]: [33mDatabase Error in model src_driver_location (models/sources/src_driver_location.sql)[0m
[0m23:51:20.519186 [error] [MainThread]:   catalog item 'driver_location' already exists
[0m23:51:20.519396 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/sources/src_driver_location.sql
[0m23:51:20.519620 [info ] [MainThread]: 
[0m23:51:20.519844 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m23:51:20.520185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2826e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2826dd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3a4803d0>]}
[0m23:51:20.520438 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 17:43:48.558376 | cf9d5f86-85be-4667-be48-99059f9c80fa ==============================
[0m17:43:48.558447 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:43:48.559605 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m17:43:48.559806 [debug] [MainThread]: Tracking: tracking
[0m17:43:48.597226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32925750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32925de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32924760>]}
[0m17:43:48.645104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:43:48.645273 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:43:48.649994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf9d5f86-85be-4667-be48-99059f9c80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32ad8610>]}
[0m17:43:48.655653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf9d5f86-85be-4667-be48-99059f9c80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32aad570>]}
[0m17:43:48.655864 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m17:43:48.656039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf9d5f86-85be-4667-be48-99059f9c80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32aad600>]}
[0m17:43:48.656988 [info ] [MainThread]: 
[0m17:43:48.657398 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:43:48.658052 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m17:43:48.665648 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m17:43:48.665784 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m17:43:48.665877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:50.276675 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.61 seconds
[0m17:43:50.282861 [debug] [ThreadPool]: On list_materialize_public: Close
[0m17:43:50.284759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf9d5f86-85be-4667-be48-99059f9c80fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32a8ff70>]}
[0m17:43:50.285594 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m17:43:50.285913 [info ] [MainThread]: 
[0m17:43:50.291427 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m17:43:50.292094 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m17:43:50.292297 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m17:43:50.292511 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m17:43:50.296583 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m17:43:50.298134 [debug] [Thread-1 (]: finished collecting timing info
[0m17:43:50.298323 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m17:43:50.298567 [debug] [Thread-1 (]: finished collecting timing info
[0m17:43:50.299370 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m17:43:50.300048 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m17:43:50.300589 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m17:43:50.300754 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m17:43:50.300889 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m17:43:50.304204 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m17:43:50.304853 [debug] [Thread-1 (]: finished collecting timing info
[0m17:43:50.305024 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m17:43:50.305174 [debug] [Thread-1 (]: finished collecting timing info
[0m17:43:50.305782 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m17:43:50.306832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:50.307037 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m17:43:50.314125 [info ] [MainThread]: Done.
[0m17:43:50.317330 [debug] [MainThread]: Acquiring new materialize connection "generate_catalog"
[0m17:43:50.317482 [info ] [MainThread]: Building catalog
[0m17:43:50.319003 [debug] [ThreadPool]: Acquiring new materialize connection "materialize.information_schema"
[0m17:43:50.325298 [debug] [ThreadPool]: Using materialize connection "materialize.information_schema"
[0m17:43:50.325503 [debug] [ThreadPool]: On materialize.information_schema: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "materialize.information_schema"} */
select
            d.name as table_database,
            s.name as table_schema,
            o.name as table_name,
            case when o.type = 'materialized-view' then 'materializedview' else o.type end as table_type,
            '' as table_comment,
            c.name as column_name,
            c.position as column_index,
            c.type as column_type,
            '' as column_comment,
            '' as table_owner
        from mz_objects o
        join mz_schemas s on o.schema_id = s.id
        join mz_databases d on s.database_id = d.id and d.name = 'materialize'
        join mz_columns c on c.id = o.id
        where s.name in ('public')
[0m17:43:50.325615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:51.655159 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.33 seconds
[0m17:43:51.664856 [debug] [ThreadPool]: On materialize.information_schema: Close
[0m17:43:51.675996 [info ] [MainThread]: Catalog written to /Users/claytonvanhovel/Desktop/onward-materialize-dbt/target/catalog.json
[0m17:43:51.676519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32925750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc104aa740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc104aa4a0>]}
[0m17:43:51.676846 [debug] [MainThread]: Flushing usage events
[0m17:43:52.042708 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:43:52.043312 [debug] [MainThread]: Connection 'materialize.information_schema' was properly closed.


============================== 2022-12-01 17:43:56.387046 | 0547d36c-1605-4f08-bea6-cca23fec0295 ==============================
[0m17:43:56.387118 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:43:56.387617 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m17:43:56.387737 [debug] [MainThread]: Tracking: tracking
[0m17:43:56.406823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda297fa920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda297fb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda297f9480>]}
[0m17:43:56.408846 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m17:43:56.409059 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m17:43:56.409204 [info ] [MainThread]: 
[0m17:43:56.409350 [info ] [MainThread]: 
[0m17:43:56.409489 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-12-01 17:58:40.190681 | 8fe1c4cb-a864-4cad-9cf6-347cadb45948 ==============================
[0m17:58:40.190723 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:58:40.191241 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:58:40.191360 [debug] [MainThread]: Tracking: tracking
[0m17:58:40.217963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd2801a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd2802230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd2801b70>]}
[0m17:58:40.261702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:58:40.262014 [debug] [MainThread]: Partial parsing: deleted source source.onward_materialize.kafka.driver_location
[0m17:58:40.262118 [debug] [MainThread]: Partial parsing: deleted source source.onward_materialize.postgres.postgres_table_a
[0m17:58:40.262198 [debug] [MainThread]: Partial parsing: deleted source source.onward_materialize.postgres.postgres_table_b
[0m17:58:40.262284 [debug] [MainThread]: Partial parsing: update schema file: onward_materialize://models/schema.yml
[0m17:58:40.262449 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m17:58:40.262591 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m17:58:40.273634 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m17:58:40.283031 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m17:58:40.285727 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m17:58:40.306984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fe1c4cb-a864-4cad-9cf6-347cadb45948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb042da80>]}
[0m17:58:40.312018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fe1c4cb-a864-4cad-9cf6-347cadb45948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb03c4520>]}
[0m17:58:40.312205 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:58:40.312371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fe1c4cb-a864-4cad-9cf6-347cadb45948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb03c5420>]}
[0m17:58:40.313195 [info ] [MainThread]: 
[0m17:58:40.313583 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:58:40.314222 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m17:58:40.321333 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m17:58:40.321497 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m17:58:40.321582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:41.825440 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.5 seconds
[0m17:58:41.831140 [debug] [ThreadPool]: On list_materialize: Close
[0m17:58:41.834501 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m17:58:41.842536 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m17:58:41.842790 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m17:58:41.842947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:43.262430 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.42 seconds
[0m17:58:43.267582 [debug] [ThreadPool]: On list_materialize_public: Close
[0m17:58:43.269296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fe1c4cb-a864-4cad-9cf6-347cadb45948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb03affd0>]}
[0m17:58:43.270143 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m17:58:43.270465 [info ] [MainThread]: 
[0m17:58:43.276865 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m17:58:43.277579 [info ] [Thread-1 (]: 1 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m17:58:43.278301 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m17:58:43.278475 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m17:58:43.278661 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m17:58:43.282696 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m17:58:43.283385 [debug] [Thread-1 (]: finished collecting timing info
[0m17:58:43.283569 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m17:58:43.299609 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m17:58:43.300229 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m17:58:43.300372 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    



 CREATE VIEW json_driver_location AS
  SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location";
  );
[0m17:58:43.300503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:44.608379 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected SELECT, VALUES, or a subquery in the query body, found CREATE
LINE 11:  CREATE VIEW json_driver_location AS
          ^

[0m17:58:44.610815 [debug] [Thread-1 (]: finished collecting timing info
[0m17:58:44.611249 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m17:58:44.612452 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Expected SELECT, VALUES, or a subquery in the query body, found CREATE
  LINE 11:  CREATE VIEW json_driver_location AS
            ^
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m17:58:44.612876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fe1c4cb-a864-4cad-9cf6-347cadb45948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb03affd0>]}
[0m17:58:44.613414 [error] [Thread-1 (]: 1 of 2 ERROR creating sql materializedview model public.json_driver_location ... [[31mERROR[0m in 1.33s]
[0m17:58:44.614938 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m17:58:44.615186 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m17:58:44.615435 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m17:58:44.616133 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m17:58:44.616477 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m17:58:44.616662 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m17:58:44.620153 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m17:58:44.620771 [debug] [Thread-1 (]: finished collecting timing info
[0m17:58:44.620942 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m17:58:44.632523 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m17:58:44.633008 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m17:58:44.633122 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m17:58:44.633221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:46.942940 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 2.31 seconds
[0m17:58:46.959243 [debug] [Thread-1 (]: finished collecting timing info
[0m17:58:46.959600 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m17:58:46.960453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fe1c4cb-a864-4cad-9cf6-347cadb45948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd29c6980>]}
[0m17:58:46.960857 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.34s]
[0m17:58:46.961277 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m17:58:46.962536 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:58:46.963065 [info ] [MainThread]: 
[0m17:58:46.963328 [info ] [MainThread]: Finished running 1 materializedview model, 1 source model in 0 hours 0 minutes and 6.65 seconds (6.65s).
[0m17:58:46.963572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:46.963701 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m17:58:46.971434 [info ] [MainThread]: 
[0m17:58:46.971750 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:58:46.972041 [info ] [MainThread]: 
[0m17:58:46.972290 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m17:58:46.972500 [error] [MainThread]:   Expected SELECT, VALUES, or a subquery in the query body, found CREATE
[0m17:58:46.972693 [error] [MainThread]:   LINE 11:  CREATE VIEW json_driver_location AS
[0m17:58:46.972885 [error] [MainThread]:             ^
[0m17:58:46.973074 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m17:58:46.973281 [info ] [MainThread]: 
[0m17:58:46.973497 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:58:46.973779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd29af5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb03d4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd29388e0>]}
[0m17:58:46.973991 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 17:59:15.121983 | 743b16ee-44fa-478e-a264-ff5486b6b450 ==============================
[0m17:59:15.122027 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:59:15.122616 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:59:15.122752 [debug] [MainThread]: Tracking: tracking
[0m17:59:15.148128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb92102980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb921030a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb921015a0>]}
[0m17:59:15.194570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:59:15.194925 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m17:59:15.204646 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m17:59:15.227526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '743b16ee-44fa-478e-a264-ff5486b6b450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8072c0d0>]}
[0m17:59:15.232561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '743b16ee-44fa-478e-a264-ff5486b6b450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9228c730>]}
[0m17:59:15.232762 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:59:15.232944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743b16ee-44fa-478e-a264-ff5486b6b450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb922adc00>]}
[0m17:59:15.233875 [info ] [MainThread]: 
[0m17:59:15.234325 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:59:15.235078 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m17:59:15.242389 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m17:59:15.242550 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m17:59:15.242639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:17.315001 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.07 seconds
[0m17:59:17.322657 [debug] [ThreadPool]: On list_materialize: Close
[0m17:59:17.325744 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m17:59:17.333084 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m17:59:17.333233 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m17:59:17.333320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:18.645293 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.31 seconds
[0m17:59:18.650867 [debug] [ThreadPool]: On list_materialize_public: Close
[0m17:59:18.652437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743b16ee-44fa-478e-a264-ff5486b6b450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb922bfd60>]}
[0m17:59:18.653287 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m17:59:18.653661 [info ] [MainThread]: 
[0m17:59:18.659909 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m17:59:18.660436 [info ] [Thread-1 (]: 1 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m17:59:18.660999 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m17:59:18.661195 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m17:59:18.661405 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m17:59:18.665896 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m17:59:18.666828 [debug] [Thread-1 (]: finished collecting timing info
[0m17:59:18.667061 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m17:59:18.684600 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m17:59:18.685250 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m17:59:18.685430 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    


  SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location";
  );
[0m17:59:18.685579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:20.016806 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected joined table, found comma
LINE 17:   FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS dat...
                           ^

[0m17:59:20.019381 [debug] [Thread-1 (]: finished collecting timing info
[0m17:59:20.019818 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m17:59:20.021414 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Expected joined table, found comma
  LINE 17:   FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS dat...
                             ^
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m17:59:20.022046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '743b16ee-44fa-478e-a264-ff5486b6b450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb922bfd60>]}
[0m17:59:20.022642 [error] [Thread-1 (]: 1 of 2 ERROR creating sql materializedview model public.json_driver_location ... [[31mERROR[0m in 1.36s]
[0m17:59:20.023681 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m17:59:20.023935 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m17:59:20.024459 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m17:59:20.025234 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m17:59:20.025408 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m17:59:20.025576 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m17:59:20.029690 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m17:59:20.030511 [debug] [Thread-1 (]: finished collecting timing info
[0m17:59:20.030689 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m17:59:20.047108 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m17:59:20.047327 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m17:59:20.047455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:21.527034 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.48 seconds
[0m17:59:21.533210 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m17:59:21.534277 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m17:59:21.534480 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m17:59:22.766107 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.23 seconds
[0m17:59:22.783262 [debug] [Thread-1 (]: finished collecting timing info
[0m17:59:22.783612 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m17:59:22.784549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '743b16ee-44fa-478e-a264-ff5486b6b450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb807e3b80>]}
[0m17:59:22.784945 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.76s]
[0m17:59:22.785379 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m17:59:22.786658 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:59:22.787213 [info ] [MainThread]: 
[0m17:59:22.787508 [info ] [MainThread]: Finished running 1 materializedview model, 1 source model in 0 hours 0 minutes and 7.55 seconds (7.55s).
[0m17:59:22.787759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:22.787884 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m17:59:22.795697 [info ] [MainThread]: 
[0m17:59:22.795991 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:59:22.796252 [info ] [MainThread]: 
[0m17:59:22.796461 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m17:59:22.796664 [error] [MainThread]:   Expected joined table, found comma
[0m17:59:22.796862 [error] [MainThread]:   LINE 17:   FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS dat...
[0m17:59:22.797056 [error] [MainThread]:                              ^
[0m17:59:22.797244 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m17:59:22.797449 [info ] [MainThread]: 
[0m17:59:22.797656 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:59:22.797939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb922adc00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb807eba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb807e9630>]}
[0m17:59:22.798149 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:02:44.048240 | e20110ad-abd9-4d60-ac2b-4c7e61423506 ==============================
[0m18:02:44.048422 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:02:44.049132 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:02:44.049253 [debug] [MainThread]: Tracking: tracking
[0m18:02:44.078477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa642980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa6430a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa6415a0>]}
[0m18:02:44.122872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:02:44.123201 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m18:02:44.132660 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m18:02:44.153958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e20110ad-abd9-4d60-ac2b-4c7e61423506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde85240d0>]}
[0m18:02:44.158684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e20110ad-abd9-4d60-ac2b-4c7e61423506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa774910>]}
[0m18:02:44.158887 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:02:44.159056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e20110ad-abd9-4d60-ac2b-4c7e61423506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa799c00>]}
[0m18:02:44.159931 [info ] [MainThread]: 
[0m18:02:44.160321 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:02:44.160987 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m18:02:44.168041 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m18:02:44.168178 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m18:02:44.168272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:45.690437 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.52 seconds
[0m18:02:45.700560 [debug] [ThreadPool]: On list_materialize: Close
[0m18:02:45.702538 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m18:02:45.707642 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m18:02:45.707811 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m18:02:45.707921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:47.330437 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.62 seconds
[0m18:02:47.335859 [debug] [ThreadPool]: On list_materialize_public: Close
[0m18:02:47.337528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e20110ad-abd9-4d60-ac2b-4c7e61423506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa7a7d60>]}
[0m18:02:47.338358 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:02:47.338683 [info ] [MainThread]: 
[0m18:02:47.345075 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m18:02:47.345781 [info ] [Thread-1 (]: 1 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m18:02:47.346555 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m18:02:47.346751 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m18:02:47.347004 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m18:02:47.351285 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m18:02:47.352262 [debug] [Thread-1 (]: finished collecting timing info
[0m18:02:47.352488 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m18:02:47.367930 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m18:02:47.368490 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m18:02:47.368637 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    

with

src_driver_location as (
    select key, CONVERT_FROM(data, 'utf8')::jsonb as data from "materialize"."public"."src_driver_location";
)

,final as (

  SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM src_driver_location;
)

select * from final;
  );
[0m18:02:47.368768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:48.669001 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected right parenthesis, found semicolon
LINE 12: ...b as data from "materialize"."public"."src_driver_location";
                                                                       ^

[0m18:02:48.670982 [debug] [Thread-1 (]: finished collecting timing info
[0m18:02:48.671381 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m18:02:48.672652 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Expected right parenthesis, found semicolon
  LINE 12: ...b as data from "materialize"."public"."src_driver_location";
                                                                         ^
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m18:02:48.673085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e20110ad-abd9-4d60-ac2b-4c7e61423506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa7a7d60>]}
[0m18:02:48.673636 [error] [Thread-1 (]: 1 of 2 ERROR creating sql materializedview model public.json_driver_location ... [[31mERROR[0m in 1.33s]
[0m18:02:48.674614 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m18:02:48.674854 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m18:02:48.675088 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m18:02:48.675817 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m18:02:48.676049 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m18:02:48.676233 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m18:02:48.680138 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m18:02:48.681867 [debug] [Thread-1 (]: finished collecting timing info
[0m18:02:48.682046 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m18:02:48.696305 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:02:48.696571 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m18:02:48.696739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:50.243999 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.55 seconds
[0m18:02:50.247535 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m18:02:50.248393 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:02:50.248556 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m18:02:51.463523 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.21 seconds
[0m18:02:51.480260 [debug] [Thread-1 (]: finished collecting timing info
[0m18:02:51.480587 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m18:02:51.481376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e20110ad-abd9-4d60-ac2b-4c7e61423506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde8525db0>]}
[0m18:02:51.481768 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.81s]
[0m18:02:51.482183 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m18:02:51.483400 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:02:51.483978 [info ] [MainThread]: 
[0m18:02:51.484281 [info ] [MainThread]: Finished running 1 materializedview model, 1 source model in 0 hours 0 minutes and 7.32 seconds (7.32s).
[0m18:02:51.484531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:51.484657 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m18:02:51.494049 [info ] [MainThread]: 
[0m18:02:51.494349 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:02:51.494610 [info ] [MainThread]: 
[0m18:02:51.494848 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m18:02:51.495079 [error] [MainThread]:   Expected right parenthesis, found semicolon
[0m18:02:51.495300 [error] [MainThread]:   LINE 12: ...b as data from "materialize"."public"."src_driver_location";
[0m18:02:51.495516 [error] [MainThread]:                                                                          ^
[0m18:02:51.495733 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m18:02:51.495951 [info ] [MainThread]: 
[0m18:02:51.496154 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:02:51.496439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddfa799c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde85e1720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde85e2110>]}
[0m18:02:51.496660 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:03:05.779663 | 7f03f511-95f7-411f-b8c0-36f9235dd11e ==============================
[0m18:03:05.779730 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:03:05.786586 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:03:05.786873 [debug] [MainThread]: Tracking: tracking
[0m18:03:05.812043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc402c2a9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc402c2af80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc402c28d90>]}
[0m18:03:05.856493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:03:05.856826 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m18:03:05.866272 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m18:03:05.887988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f03f511-95f7-411f-b8c0-36f9235dd11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f05c40d0>]}
[0m18:03:05.892845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f03f511-95f7-411f-b8c0-36f9235dd11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f052fe50>]}
[0m18:03:05.893066 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:03:05.893238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f03f511-95f7-411f-b8c0-36f9235dd11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc402c203d0>]}
[0m18:03:05.894164 [info ] [MainThread]: 
[0m18:03:05.894569 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:03:05.895256 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m18:03:05.902527 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m18:03:05.902683 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m18:03:05.902784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:07.331740 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.43 seconds
[0m18:03:07.337673 [debug] [ThreadPool]: On list_materialize: Close
[0m18:03:07.340296 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m18:03:07.348198 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m18:03:07.348426 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m18:03:07.348588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:08.716768 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.37 seconds
[0m18:03:08.722540 [debug] [ThreadPool]: On list_materialize_public: Close
[0m18:03:08.724079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f03f511-95f7-411f-b8c0-36f9235dd11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f052fa30>]}
[0m18:03:08.724753 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:03:08.724990 [info ] [MainThread]: 
[0m18:03:08.730988 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m18:03:08.731675 [info ] [Thread-1 (]: 1 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m18:03:08.732405 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m18:03:08.732593 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m18:03:08.732797 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m18:03:08.736788 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m18:03:08.737352 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:08.737541 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m18:03:08.754115 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m18:03:08.754755 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m18:03:08.754908 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    

with

src_driver_location as (
    select key, CONVERT_FROM(data, 'utf8')::jsonb as data from "materialize"."public"."src_driver_location"
)

,final as (

  SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM src_driver_location
)

select * from final;
  );
[0m18:03:08.755041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:10.088627 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected right parenthesis, found semicolon
LINE 27: select * from final;
                            ^

[0m18:03:10.091754 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:10.092241 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m18:03:10.094122 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Expected right parenthesis, found semicolon
  LINE 27: select * from final;
                              ^
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m18:03:10.094833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f03f511-95f7-411f-b8c0-36f9235dd11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f04fc790>]}
[0m18:03:10.095377 [error] [Thread-1 (]: 1 of 2 ERROR creating sql materializedview model public.json_driver_location ... [[31mERROR[0m in 1.36s]
[0m18:03:10.096370 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m18:03:10.096620 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m18:03:10.097077 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m18:03:10.097796 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m18:03:10.097979 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m18:03:10.098153 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m18:03:10.102418 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m18:03:10.103136 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:10.103312 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m18:03:10.120255 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:03:10.120510 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m18:03:10.120641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:11.556670 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.44 seconds
[0m18:03:11.563148 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m18:03:11.564148 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:03:11.564323 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m18:03:12.819554 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.25 seconds
[0m18:03:12.836945 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:12.837323 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m18:03:12.838216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f03f511-95f7-411f-b8c0-36f9235dd11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f067bc40>]}
[0m18:03:12.838669 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.74s]
[0m18:03:12.839138 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m18:03:12.840791 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:03:12.841388 [info ] [MainThread]: 
[0m18:03:12.841674 [info ] [MainThread]: Finished running 1 materializedview model, 1 source model in 0 hours 0 minutes and 6.95 seconds (6.95s).
[0m18:03:12.841935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:12.842061 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m18:03:12.851583 [info ] [MainThread]: 
[0m18:03:12.851889 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:03:12.852131 [info ] [MainThread]: 
[0m18:03:12.852346 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m18:03:12.852550 [error] [MainThread]:   Expected right parenthesis, found semicolon
[0m18:03:12.852747 [error] [MainThread]:   LINE 27: select * from final;
[0m18:03:12.852939 [error] [MainThread]:                               ^
[0m18:03:12.853131 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m18:03:12.853335 [info ] [MainThread]: 
[0m18:03:12.853543 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:03:12.853847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f0680af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f06805b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f0680fa0>]}
[0m18:03:12.854074 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:03:24.637909 | 152cefc5-b92e-4535-92fc-c0193ae0a55b ==============================
[0m18:03:24.638070 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:03:24.638593 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:03:24.638708 [debug] [MainThread]: Tracking: tracking
[0m18:03:24.662016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1cd9a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1cda230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1cd9b70>]}
[0m18:03:24.706315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:03:24.706643 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m18:03:24.716109 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m18:03:24.738211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '152cefc5-b92e-4535-92fc-c0193ae0a55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1dd40d0>]}
[0m18:03:24.744353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '152cefc5-b92e-4535-92fc-c0193ae0a55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe990ad7d60>]}
[0m18:03:24.744605 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:03:24.744780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '152cefc5-b92e-4535-92fc-c0193ae0a55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe990ac5c90>]}
[0m18:03:24.745873 [info ] [MainThread]: 
[0m18:03:24.746301 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:03:24.747051 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m18:03:24.754387 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m18:03:24.754519 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m18:03:24.754607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:26.141747 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.39 seconds
[0m18:03:26.147820 [debug] [ThreadPool]: On list_materialize: Close
[0m18:03:26.150611 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m18:03:26.158471 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m18:03:26.158658 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m18:03:26.158777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:27.531307 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.37 seconds
[0m18:03:27.538458 [debug] [ThreadPool]: On list_materialize_public: Close
[0m18:03:27.540243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '152cefc5-b92e-4535-92fc-c0193ae0a55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe990ad7fd0>]}
[0m18:03:27.541027 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:03:27.541277 [info ] [MainThread]: 
[0m18:03:27.546837 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m18:03:27.547514 [info ] [Thread-1 (]: 1 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m18:03:27.548265 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m18:03:27.548467 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m18:03:27.548674 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m18:03:27.553138 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m18:03:27.553744 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:27.553936 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m18:03:27.570066 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m18:03:27.570564 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m18:03:27.570709 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    

with

src_driver_location as (
    select key, CONVERT_FROM(data, 'utf8')::jsonb as data from "materialize"."public"."src_driver_location"
)

,final as (

  SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM src_driver_location
)

select * from final
  );
[0m18:03:27.570835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:29.084733 [debug] [Thread-1 (]: SQL status: CREATE MATERIALIZED VIEW in 1.51 seconds
[0m18:03:29.097530 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:29.097718 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m18:03:29.098270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '152cefc5-b92e-4535-92fc-c0193ae0a55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe990aa4790>]}
[0m18:03:29.098654 [info ] [Thread-1 (]: 1 of 2 OK created sql materializedview model public.json_driver_location ....... [[32mCREATE MATERIALIZED VIEW[0m in 1.55s]
[0m18:03:29.099382 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m18:03:29.099588 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m18:03:29.099905 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m18:03:29.100573 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m18:03:29.100741 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m18:03:29.100890 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m18:03:29.104266 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m18:03:29.104822 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:29.104994 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m18:03:29.119986 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:03:29.120232 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m18:03:29.120352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:30.484920 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.36 seconds
[0m18:03:30.491864 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m18:03:30.492783 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:03:30.492951 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m18:03:31.704420 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.21 seconds
[0m18:03:31.709013 [debug] [Thread-1 (]: finished collecting timing info
[0m18:03:31.709312 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m18:03:31.710223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '152cefc5-b92e-4535-92fc-c0193ae0a55b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1dd5990>]}
[0m18:03:31.710661 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.61s]
[0m18:03:31.711101 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m18:03:31.712432 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:03:31.713034 [info ] [MainThread]: 
[0m18:03:31.713319 [info ] [MainThread]: Finished running 1 materializedview model, 1 source model in 0 hours 0 minutes and 6.97 seconds (6.97s).
[0m18:03:31.713583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:31.713720 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m18:03:31.722980 [info ] [MainThread]: 
[0m18:03:31.723359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:03:31.723651 [info ] [MainThread]: 
[0m18:03:31.723894 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:03:31.724264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1e99e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1e9a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b1e9a440>]}
[0m18:03:31.724527 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:04:06.464574 | 32863423-f02a-4bdd-9b95-42385e5c2422 ==============================
[0m18:04:06.464641 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:04:06.465109 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m18:04:06.465224 [debug] [MainThread]: Tracking: tracking
[0m18:04:06.485985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0a9d1d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0a9d2530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0a9d1ea0>]}
[0m18:04:06.529607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:04:06.529796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:04:06.534658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32863423-f02a-4bdd-9b95-42385e5c2422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd8258280>]}
[0m18:04:06.539419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32863423-f02a-4bdd-9b95-42385e5c2422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd822d240>]}
[0m18:04:06.539616 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:04:06.539788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32863423-f02a-4bdd-9b95-42385e5c2422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd822d270>]}
[0m18:04:06.540684 [info ] [MainThread]: 
[0m18:04:06.541078 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:04:06.541788 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m18:04:06.549347 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m18:04:06.549490 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m18:04:06.549580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:08.362297 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.81 seconds
[0m18:04:08.370684 [debug] [ThreadPool]: On list_materialize_public: Close
[0m18:04:08.372620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32863423-f02a-4bdd-9b95-42385e5c2422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd820fd90>]}
[0m18:04:08.373458 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:04:08.373788 [info ] [MainThread]: 
[0m18:04:08.380689 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m18:04:08.381338 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m18:04:08.381540 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m18:04:08.381764 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m18:04:08.386526 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m18:04:08.387121 [debug] [Thread-1 (]: finished collecting timing info
[0m18:04:08.387295 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m18:04:08.387469 [debug] [Thread-1 (]: finished collecting timing info
[0m18:04:08.388123 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m18:04:08.388315 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m18:04:08.388927 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m18:04:08.389111 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m18:04:08.389267 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m18:04:08.392325 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m18:04:08.392759 [debug] [Thread-1 (]: finished collecting timing info
[0m18:04:08.392921 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m18:04:08.393165 [debug] [Thread-1 (]: finished collecting timing info
[0m18:04:08.393810 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m18:04:08.394614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:08.394780 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m18:04:08.401636 [info ] [MainThread]: Done.
[0m18:04:08.403867 [debug] [MainThread]: Acquiring new materialize connection "generate_catalog"
[0m18:04:08.404012 [info ] [MainThread]: Building catalog
[0m18:04:08.405143 [debug] [ThreadPool]: Acquiring new materialize connection "materialize.information_schema"
[0m18:04:08.411539 [debug] [ThreadPool]: Using materialize connection "materialize.information_schema"
[0m18:04:08.411717 [debug] [ThreadPool]: On materialize.information_schema: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "materialize.information_schema"} */
select
            d.name as table_database,
            s.name as table_schema,
            o.name as table_name,
            case when o.type = 'materialized-view' then 'materializedview' else o.type end as table_type,
            '' as table_comment,
            c.name as column_name,
            c.position as column_index,
            c.type as column_type,
            '' as column_comment,
            '' as table_owner
        from mz_objects o
        join mz_schemas s on o.schema_id = s.id
        join mz_databases d on s.database_id = d.id and d.name = 'materialize'
        join mz_columns c on c.id = o.id
        where s.name in ('public')
[0m18:04:08.411828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:09.806399 [debug] [ThreadPool]: SQL status: SELECT 4 in 1.39 seconds
[0m18:04:09.818371 [debug] [ThreadPool]: On materialize.information_schema: Close
[0m18:04:09.829421 [info ] [MainThread]: Catalog written to /Users/claytonvanhovel/Desktop/onward-materialize-dbt/target/catalog.json
[0m18:04:09.829897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0a9d1d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf83cbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf83cbd60>]}
[0m18:04:09.830198 [debug] [MainThread]: Flushing usage events
[0m18:04:10.150568 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:04:10.151006 [debug] [MainThread]: Connection 'materialize.information_schema' was properly closed.


============================== 2022-12-01 18:04:15.072798 | 1e779dd9-47fc-44ec-ac97-75a8fd872ebf ==============================
[0m18:04:15.072883 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:04:15.073384 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m18:04:15.073499 [debug] [MainThread]: Tracking: tracking
[0m18:04:15.092085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b1c85690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b1c862f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b1c87850>]}
[0m18:04:15.093968 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m18:04:15.094290 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m18:04:15.094445 [info ] [MainThread]: 
[0m18:04:15.094582 [info ] [MainThread]: 
[0m18:04:15.094720 [info ] [MainThread]: Press Ctrl+C to exit.
[0m18:04:15.095404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b1c85e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b1c86da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b1c85cc0>]}
[0m18:04:15.095591 [debug] [MainThread]: Flushing usage events
[0m18:04:15.392423 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m18:04:15.397937 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/task/serve.py", line 30, in run
    httpd = TCPServer(  # type: ignore
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use



============================== 2022-12-01 18:04:24.636653 | 778b165b-069f-4143-b21f-b1fc74ded8f2 ==============================
[0m18:04:24.636740 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:04:24.637260 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m18:04:24.637380 [debug] [MainThread]: Tracking: tracking
[0m18:04:24.663938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a1ee5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a1ee5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a1ee7820>]}
[0m18:04:24.666508 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m18:04:24.666795 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m18:04:24.666952 [info ] [MainThread]: 
[0m18:04:24.667090 [info ] [MainThread]: 
[0m18:04:24.667224 [info ] [MainThread]: Press Ctrl+C to exit.
[0m18:04:24.667737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a1ee5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a1ee57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a1ee5cf0>]}
[0m18:04:24.667935 [debug] [MainThread]: Flushing usage events
[0m18:04:24.965350 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m18:04:24.968691 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/task/serve.py", line 30, in run
    httpd = TCPServer(  # type: ignore
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use



============================== 2022-12-01 18:05:33.490370 | c2af2d24-3b89-41b6-9a51-c58283eb5a28 ==============================
[0m18:05:33.490428 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:05:33.492359 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m18:05:33.492476 [debug] [MainThread]: Tracking: tracking
[0m18:05:33.517437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952a4f6da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952a4f5f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952a4f6950>]}
[0m18:05:33.520154 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m18:05:33.520410 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m18:05:33.520568 [info ] [MainThread]: 
[0m18:05:33.520702 [info ] [MainThread]: 
[0m18:05:33.520834 [info ] [MainThread]: Press Ctrl+C to exit.
[0m18:05:33.521380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952a4f5f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952a4f4c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f952a4f6aa0>]}
[0m18:05:33.521560 [debug] [MainThread]: Flushing usage events
[0m18:05:33.844852 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m18:05:33.849863 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/site-packages/dbt/task/serve.py", line 30, in run
    httpd = TCPServer(  # type: ignore
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/Users/claytonvanhovel/.conda/envs/materialize-dbt/lib/python3.10/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use



============================== 2022-12-01 18:06:33.962118 | 15a7dda5-57ab-46a5-825e-cc3bedf4a2e5 ==============================
[0m18:06:33.962322 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:06:33.963146 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m18:06:33.963287 [debug] [MainThread]: Tracking: tracking
[0m18:06:33.992052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4dab9d780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4dab9ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4dab9fcd0>]}
[0m18:06:33.994658 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m18:06:33.994923 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m18:06:33.995084 [info ] [MainThread]: 
[0m18:06:33.995222 [info ] [MainThread]: 
[0m18:06:33.995356 [info ] [MainThread]: Press Ctrl+C to exit.
[0m18:12:36.079105 [debug] [MainThread]: Flushing usage events
[0m18:12:36.433375 [info ] [MainThread]: ctrl-c


============================== 2022-12-01 18:12:46.444854 | 33b9165b-0168-4e86-95b2-10baf911ea42 ==============================
[0m18:12:46.444922 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:12:46.445691 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m18:12:46.445843 [debug] [MainThread]: Tracking: tracking
[0m18:12:46.475522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91ab028f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91ab030d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91ab02a10>]}
[0m18:12:46.522432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:46.522609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:46.527476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33b9165b-0168-4e86-95b2-10baf911ea42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9085702b0>]}
[0m18:12:46.534851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33b9165b-0168-4e86-95b2-10baf911ea42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd908541270>]}
[0m18:12:46.535087 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:12:46.535263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33b9165b-0168-4e86-95b2-10baf911ea42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9085412a0>]}
[0m18:12:46.536427 [info ] [MainThread]: 
[0m18:12:46.537088 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:12:46.537882 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m18:12:46.546130 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m18:12:46.546340 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m18:12:46.546439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:48.378764 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.83 seconds
[0m18:12:48.384308 [debug] [ThreadPool]: On list_materialize_public: Close
[0m18:12:48.385844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33b9165b-0168-4e86-95b2-10baf911ea42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9084f0040>]}
[0m18:12:48.386638 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:12:48.387017 [info ] [MainThread]: 
[0m18:12:48.393698 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m18:12:48.394462 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m18:12:48.394792 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m18:12:48.395024 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m18:12:48.399667 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m18:12:48.400851 [debug] [Thread-1 (]: finished collecting timing info
[0m18:12:48.401033 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m18:12:48.401184 [debug] [Thread-1 (]: finished collecting timing info
[0m18:12:48.401744 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m18:12:48.401891 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m18:12:48.402412 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m18:12:48.402560 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m18:12:48.402696 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m18:12:48.405702 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m18:12:48.406419 [debug] [Thread-1 (]: finished collecting timing info
[0m18:12:48.406575 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m18:12:48.406722 [debug] [Thread-1 (]: finished collecting timing info
[0m18:12:48.407286 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m18:12:48.408066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:48.408248 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m18:12:48.415601 [info ] [MainThread]: Done.
[0m18:12:48.417680 [debug] [MainThread]: Acquiring new materialize connection "generate_catalog"
[0m18:12:48.417848 [info ] [MainThread]: Building catalog
[0m18:12:48.419240 [debug] [ThreadPool]: Acquiring new materialize connection "materialize.information_schema"
[0m18:12:48.425604 [debug] [ThreadPool]: Using materialize connection "materialize.information_schema"
[0m18:12:48.425789 [debug] [ThreadPool]: On materialize.information_schema: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "materialize.information_schema"} */
select
            d.name as table_database,
            s.name as table_schema,
            o.name as table_name,
            case when o.type = 'materialized-view' then 'materializedview' else o.type end as table_type,
            '' as table_comment,
            c.name as column_name,
            c.position as column_index,
            c.type as column_type,
            '' as column_comment,
            '' as table_owner
        from mz_objects o
        join mz_schemas s on o.schema_id = s.id
        join mz_databases d on s.database_id = d.id and d.name = 'materialize'
        join mz_columns c on c.id = o.id
        where s.name in ('public')
[0m18:12:48.425907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:50.293740 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.87 seconds
[0m18:12:50.304812 [debug] [ThreadPool]: On materialize.information_schema: Close
[0m18:12:50.315989 [info ] [MainThread]: Catalog written to /Users/claytonvanhovel/Desktop/onward-materialize-dbt/target/catalog.json
[0m18:12:50.316521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91ab028f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d80a7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d80a7970>]}
[0m18:12:50.316852 [debug] [MainThread]: Flushing usage events
[0m18:12:50.614737 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:12:50.615253 [debug] [MainThread]: Connection 'materialize.information_schema' was properly closed.


============================== 2022-12-01 18:12:57.538838 | 279b71ae-dcb6-4045-971f-1e6a30bff345 ==============================
[0m18:12:57.539049 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:12:57.539776 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:12:57.539904 [debug] [MainThread]: Tracking: tracking
[0m18:12:57.565146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5919ad6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5919ade10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5919af700>]}
[0m18:12:57.610303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:57.610495 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:57.615563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '279b71ae-dcb6-4045-971f-1e6a30bff345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb560c241f0>]}
[0m18:12:57.620405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '279b71ae-dcb6-4045-971f-1e6a30bff345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb560bf51b0>]}
[0m18:12:57.620602 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:12:57.620776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '279b71ae-dcb6-4045-971f-1e6a30bff345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb560bf51e0>]}
[0m18:12:57.621764 [info ] [MainThread]: 
[0m18:12:57.622178 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:12:57.622920 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m18:12:57.630966 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m18:12:57.631166 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m18:12:57.631279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:59.212325 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.58 seconds
[0m18:12:59.218359 [debug] [ThreadPool]: On list_materialize: Close
[0m18:12:59.221018 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m18:12:59.228950 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m18:12:59.229175 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m18:12:59.229332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:00.654217 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.42 seconds
[0m18:13:00.659524 [debug] [ThreadPool]: On list_materialize_public: Close
[0m18:13:00.661355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '279b71ae-dcb6-4045-971f-1e6a30bff345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5919afcd0>]}
[0m18:13:00.662241 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:13:00.662570 [info ] [MainThread]: 
[0m18:13:00.669332 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m18:13:00.669753 [info ] [Thread-1 (]: 1 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m18:13:00.670491 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m18:13:00.670683 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m18:13:00.670900 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m18:13:00.675136 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m18:13:00.676049 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:00.676263 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m18:13:00.692026 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m18:13:00.692862 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m18:13:00.692992 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    

with

src_driver_location as (
    select key, CONVERT_FROM(data, 'utf8')::jsonb as data from "materialize"."public"."src_driver_location"
)

,final as (

  SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM src_driver_location
)

select * from final
  );
[0m18:13:00.693103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:02.204030 [debug] [Thread-1 (]: SQL status: CREATE MATERIALIZED VIEW in 1.51 seconds
[0m18:13:02.219135 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:02.219428 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m18:13:02.220160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '279b71ae-dcb6-4045-971f-1e6a30bff345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb591a9bb80>]}
[0m18:13:02.220508 [info ] [Thread-1 (]: 1 of 2 OK created sql materializedview model public.json_driver_location ....... [[32mCREATE MATERIALIZED VIEW[0m in 1.55s]
[0m18:13:02.221240 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m18:13:02.221445 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m18:13:02.221661 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m18:13:02.222449 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m18:13:02.222639 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m18:13:02.222801 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m18:13:02.226598 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m18:13:02.228628 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:02.228857 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m18:13:02.245498 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:13:02.245731 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m18:13:02.245858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:03.662841 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.42 seconds
[0m18:13:03.671296 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m18:13:03.673506 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:13:03.673705 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m18:13:05.086114 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.41 seconds
[0m18:13:05.092525 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:05.092941 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m18:13:05.094267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '279b71ae-dcb6-4045-971f-1e6a30bff345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb591b25b10>]}
[0m18:13:05.094784 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.87s]
[0m18:13:05.095279 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m18:13:05.096931 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:13:05.097529 [info ] [MainThread]: 
[0m18:13:05.097794 [info ] [MainThread]: Finished running 1 materializedview model, 1 source model in 0 hours 0 minutes and 7.48 seconds (7.48s).
[0m18:13:05.098050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:05.098185 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m18:13:05.107185 [info ] [MainThread]: 
[0m18:13:05.107536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:05.107822 [info ] [MainThread]: 
[0m18:13:05.108061 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:13:05.108400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb560bf51e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb560bf4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb591b04160>]}
[0m18:13:05.108653 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 18:13:20.743071 | a50fb55f-8e84-4626-a41e-6f7bec35005b ==============================
[0m18:13:20.743258 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:13:20.743983 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m18:13:20.744101 [debug] [MainThread]: Tracking: tracking
[0m18:13:20.767503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba224e1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba224e2200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba224e1b70>]}
[0m18:13:20.812290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:20.812460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:20.817573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a50fb55f-8e84-4626-a41e-6f7bec35005b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba22690280>]}
[0m18:13:20.823263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a50fb55f-8e84-4626-a41e-6f7bec35005b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba22665240>]}
[0m18:13:20.823473 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:13:20.823651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a50fb55f-8e84-4626-a41e-6f7bec35005b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba22665270>]}
[0m18:13:20.825201 [info ] [MainThread]: 
[0m18:13:20.825640 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:13:20.826408 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m18:13:20.835814 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m18:13:20.836028 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m18:13:20.836126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:22.348300 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.51 seconds
[0m18:13:22.354651 [debug] [ThreadPool]: On list_materialize_public: Close
[0m18:13:22.356793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a50fb55f-8e84-4626-a41e-6f7bec35005b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba224db490>]}
[0m18:13:22.357677 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:13:22.358019 [info ] [MainThread]: 
[0m18:13:22.365337 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m18:13:22.365989 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m18:13:22.366188 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m18:13:22.366390 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m18:13:22.371151 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m18:13:22.371962 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:22.372152 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m18:13:22.372325 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:22.372948 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m18:13:22.373146 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m18:13:22.373710 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m18:13:22.373858 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m18:13:22.374001 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m18:13:22.377053 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m18:13:22.377498 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:22.377652 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m18:13:22.377785 [debug] [Thread-1 (]: finished collecting timing info
[0m18:13:22.378284 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m18:13:22.379342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:22.379543 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m18:13:22.386439 [info ] [MainThread]: Done.
[0m18:13:22.388537 [debug] [MainThread]: Acquiring new materialize connection "generate_catalog"
[0m18:13:22.388695 [info ] [MainThread]: Building catalog
[0m18:13:22.390016 [debug] [ThreadPool]: Acquiring new materialize connection "materialize.information_schema"
[0m18:13:22.396376 [debug] [ThreadPool]: Using materialize connection "materialize.information_schema"
[0m18:13:22.396532 [debug] [ThreadPool]: On materialize.information_schema: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "materialize.information_schema"} */
select
            d.name as table_database,
            s.name as table_schema,
            o.name as table_name,
            case when o.type = 'materialized-view' then 'materializedview' else o.type end as table_type,
            '' as table_comment,
            c.name as column_name,
            c.position as column_index,
            c.type as column_type,
            '' as column_comment,
            '' as table_owner
        from mz_objects o
        join mz_schemas s on o.schema_id = s.id
        join mz_databases d on s.database_id = d.id and d.name = 'materialize'
        join mz_columns c on c.id = o.id
        where s.name in ('public')
[0m18:13:22.396640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:23.710155 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.31 seconds
[0m18:13:23.719137 [debug] [ThreadPool]: On materialize.information_schema: Close
[0m18:13:23.728672 [info ] [MainThread]: Catalog written to /Users/claytonvanhovel/Desktop/onward-materialize-dbt/target/catalog.json
[0m18:13:23.729105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba224e1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba00173e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba00173a90>]}
[0m18:13:23.729374 [debug] [MainThread]: Flushing usage events
[0m18:13:24.037752 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:13:24.038378 [debug] [MainThread]: Connection 'materialize.information_schema' was properly closed.


============================== 2022-12-01 18:13:29.799731 | d9c37d61-e418-4e0a-babc-64d2f2607b30 ==============================
[0m18:13:29.799996 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:13:29.800533 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m18:13:29.800659 [debug] [MainThread]: Tracking: tracking
[0m18:13:29.819107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d1cc2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d1cc3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d1cc09a0>]}
[0m18:13:29.821472 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m18:13:29.821737 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m18:13:29.821891 [info ] [MainThread]: 
[0m18:13:29.822028 [info ] [MainThread]: 
[0m18:13:29.822161 [info ] [MainThread]: Press Ctrl+C to exit.
[0m18:14:10.888858 [debug] [MainThread]: Flushing usage events
[0m18:14:11.225685 [info ] [MainThread]: ctrl-c


============================== 2022-12-02 00:10:18.679479 | 1c954ab1-e97e-4e79-8c25-92b1bdd0f0ee ==============================
[0m00:10:18.679554 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:10:18.681042 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:10:18.681218 [debug] [MainThread]: Tracking: tracking
[0m00:10:18.717055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6d0281a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6d0282230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6d0281b70>]}
[0m00:10:18.768016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:10:18.768223 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:10:18.773660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c954ab1-e97e-4e79-8c25-92b1bdd0f0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712540280>]}
[0m00:10:18.779221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c954ab1-e97e-4e79-8c25-92b1bdd0f0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712515240>]}
[0m00:10:18.779455 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:10:18.779635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c954ab1-e97e-4e79-8c25-92b1bdd0f0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712515270>]}
[0m00:10:18.780699 [info ] [MainThread]: 
[0m00:10:18.781133 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:10:18.781886 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m00:10:18.789895 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m00:10:18.790072 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m00:10:18.790164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:20.346406 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.56 seconds
[0m00:10:20.355598 [debug] [ThreadPool]: On list_materialize: Close
[0m00:10:20.361226 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m00:10:20.375378 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m00:10:20.375772 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m00:10:20.375929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:21.732009 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.36 seconds
[0m00:10:21.734989 [debug] [ThreadPool]: On list_materialize_public: Close
[0m00:10:21.737310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c954ab1-e97e-4e79-8c25-92b1bdd0f0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6d0283be0>]}
[0m00:10:21.740889 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:10:21.742218 [info ] [MainThread]: 
[0m00:10:21.757312 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m00:10:21.759019 [info ] [Thread-1 (]: 1 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m00:10:21.761393 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m00:10:21.762826 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m00:10:21.763422 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m00:10:21.767835 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m00:10:21.768754 [debug] [Thread-1 (]: finished collecting timing info
[0m00:10:21.768960 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m00:10:21.786093 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m00:10:21.787324 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m00:10:21.787493 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    

with

src_driver_location as (
    select key, CONVERT_FROM(data, 'utf8')::jsonb as data from "materialize"."public"."src_driver_location"
)

,final as (

  SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM src_driver_location
)

select * from final
  );
[0m00:10:21.787639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:23.548343 [debug] [Thread-1 (]: SQL status: CREATE MATERIALIZED VIEW in 1.76 seconds
[0m00:10:23.579303 [debug] [Thread-1 (]: finished collecting timing info
[0m00:10:23.579786 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m00:10:23.581002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c954ab1-e97e-4e79-8c25-92b1bdd0f0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71257fc10>]}
[0m00:10:23.581522 [info ] [Thread-1 (]: 1 of 2 OK created sql materializedview model public.json_driver_location ....... [[32mCREATE MATERIALIZED VIEW[0m in 1.82s]
[0m00:10:23.583946 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m00:10:23.584177 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m00:10:23.584587 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m00:10:23.585306 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m00:10:23.585490 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m00:10:23.585650 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m00:10:23.589326 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m00:10:23.590363 [debug] [Thread-1 (]: finished collecting timing info
[0m00:10:23.590550 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m00:10:23.607515 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:10:23.607804 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m00:10:23.607943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:26.654265 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 3.05 seconds
[0m00:10:26.662885 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m00:10:26.663897 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:10:26.664066 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m00:10:27.839768 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.18 seconds
[0m00:10:27.843066 [debug] [Thread-1 (]: finished collecting timing info
[0m00:10:27.843398 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m00:10:27.844322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c954ab1-e97e-4e79-8c25-92b1bdd0f0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712605ba0>]}
[0m00:10:27.844762 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 4.26s]
[0m00:10:27.845196 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m00:10:27.846479 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:10:27.847038 [info ] [MainThread]: 
[0m00:10:27.847301 [info ] [MainThread]: Finished running 1 materializedview model, 1 source model in 0 hours 0 minutes and 9.07 seconds (9.07s).
[0m00:10:27.847546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:27.847674 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m00:10:27.855466 [info ] [MainThread]: 
[0m00:10:27.855723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:10:27.855930 [info ] [MainThread]: 
[0m00:10:27.856110 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:10:27.856352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712515270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712514f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7125e4160>]}
[0m00:10:27.856535 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 00:13:26.993051 | 9d097134-ef96-4b5b-a0b3-b2e9b65afc7b ==============================
[0m00:13:26.993120 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:13:26.993848 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:13:26.993974 [debug] [MainThread]: Tracking: tracking
[0m00:13:27.016904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eabb1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eabb2230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eabb1b70>]}
[0m00:13:27.061433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:13:27.061750 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m00:13:27.071565 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m00:13:27.093246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d097134-ef96-4b5b-a0b3-b2e9b65afc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d83e40d0>]}
[0m00:13:27.097895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d097134-ef96-4b5b-a0b3-b2e9b65afc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ead17e50>]}
[0m00:13:27.098090 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:13:27.098257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d097134-ef96-4b5b-a0b3-b2e9b65afc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ead05c90>]}
[0m00:13:27.099118 [info ] [MainThread]: 
[0m00:13:27.099512 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:13:27.100177 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m00:13:27.107326 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m00:13:27.107518 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m00:13:27.107625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:31.524551 [debug] [ThreadPool]: SQL status: SELECT 5 in 4.42 seconds
[0m00:13:31.529179 [debug] [ThreadPool]: On list_materialize: Close
[0m00:13:31.531806 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m00:13:31.539202 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m00:13:31.539433 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m00:13:31.539582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:33.300094 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.76 seconds
[0m00:13:33.305861 [debug] [ThreadPool]: On list_materialize_public: Close
[0m00:13:33.307290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d097134-ef96-4b5b-a0b3-b2e9b65afc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ead17fd0>]}
[0m00:13:33.308104 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:13:33.308429 [info ] [MainThread]: 
[0m00:13:33.314296 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m00:13:33.314898 [info ] [Thread-1 (]: 1 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m00:13:33.315624 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m00:13:33.315801 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m00:13:33.315995 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m00:13:33.318117 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m00:13:33.319068 [debug] [Thread-1 (]: finished collecting timing info
[0m00:13:33.319280 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m00:13:33.334977 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m00:13:33.335510 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m00:13:33.335651 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM driver_location)
  );
[0m00:13:33.335776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:34.754847 [debug] [Thread-1 (]: Postgres adapter: Postgres error: unknown catalog item 'driver_location'

[0m00:13:34.757694 [debug] [Thread-1 (]: finished collecting timing info
[0m00:13:34.758122 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m00:13:34.760420 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  unknown catalog item 'driver_location'
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m00:13:34.761164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d097134-ef96-4b5b-a0b3-b2e9b65afc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eace4790>]}
[0m00:13:34.761884 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 1.45s]
[0m00:13:34.762939 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m00:13:34.763178 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m00:13:34.763625 [info ] [Thread-1 (]: 2 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m00:13:34.764427 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m00:13:34.764606 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m00:13:34.764783 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m00:13:34.768527 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m00:13:34.769204 [debug] [Thread-1 (]: finished collecting timing info
[0m00:13:34.769380 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m00:13:34.785075 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:13:34.785325 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m00:13:34.785453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:36.302015 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.52 seconds
[0m00:13:36.307787 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m00:13:36.308436 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:13:36.308574 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m00:13:37.362723 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.05 seconds
[0m00:13:37.380088 [debug] [Thread-1 (]: finished collecting timing info
[0m00:13:37.380534 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m00:13:37.381632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d097134-ef96-4b5b-a0b3-b2e9b65afc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d848fee0>]}
[0m00:13:37.382105 [info ] [Thread-1 (]: 2 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.62s]
[0m00:13:37.382622 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m00:13:37.384139 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:13:37.384719 [info ] [MainThread]: 
[0m00:13:37.385003 [info ] [MainThread]: Finished running 1 view model, 1 source model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m00:13:37.385256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:37.385444 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m00:13:37.394601 [info ] [MainThread]: 
[0m00:13:37.394911 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:13:37.395166 [info ] [MainThread]: 
[0m00:13:37.395394 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m00:13:37.395615 [error] [MainThread]:   unknown catalog item 'driver_location'
[0m00:13:37.395807 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m00:13:37.395971 [info ] [MainThread]: 
[0m00:13:37.396369 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:13:37.396869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ead05c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d8495750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d8496590>]}
[0m00:13:37.397150 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 00:14:06.068000 | 54214db4-7f46-4268-af4b-8b0d0e50b340 ==============================
[0m00:14:06.068058 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:14:06.068572 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:14:06.068694 [debug] [MainThread]: Tracking: tracking
[0m00:14:06.090423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3489f9d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3489f9600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3489fb100>]}
[0m00:14:06.130245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:14:06.130582 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m00:14:06.139900 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m00:14:06.161140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54214db4-7f46-4268-af4b-8b0d0e50b340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378c680d0>]}
[0m00:14:06.165974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54214db4-7f46-4268-af4b-8b0d0e50b340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378b9c910>]}
[0m00:14:06.166179 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:14:06.166355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54214db4-7f46-4268-af4b-8b0d0e50b340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378bb9c00>]}
[0m00:14:06.167228 [info ] [MainThread]: 
[0m00:14:06.167648 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:14:06.168313 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m00:14:06.175658 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m00:14:06.175833 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m00:14:06.175928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:07.633353 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.46 seconds
[0m00:14:07.638965 [debug] [ThreadPool]: On list_materialize: Close
[0m00:14:07.641646 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m00:14:07.649196 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m00:14:07.649424 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m00:14:07.649609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:09.362240 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.71 seconds
[0m00:14:09.370297 [debug] [ThreadPool]: On list_materialize_public: Close
[0m00:14:09.372111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54214db4-7f46-4268-af4b-8b0d0e50b340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378bcfd60>]}
[0m00:14:09.372972 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:14:09.373305 [info ] [MainThread]: 
[0m00:14:09.377815 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m00:14:09.378419 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m00:14:09.379115 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:09.379299 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m00:14:09.379490 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m00:14:09.383418 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m00:14:09.384326 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:09.384525 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m00:14:09.400767 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:09.401005 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m00:14:09.401127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:10.826019 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.42 seconds
[0m00:14:10.839087 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m00:14:10.840018 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:10.840188 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m00:14:11.879049 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.04 seconds
[0m00:14:11.896013 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:11.896407 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m00:14:11.897550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54214db4-7f46-4268-af4b-8b0d0e50b340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378bcfd60>]}
[0m00:14:11.898057 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.52s]
[0m00:14:11.898875 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m00:14:11.899646 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m00:14:11.899895 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m00:14:11.900498 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m00:14:11.900661 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m00:14:11.900816 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m00:14:11.904214 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m00:14:11.904952 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:11.905121 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m00:14:11.914816 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m00:14:11.915225 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m00:14:11.915336 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location"
  );
[0m00:14:11.915434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:13.308070 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected right parenthesis, found semicolon
LINE 12:   );
            ^

[0m00:14:13.310081 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:13.310495 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m00:14:13.312125 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Expected right parenthesis, found semicolon
  LINE 12:   );
              ^
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m00:14:13.312683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54214db4-7f46-4268-af4b-8b0d0e50b340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378d20e20>]}
[0m00:14:13.313175 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 1.41s]
[0m00:14:13.313711 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m00:14:13.315352 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:14:13.316011 [info ] [MainThread]: 
[0m00:14:13.316310 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 7.15 seconds (7.15s).
[0m00:14:13.316625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:13.316760 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m00:14:13.325457 [info ] [MainThread]: 
[0m00:14:13.325746 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:14:13.326008 [info ] [MainThread]: 
[0m00:14:13.326240 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m00:14:13.326480 [error] [MainThread]:   Expected right parenthesis, found semicolon
[0m00:14:13.326720 [error] [MainThread]:   LINE 12:   );
[0m00:14:13.326967 [error] [MainThread]:               ^
[0m00:14:13.327210 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m00:14:13.327440 [info ] [MainThread]: 
[0m00:14:13.327670 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:14:13.328016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378bb9c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378d03280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb378d00700>]}
[0m00:14:13.328280 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 00:14:31.210445 | 8f579815-62b1-41dc-a6e3-9f61e0fac170 ==============================
[0m00:14:31.210517 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:14:31.211161 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:14:31.211276 [debug] [MainThread]: Tracking: tracking
[0m00:14:31.230724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca691a5660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca691a5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca691a5780>]}
[0m00:14:31.270850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:14:31.271034 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:14:31.275855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f579815-62b1-41dc-a6e3-9f61e0fac170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca693b0280>]}
[0m00:14:31.280851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f579815-62b1-41dc-a6e3-9f61e0fac170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca69381240>]}
[0m00:14:31.281067 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:14:31.281235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f579815-62b1-41dc-a6e3-9f61e0fac170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca69381270>]}
[0m00:14:31.282208 [info ] [MainThread]: 
[0m00:14:31.282622 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:14:31.283393 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m00:14:31.291049 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m00:14:31.291200 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m00:14:31.291295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:32.654058 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.36 seconds
[0m00:14:32.660379 [debug] [ThreadPool]: On list_materialize: Close
[0m00:14:32.662984 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m00:14:32.670851 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m00:14:32.671091 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m00:14:32.671259 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:34.339151 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.67 seconds
[0m00:14:34.340786 [debug] [ThreadPool]: On list_materialize_public: Close
[0m00:14:34.341760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f579815-62b1-41dc-a6e3-9f61e0fac170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca693efc10>]}
[0m00:14:34.342386 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:14:34.342641 [info ] [MainThread]: 
[0m00:14:34.345565 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m00:14:34.346136 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m00:14:34.346783 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:34.346973 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m00:14:34.347126 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m00:14:34.349814 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m00:14:34.350280 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:34.350427 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m00:14:34.363274 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:34.363521 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m00:14:34.363631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:35.911682 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.55 seconds
[0m00:14:35.924994 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m00:14:35.926106 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:35.926282 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m00:14:37.042832 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.12 seconds
[0m00:14:37.055590 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:37.055854 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m00:14:37.056584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f579815-62b1-41dc-a6e3-9f61e0fac170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca693efc10>]}
[0m00:14:37.056935 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.71s]
[0m00:14:37.057604 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m00:14:37.058168 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m00:14:37.058409 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m00:14:37.058974 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m00:14:37.059118 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m00:14:37.059255 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m00:14:37.061958 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m00:14:37.062367 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:37.062498 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m00:14:37.071924 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m00:14:37.072311 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m00:14:37.072427 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location"
  );
[0m00:14:37.072528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:38.408545 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected right parenthesis, found semicolon
LINE 12:   );
            ^

[0m00:14:38.410119 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:38.410441 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m00:14:38.411799 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Expected right parenthesis, found semicolon
  LINE 12:   );
              ^
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m00:14:38.412261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f579815-62b1-41dc-a6e3-9f61e0fac170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca69418520>]}
[0m00:14:38.412687 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 1.35s]
[0m00:14:38.413135 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m00:14:38.414319 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:14:38.414936 [info ] [MainThread]: 
[0m00:14:38.415221 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 7.13 seconds (7.13s).
[0m00:14:38.415491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:38.415620 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m00:14:38.424588 [info ] [MainThread]: 
[0m00:14:38.424951 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:14:38.425231 [info ] [MainThread]: 
[0m00:14:38.425473 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m00:14:38.425717 [error] [MainThread]:   Expected right parenthesis, found semicolon
[0m00:14:38.425954 [error] [MainThread]:   LINE 12:   );
[0m00:14:38.426182 [error] [MainThread]:               ^
[0m00:14:38.426406 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m00:14:38.426642 [info ] [MainThread]: 
[0m00:14:38.426878 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:14:38.427255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca69380e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca69380dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6941a170>]}
[0m00:14:38.427549 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 00:14:51.055795 | b5470d84-a2b2-44ca-91f8-cc91940babfa ==============================
[0m00:14:51.055921 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:14:51.056445 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:14:51.056568 [debug] [MainThread]: Tracking: tracking
[0m00:14:51.075800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf9739e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf9739660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf9739d20>]}
[0m00:14:51.114997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:14:51.115349 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m00:14:51.124860 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m00:14:51.147344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5470d84-a2b2-44ca-91f8-cc91940babfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc81d80d0>]}
[0m00:14:51.152428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5470d84-a2b2-44ca-91f8-cc91940babfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc813bd60>]}
[0m00:14:51.152639 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m00:14:51.152815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5470d84-a2b2-44ca-91f8-cc91940babfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc8129c90>]}
[0m00:14:51.153740 [info ] [MainThread]: 
[0m00:14:51.154146 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:14:51.154908 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m00:14:51.162450 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m00:14:51.162628 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m00:14:51.162721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:52.529277 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.37 seconds
[0m00:14:52.534473 [debug] [ThreadPool]: On list_materialize: Close
[0m00:14:52.537000 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m00:14:52.544706 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m00:14:52.544938 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m00:14:52.545092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:54.353973 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.81 seconds
[0m00:14:54.360675 [debug] [ThreadPool]: On list_materialize_public: Close
[0m00:14:54.362314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5470d84-a2b2-44ca-91f8-cc91940babfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc813bfd0>]}
[0m00:14:54.363074 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:14:54.363330 [info ] [MainThread]: 
[0m00:14:54.367854 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m00:14:54.368516 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m00:14:54.369272 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:54.369472 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m00:14:54.369690 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m00:14:54.373634 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m00:14:54.374484 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:54.374688 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m00:14:54.390573 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:54.390812 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m00:14:54.390946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:55.816188 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.43 seconds
[0m00:14:55.831361 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m00:14:55.832307 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:14:55.832482 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

-- where id is not null
[0m00:14:56.865228 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.03 seconds
[0m00:14:56.881487 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:56.881872 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m00:14:56.883044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5470d84-a2b2-44ca-91f8-cc91940babfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc810c880>]}
[0m00:14:56.883559 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.51s]
[0m00:14:56.884516 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m00:14:56.885407 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m00:14:56.885737 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m00:14:56.886485 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m00:14:56.886683 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m00:14:56.886852 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m00:14:56.890190 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m00:14:56.890902 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:56.891082 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m00:14:56.900871 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m00:14:56.901347 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m00:14:56.901474 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m00:14:56.901586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:58.274447 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 1.37 seconds
[0m00:14:58.280115 [debug] [Thread-1 (]: finished collecting timing info
[0m00:14:58.280529 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m00:14:58.281665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5470d84-a2b2-44ca-91f8-cc91940babfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc828d540>]}
[0m00:14:58.282405 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 1.40s]
[0m00:14:58.282953 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m00:14:58.284437 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:14:58.285048 [info ] [MainThread]: 
[0m00:14:58.285347 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 7.13 seconds (7.13s).
[0m00:14:58.285626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:58.285757 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m00:14:58.295095 [info ] [MainThread]: 
[0m00:14:58.295371 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:14:58.295650 [info ] [MainThread]: 
[0m00:14:58.295892 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:14:58.296240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc8129c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc8275240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc8274ca0>]}
[0m00:14:58.296482 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 15:03:47.471421 | 47f5aa6a-faef-424b-8a04-f7040fd3521d ==============================
[0m15:03:47.471478 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:03:47.472349 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:03:47.472502 [debug] [MainThread]: Tracking: tracking
[0m15:03:47.500694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a8d2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a8d30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a8d1600>]}
[0m15:03:47.547346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:03:47.547643 [debug] [MainThread]: Partial parsing: deleted source source.onward_materialize.kafka.src_driver_location
[0m15:03:47.547741 [debug] [MainThread]: Partial parsing: update schema file: onward_materialize://models/schema.yml
[0m15:03:47.547906 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m15:03:47.559081 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m15:03:47.569576 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m15:03:47.584811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47f5aa6a-faef-424b-8a04-f7040fd3521d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8aa06650>]}
[0m15:03:47.590580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47f5aa6a-faef-424b-8a04-f7040fd3521d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a9d3e20>]}
[0m15:03:47.590798 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:03:47.590971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47f5aa6a-faef-424b-8a04-f7040fd3521d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a9d3e80>]}
[0m15:03:47.591815 [info ] [MainThread]: 
[0m15:03:47.592197 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:03:47.592879 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m15:03:47.599849 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m15:03:47.599963 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m15:03:47.600050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:50.231527 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.63 seconds
[0m15:03:50.238470 [debug] [ThreadPool]: On list_materialize: Close
[0m15:03:50.242329 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m15:03:50.251944 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m15:03:50.252197 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m15:03:50.252371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:51.645105 [debug] [ThreadPool]: SQL status: SELECT 0 in 1.39 seconds
[0m15:03:51.650942 [debug] [ThreadPool]: On list_materialize_public: Close
[0m15:03:51.652975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47f5aa6a-faef-424b-8a04-f7040fd3521d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a8d1ae0>]}
[0m15:03:51.654142 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m15:03:51.654567 [info ] [MainThread]: 
[0m15:03:51.662263 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m15:03:51.662734 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m15:03:51.663784 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m15:03:51.663998 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m15:03:51.664225 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m15:03:51.668639 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m15:03:51.669581 [debug] [Thread-1 (]: finished collecting timing info
[0m15:03:51.669783 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m15:03:51.684158 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m15:03:51.684910 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:03:51.685076 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m15:03:51.685207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:53.002650 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected end of statement, found VALUE
LINE 15:   VALUE FORMAT BYTES
           ^

[0m15:03:53.004102 [debug] [Thread-1 (]: finished collecting timing info
[0m15:03:53.004829 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m15:03:53.006908 [debug] [Thread-1 (]: Database Error in model src_driver_location (models/sources/src_driver_location.sql)
  Expected end of statement, found VALUE
  LINE 15:   VALUE FORMAT BYTES
             ^
  compiled Code at target/run/onward_materialize/models/sources/src_driver_location.sql
[0m15:03:53.007732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f5aa6a-faef-424b-8a04-f7040fd3521d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8aa4ee00>]}
[0m15:03:53.008760 [error] [Thread-1 (]: 1 of 2 ERROR creating sql source model public.src_driver_location .............. [[31mERROR[0m in 1.34s]
[0m15:03:53.010051 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m15:03:53.011191 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m15:03:53.011635 [info ] [Thread-1 (]: 2 of 2 SKIP relation public.json_driver_location ............................... [[33mSKIP[0m]
[0m15:03:53.012344 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m15:03:53.014031 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:03:53.014802 [info ] [MainThread]: 
[0m15:03:53.015178 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 5.42 seconds (5.42s).
[0m15:03:53.015511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:53.015690 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m15:03:53.025304 [info ] [MainThread]: 
[0m15:03:53.025621 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:03:53.025885 [info ] [MainThread]: 
[0m15:03:53.026120 [error] [MainThread]: [33mDatabase Error in model src_driver_location (models/sources/src_driver_location.sql)[0m
[0m15:03:53.026364 [error] [MainThread]:   Expected end of statement, found VALUE
[0m15:03:53.026589 [error] [MainThread]:   LINE 15:   VALUE FORMAT BYTES
[0m15:03:53.026807 [error] [MainThread]:              ^
[0m15:03:53.027023 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/sources/src_driver_location.sql
[0m15:03:53.027248 [info ] [MainThread]: 
[0m15:03:53.027482 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m15:03:53.027832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a9d3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8a9d3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8aa12aa0>]}
[0m15:03:53.028073 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 15:04:39.677339 | af9546c5-9bb1-47bc-b46a-2117101e4080 ==============================
[0m15:04:39.677392 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:04:39.677883 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:04:39.678003 [debug] [MainThread]: Tracking: tracking
[0m15:04:39.702129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6a9056f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6a905e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6a907700>]}
[0m15:04:39.746434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:04:39.746767 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m15:04:39.757517 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m15:04:39.767792 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m15:04:39.780405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af9546c5-9bb1-47bc-b46a-2117101e4080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6ab200d0>]}
[0m15:04:39.785223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af9546c5-9bb1-47bc-b46a-2117101e4080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6aa3c910>]}
[0m15:04:39.785428 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:04:39.785594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af9546c5-9bb1-47bc-b46a-2117101e4080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6aa597b0>]}
[0m15:04:39.786417 [info ] [MainThread]: 
[0m15:04:39.786806 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:04:39.787498 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m15:04:39.794878 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m15:04:39.795045 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m15:04:39.795139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:41.245866 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.45 seconds
[0m15:04:41.252393 [debug] [ThreadPool]: On list_materialize: Close
[0m15:04:41.255174 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m15:04:41.264582 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m15:04:41.264862 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m15:04:41.265041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:42.602954 [debug] [ThreadPool]: SQL status: SELECT 0 in 1.34 seconds
[0m15:04:42.609974 [debug] [ThreadPool]: On list_materialize_public: Close
[0m15:04:42.611727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af9546c5-9bb1-47bc-b46a-2117101e4080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6aa6fee0>]}
[0m15:04:42.612592 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m15:04:42.612900 [info ] [MainThread]: 
[0m15:04:42.619435 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m15:04:42.619784 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m15:04:42.620403 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m15:04:42.620560 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m15:04:42.620722 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m15:04:42.623918 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m15:04:42.624387 [debug] [Thread-1 (]: finished collecting timing info
[0m15:04:42.624540 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m15:04:42.636651 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m15:04:42.637189 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:04:42.637303 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m15:04:42.637403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:45.033511 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 2.4 seconds
[0m15:04:45.054476 [debug] [Thread-1 (]: finished collecting timing info
[0m15:04:45.054912 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m15:04:45.056020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9546c5-9bb1-47bc-b46a-2117101e4080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6ab3d570>]}
[0m15:04:45.056513 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.44s]
[0m15:04:45.057409 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m15:04:45.058074 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m15:04:45.058553 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m15:04:45.059119 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m15:04:45.059267 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m15:04:45.059409 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m15:04:45.062414 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m15:04:45.063389 [debug] [Thread-1 (]: finished collecting timing info
[0m15:04:45.063575 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m15:04:45.071994 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m15:04:45.072647 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m15:04:45.072777 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m15:04:45.072887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:46.398744 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "key" does not exist

[0m15:04:46.400998 [debug] [Thread-1 (]: finished collecting timing info
[0m15:04:46.401700 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m15:04:46.403754 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  column "key" does not exist
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m15:04:46.404508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9546c5-9bb1-47bc-b46a-2117101e4080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6abad420>]}
[0m15:04:46.405248 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 1.35s]
[0m15:04:46.406008 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m15:04:46.408046 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:04:46.408871 [info ] [MainThread]: 
[0m15:04:46.409263 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 6.62 seconds (6.62s).
[0m15:04:46.409613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:46.409790 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m15:04:46.419274 [info ] [MainThread]: 
[0m15:04:46.419620 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:04:46.419921 [info ] [MainThread]: 
[0m15:04:46.420164 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m15:04:46.420413 [error] [MainThread]:   column "key" does not exist
[0m15:04:46.420633 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m15:04:46.420870 [info ] [MainThread]: 
[0m15:04:46.421116 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:04:46.421505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6a9054b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6aa6ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6ab3d8a0>]}
[0m15:04:46.421789 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 15:05:21.524046 | 3b0d40fb-019e-4338-b7eb-f0f63f0ded55 ==============================
[0m15:05:21.524103 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:05:21.525080 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:05:21.525220 [debug] [MainThread]: Tracking: tracking
[0m15:05:21.546907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89223f9e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89223fa500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89223f8e80>]}
[0m15:05:21.591333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:05:21.591679 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m15:05:21.602547 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m15:05:21.625414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b0d40fb-019e-4338-b7eb-f0f63f0ded55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890095c0d0>]}
[0m15:05:21.630014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b0d40fb-019e-4338-b7eb-f0f63f0ded55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8920ba12d0>]}
[0m15:05:21.630231 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:05:21.630402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0d40fb-019e-4338-b7eb-f0f63f0ded55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89225496f0>]}
[0m15:05:21.631326 [info ] [MainThread]: 
[0m15:05:21.631728 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:05:21.632422 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m15:05:21.639518 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m15:05:21.639673 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m15:05:21.639763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:23.115498 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.48 seconds
[0m15:05:23.121748 [debug] [ThreadPool]: On list_materialize: Close
[0m15:05:23.125657 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m15:05:23.135057 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m15:05:23.135325 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m15:05:23.135502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:24.455742 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.32 seconds
[0m15:05:24.462805 [debug] [ThreadPool]: On list_materialize_public: Close
[0m15:05:24.464665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0d40fb-019e-4338-b7eb-f0f63f0ded55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89223f1600>]}
[0m15:05:24.465645 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m15:05:24.466011 [info ] [MainThread]: 
[0m15:05:24.472589 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m15:05:24.473173 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m15:05:24.473877 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m15:05:24.474063 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m15:05:24.474254 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m15:05:24.478072 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m15:05:24.478973 [debug] [Thread-1 (]: finished collecting timing info
[0m15:05:24.479138 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m15:05:24.492778 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:05:24.493021 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m15:05:24.493130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:25.938908 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.45 seconds
[0m15:05:25.953659 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m15:05:25.954784 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:05:25.954955 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m15:05:27.120585 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.17 seconds
[0m15:05:27.141993 [debug] [Thread-1 (]: finished collecting timing info
[0m15:05:27.142463 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m15:05:27.143604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0d40fb-019e-4338-b7eb-f0f63f0ded55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89223f1600>]}
[0m15:05:27.144100 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.67s]
[0m15:05:27.145140 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m15:05:27.146113 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m15:05:27.146435 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m15:05:27.147156 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m15:05:27.147331 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m15:05:27.147500 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m15:05:27.151416 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m15:05:27.153450 [debug] [Thread-1 (]: finished collecting timing info
[0m15:05:27.153646 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m15:05:27.163212 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m15:05:27.164280 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m15:05:27.164424 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m15:05:27.164536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:28.578686 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 1.41 seconds
[0m15:05:28.587348 [debug] [Thread-1 (]: finished collecting timing info
[0m15:05:28.587865 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m15:05:28.589095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0d40fb-019e-4338-b7eb-f0f63f0ded55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8900a0cf40>]}
[0m15:05:28.589712 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 1.44s]
[0m15:05:28.590349 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m15:05:28.592309 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:05:28.593200 [info ] [MainThread]: 
[0m15:05:28.593571 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 6.96 seconds (6.96s).
[0m15:05:28.593886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:28.594038 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m15:05:28.604465 [info ] [MainThread]: 
[0m15:05:28.604806 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:28.605084 [info ] [MainThread]: 
[0m15:05:28.605313 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:05:28.605608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8900987070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89009ef460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89009ee9e0>]}
[0m15:05:28.605831 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 15:07:56.459782 | 9364c8a4-a059-4b04-bd0b-9072fb987c3f ==============================
[0m15:07:56.459854 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:07:56.460579 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:07:56.460717 [debug] [MainThread]: Tracking: tracking
[0m15:07:56.481976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432b39b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432b3a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432b38b50>]}
[0m15:07:56.526471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:07:56.526802 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m15:07:56.536921 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m15:07:56.558532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9364c8a4-a059-4b04-bd0b-9072fb987c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432c3c0d0>]}
[0m15:07:56.563183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9364c8a4-a059-4b04-bd0b-9072fb987c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4312392d0>]}
[0m15:07:56.563375 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:07:56.563547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9364c8a4-a059-4b04-bd0b-9072fb987c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4207396f0>]}
[0m15:07:56.564396 [info ] [MainThread]: 
[0m15:07:56.564786 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:07:56.565453 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m15:07:56.572897 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m15:07:56.573065 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m15:07:56.573158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:58.370640 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.8 seconds
[0m15:07:58.374876 [debug] [ThreadPool]: On list_materialize: Close
[0m15:07:58.380497 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m15:07:58.390503 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m15:07:58.390919 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m15:07:58.391130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:59.811572 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.42 seconds
[0m15:07:59.817186 [debug] [ThreadPool]: On list_materialize_public: Close
[0m15:07:59.818893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9364c8a4-a059-4b04-bd0b-9072fb987c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432b31600>]}
[0m15:07:59.820067 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m15:07:59.820552 [info ] [MainThread]: 
[0m15:07:59.828212 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m15:07:59.828976 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m15:07:59.829875 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m15:07:59.830116 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m15:07:59.830374 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m15:07:59.834853 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m15:07:59.835635 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:59.835847 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m15:07:59.851421 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:07:59.851655 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m15:07:59.851783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:01.428902 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.58 seconds
[0m15:08:01.444737 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m15:08:01.445851 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:08:01.446042 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m15:08:02.551755 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.11 seconds
[0m15:08:02.573078 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:02.573538 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m15:08:02.574739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9364c8a4-a059-4b04-bd0b-9072fb987c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432b31600>]}
[0m15:08:02.575300 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.75s]
[0m15:08:02.576292 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m15:08:02.577228 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m15:08:02.577554 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m15:08:02.578259 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m15:08:02.578440 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m15:08:02.578607 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m15:08:02.582277 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m15:08:02.583039 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:02.583199 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m15:08:02.592419 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m15:08:02.592560 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m15:08:02.592672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:03.908389 [debug] [Thread-1 (]: SQL status: DROP VIEW in 1.32 seconds
[0m15:08:03.916395 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m15:08:03.917785 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m15:08:03.918058 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m15:08:04.139105 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.22 seconds
[0m15:08:04.141571 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:04.141765 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m15:08:04.142476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9364c8a4-a059-4b04-bd0b-9072fb987c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432d00eb0>]}
[0m15:08:04.143220 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 1.56s]
[0m15:08:04.143920 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m15:08:04.145827 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:08:04.147134 [info ] [MainThread]: 
[0m15:08:04.147612 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 7.58 seconds (7.58s).
[0m15:08:04.147968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:04.148163 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m15:08:04.160316 [info ] [MainThread]: 
[0m15:08:04.160684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:04.160980 [info ] [MainThread]: 
[0m15:08:04.161244 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:08:04.161673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432cce2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432cce980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd432ccdcf0>]}
[0m15:08:04.161983 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 15:13:38.806878 | 468ab031-069c-4e39-938f-e0d8db5ce013 ==============================
[0m15:13:38.806950 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:13:38.807680 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:13:38.807831 [debug] [MainThread]: Tracking: tracking
[0m15:13:38.831822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfa839b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfa83a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfa838b50>]}
[0m15:13:38.876984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:13:38.877314 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m15:13:38.887380 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m15:13:38.908469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '468ab031-069c-4e39-938f-e0d8db5ce013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd87c40d0>]}
[0m15:13:38.912897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '468ab031-069c-4e39-938f-e0d8db5ce013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcf8f392d0>]}
[0m15:13:38.913082 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:13:38.913254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '468ab031-069c-4e39-938f-e0d8db5ce013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd87116f0>]}
[0m15:13:38.914094 [info ] [MainThread]: 
[0m15:13:38.914481 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:13:38.915145 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m15:13:38.922615 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m15:13:38.922806 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m15:13:38.922906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:40.375132 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.45 seconds
[0m15:13:40.383098 [debug] [ThreadPool]: On list_materialize: Close
[0m15:13:40.385679 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m15:13:40.392448 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m15:13:40.392612 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m15:13:40.392734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:41.770369 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.38 seconds
[0m15:13:41.777122 [debug] [ThreadPool]: On list_materialize_public: Close
[0m15:13:41.778963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '468ab031-069c-4e39-938f-e0d8db5ce013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd87eef50>]}
[0m15:13:41.779968 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m15:13:41.780361 [info ] [MainThread]: 
[0m15:13:41.787039 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m15:13:41.787755 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m15:13:41.788542 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m15:13:41.788749 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m15:13:41.788967 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m15:13:41.792896 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m15:13:41.793344 [debug] [Thread-1 (]: finished collecting timing info
[0m15:13:41.793500 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m15:13:41.806868 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:13:41.807127 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m15:13:41.807249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:43.261559 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.45 seconds
[0m15:13:43.278616 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m15:13:43.279937 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m15:13:43.280136 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m15:13:44.385067 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.1 seconds
[0m15:13:44.406767 [debug] [Thread-1 (]: finished collecting timing info
[0m15:13:44.407200 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m15:13:44.408303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468ab031-069c-4e39-938f-e0d8db5ce013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd87eef50>]}
[0m15:13:44.408821 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.62s]
[0m15:13:44.409813 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m15:13:44.410786 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m15:13:44.411095 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m15:13:44.411762 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m15:13:44.411938 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m15:13:44.412100 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m15:13:44.415993 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m15:13:44.416692 [debug] [Thread-1 (]: finished collecting timing info
[0m15:13:44.416850 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m15:13:44.426926 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m15:13:44.427160 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m15:13:44.427295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:45.846713 [debug] [Thread-1 (]: SQL status: DROP VIEW in 1.42 seconds
[0m15:13:45.852869 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m15:13:45.854014 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m15:13:45.854297 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m15:13:46.100264 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.25 seconds
[0m15:13:46.108901 [debug] [Thread-1 (]: finished collecting timing info
[0m15:13:46.109233 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m15:13:46.110265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468ab031-069c-4e39-938f-e0d8db5ce013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd8884eb0>]}
[0m15:13:46.110749 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 1.70s]
[0m15:13:46.111267 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m15:13:46.112762 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m15:13:46.113355 [info ] [MainThread]: 
[0m15:13:46.113625 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 7.20 seconds (7.20s).
[0m15:13:46.113864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:46.113981 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m15:13:46.122508 [info ] [MainThread]: 
[0m15:13:46.122772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:46.122986 [info ] [MainThread]: 
[0m15:13:46.123174 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:13:46.123433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd8855b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd8857430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd88553c0>]}
[0m15:13:46.123627 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 18:58:55.158314 | 0837484e-6682-4ad3-93ca-53048772c375 ==============================
[0m18:58:55.158438 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:58:55.159336 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:58:55.159467 [debug] [MainThread]: Tracking: tracking
[0m18:58:55.185013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa41a472980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa41a4730a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa41a4715a0>]}
[0m18:58:55.215708 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:58:55.216048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0837484e-6682-4ad3-93ca-53048772c375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa418f08b80>]}
[0m18:58:55.234053 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
[0m18:58:55.236022 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:58:55.237540 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:58:55.244518 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
[0m18:58:55.246724 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m18:58:55.249654 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m18:58:55.255730 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m18:58:55.257777 [debug] [MainThread]: Parsing macros/materializations/source.sql
[0m18:58:55.259773 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m18:58:55.261735 [debug] [MainThread]: Parsing macros/materializations/sink.sql
[0m18:58:55.263693 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m18:58:55.264299 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m18:58:55.265477 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:58:55.266928 [debug] [MainThread]: Parsing macros/relations.sql
[0m18:58:55.267858 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:58:55.283999 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m18:58:55.284741 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m18:58:55.285800 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:58:55.286187 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:58:55.287143 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:58:55.291758 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:58:55.292141 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:58:55.292930 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:58:55.293654 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:58:55.296500 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:58:55.298123 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:58:55.299182 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:58:55.310417 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:58:55.319525 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:58:55.327569 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:58:55.330639 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:58:55.331810 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:58:55.333048 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:58:55.338611 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:58:55.349272 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:58:55.350364 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m18:58:55.354880 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:58:55.361872 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:58:55.373028 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:58:55.377035 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:58:55.379494 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:58:55.383074 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:58:55.383885 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:58:55.386040 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:58:55.387397 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:58:55.391851 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:58:55.403682 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:58:55.404634 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:58:55.406163 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:58:55.407121 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:58:55.407662 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:58:55.408176 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:58:55.408589 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:58:55.409441 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:58:55.412825 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:58:55.418257 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:58:55.418789 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:58:55.419728 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:58:55.420393 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:58:55.420971 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:58:55.421731 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:58:55.422226 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:58:55.422839 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:58:55.423708 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:58:55.425362 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:58:55.426260 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:58:55.426958 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:58:55.427665 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:58:55.428304 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:58:55.428890 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:58:55.429548 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:58:55.430105 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:58:55.435564 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:58:55.436321 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:58:55.436931 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:58:55.438093 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:58:55.439479 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:58:55.440161 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:58:55.441142 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:58:55.441829 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:58:55.443122 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m18:58:55.445305 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:58:55.447118 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:58:55.456443 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:58:55.457685 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:58:55.466489 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:58:55.469235 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:58:55.473744 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:58:55.479860 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m18:58:55.483711 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:58:55.670283 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m18:58:55.678907 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m18:58:55.682051 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m18:58:55.719443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0837484e-6682-4ad3-93ca-53048772c375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa41a61e5f0>]}
[0m18:58:55.725124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0837484e-6682-4ad3-93ca-53048772c375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa41a5c2d40>]}
[0m18:58:55.725391 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:58:55.725575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0837484e-6682-4ad3-93ca-53048772c375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4084e26b0>]}
[0m18:58:55.726570 [info ] [MainThread]: 
[0m18:58:55.727112 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:58:55.727871 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m18:58:55.735795 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m18:58:55.735990 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m18:58:55.736082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:57.287555 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.55 seconds
[0m18:58:57.291125 [debug] [ThreadPool]: On list_materialize: Close
[0m18:58:57.293856 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m18:58:57.300629 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m18:58:57.300829 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m18:58:57.300915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:58.651194 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.35 seconds
[0m18:58:58.656982 [debug] [ThreadPool]: On list_materialize_public: Close
[0m18:58:58.658326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0837484e-6682-4ad3-93ca-53048772c375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4084c1540>]}
[0m18:58:58.659002 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:58:58.659298 [info ] [MainThread]: 
[0m18:58:58.663475 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m18:58:58.663787 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m18:58:58.664436 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m18:58:58.664604 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m18:58:58.664783 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m18:58:58.668268 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m18:58:58.669223 [debug] [Thread-1 (]: finished collecting timing info
[0m18:58:58.669443 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m18:58:58.686127 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:58:58.686435 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m18:58:58.686572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:00.370816 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.68 seconds
[0m18:59:00.380621 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m18:59:00.381715 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m18:59:00.381890 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');


--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m18:59:01.464350 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.08 seconds
[0m18:59:01.479990 [debug] [Thread-1 (]: finished collecting timing info
[0m18:59:01.480339 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m18:59:01.481127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0837484e-6682-4ad3-93ca-53048772c375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa41a6104f0>]}
[0m18:59:01.481528 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.82s]
[0m18:59:01.483957 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m18:59:01.484600 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m18:59:01.484918 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m18:59:01.485616 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m18:59:01.485778 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m18:59:01.485926 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m18:59:01.489393 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m18:59:01.490836 [debug] [Thread-1 (]: finished collecting timing info
[0m18:59:01.491039 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m18:59:01.501428 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m18:59:01.501634 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m18:59:01.501762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:02.833811 [debug] [Thread-1 (]: SQL status: DROP VIEW in 1.33 seconds
[0m18:59:02.840679 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m18:59:02.842834 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m18:59:02.843116 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m18:59:03.077949 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.23 seconds
[0m18:59:03.085194 [debug] [Thread-1 (]: finished collecting timing info
[0m18:59:03.085464 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m18:59:03.086358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0837484e-6682-4ad3-93ca-53048772c375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4085b3790>]}
[0m18:59:03.086774 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 1.60s]
[0m18:59:03.087207 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m18:59:03.088575 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m18:59:03.089358 [info ] [MainThread]: 
[0m18:59:03.089698 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 7.36 seconds (7.36s).
[0m18:59:03.089981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:03.090130 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m18:59:03.137019 [info ] [MainThread]: 
[0m18:59:03.137298 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:59:03.137499 [info ] [MainThread]: 
[0m18:59:03.137742 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:59:03.138011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa41a42f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa41a42f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa41a42faf0>]}
[0m18:59:03.138219 [debug] [MainThread]: Flushing usage events


============================== 2022-12-02 19:01:14.596175 | 69859114-95c3-4825-9317-8941c0316750 ==============================
[0m19:01:14.596243 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:01:14.598720 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m19:01:14.598849 [debug] [MainThread]: Tracking: tracking
[0m19:01:14.630740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab12205660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab12205e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab12205780>]}
[0m19:01:14.679638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:01:14.679820 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:01:14.684807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69859114-95c3-4825-9317-8941c0316750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab123b40d0>]}
[0m19:01:14.689725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69859114-95c3-4825-9317-8941c0316750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab12388ca0>]}
[0m19:01:14.689914 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:01:14.690076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69859114-95c3-4825-9317-8941c0316750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab12388cd0>]}
[0m19:01:14.691009 [info ] [MainThread]: 
[0m19:01:14.691404 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m19:01:14.692108 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m19:01:14.700042 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m19:01:14.700233 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m19:01:14.700330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:16.775229 [debug] [ThreadPool]: SQL status: SELECT 2 in 2.07 seconds
[0m19:01:16.781180 [debug] [ThreadPool]: On list_materialize_public: Close
[0m19:01:16.782713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69859114-95c3-4825-9317-8941c0316750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1236fe50>]}
[0m19:01:16.783509 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:01:16.783821 [info ] [MainThread]: 
[0m19:01:16.789022 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m19:01:16.789639 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m19:01:16.789828 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m19:01:16.790005 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m19:01:16.794456 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m19:01:16.795780 [debug] [Thread-1 (]: finished collecting timing info
[0m19:01:16.796072 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m19:01:16.796266 [debug] [Thread-1 (]: finished collecting timing info
[0m19:01:16.797025 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m19:01:16.798562 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m19:01:16.799427 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m19:01:16.799641 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m19:01:16.799806 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m19:01:16.803394 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m19:01:16.805311 [debug] [Thread-1 (]: finished collecting timing info
[0m19:01:16.805600 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m19:01:16.805772 [debug] [Thread-1 (]: finished collecting timing info
[0m19:01:16.807007 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m19:01:16.807965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:16.824748 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m19:01:16.832237 [info ] [MainThread]: Done.
[0m19:01:16.836424 [debug] [MainThread]: Acquiring new materialize connection "generate_catalog"
[0m19:01:16.836712 [info ] [MainThread]: Building catalog
[0m19:01:16.838148 [debug] [ThreadPool]: Acquiring new materialize connection "materialize.information_schema"
[0m19:01:16.845258 [debug] [ThreadPool]: Using materialize connection "materialize.information_schema"
[0m19:01:16.845483 [debug] [ThreadPool]: On materialize.information_schema: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "materialize.information_schema"} */
select
            d.name as table_database,
            s.name as table_schema,
            o.name as table_name,
            case when o.type = 'materialized-view' then 'materializedview' else o.type end as table_type,
            '' as table_comment,
            c.name as column_name,
            c.position as column_index,
            c.type as column_type,
            '' as column_comment,
            '' as table_owner
        from mz_objects o
        join mz_schemas s on o.schema_id = s.id
        join mz_databases d on s.database_id = d.id and d.name = 'materialize'
        join mz_columns c on c.id = o.id
        where s.name in ('public')
[0m19:01:16.845595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:18.315870 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.47 seconds
[0m19:01:18.325519 [debug] [ThreadPool]: On materialize.information_schema: Close
[0m19:01:18.337273 [info ] [MainThread]: Catalog written to /Users/claytonvanhovel/Desktop/onward-materialize-dbt/target/catalog.json
[0m19:01:18.337753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab12205660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1241baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab12419810>]}
[0m19:01:18.338035 [debug] [MainThread]: Flushing usage events
[0m19:01:18.700538 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:01:18.700895 [debug] [MainThread]: Connection 'materialize.information_schema' was properly closed.


============================== 2022-12-02 19:01:23.827521 | b59b81e1-1d2e-4d0e-baa5-5eeb69440ae8 ==============================
[0m19:01:23.827606 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:01:23.828398 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m19:01:23.828546 [debug] [MainThread]: Tracking: tracking
[0m19:01:23.859255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f20f9b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f20fa1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f20fba00>]}
[0m19:01:23.861627 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m19:01:23.861963 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m19:01:23.862256 [info ] [MainThread]: 
[0m19:01:23.862404 [info ] [MainThread]: 
[0m19:01:23.862545 [info ] [MainThread]: Press Ctrl+C to exit.
[0m19:21:38.286855 [debug] [MainThread]: Flushing usage events
[0m19:21:38.615605 [info ] [MainThread]: ctrl-c


============================== 2022-12-03 02:25:38.417744 | 3d30cafb-bb5a-47b9-ae9c-d88d7f58ce91 ==============================
[0m02:25:38.417813 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:25:38.418827 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:25:38.418977 [debug] [MainThread]: Tracking: tracking
[0m02:25:38.450596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5a5d2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5a5d30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5a5d1600>]}
[0m02:25:38.495395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:25:38.495715 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m02:25:38.510256 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m02:25:38.520899 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m02:25:38.534127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d30cafb-bb5a-47b9-ae9c-d88d7f58ce91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5a6e80d0>]}
[0m02:25:38.538743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d30cafb-bb5a-47b9-ae9c-d88d7f58ce91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb48737fd0>]}
[0m02:25:38.538950 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:25:38.539135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d30cafb-bb5a-47b9-ae9c-d88d7f58ce91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb487217e0>]}
[0m02:25:38.539983 [info ] [MainThread]: 
[0m02:25:38.540371 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m02:25:38.541073 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m02:25:38.548579 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m02:25:38.548766 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m02:25:38.548856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:25:40.193100 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.64 seconds
[0m02:25:40.198264 [debug] [ThreadPool]: On list_materialize: Close
[0m02:25:40.201010 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m02:25:40.208597 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m02:25:40.208898 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m02:25:40.209053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:25:41.600317 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.39 seconds
[0m02:25:41.605189 [debug] [ThreadPool]: On list_materialize_public: Close
[0m02:25:41.606656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d30cafb-bb5a-47b9-ae9c-d88d7f58ce91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5a5c83a0>]}
[0m02:25:41.607476 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m02:25:41.607830 [info ] [MainThread]: 
[0m02:25:41.614160 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m02:25:41.614546 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m02:25:41.615255 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m02:25:41.615442 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m02:25:41.615647 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m02:25:41.619898 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m02:25:41.620624 [debug] [Thread-1 (]: finished collecting timing info
[0m02:25:41.620815 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m02:25:41.636011 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m02:25:41.636265 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m02:25:41.636393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:25:43.033120 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.4 seconds
[0m02:25:43.045748 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m02:25:43.046595 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m02:25:43.046773 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m02:25:44.187664 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.14 seconds
[0m02:25:44.202982 [debug] [Thread-1 (]: finished collecting timing info
[0m02:25:44.203308 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m02:25:44.204144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d30cafb-bb5a-47b9-ae9c-d88d7f58ce91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5a73a5f0>]}
[0m02:25:44.204539 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.59s]
[0m02:25:44.206452 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m02:25:44.207106 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m02:25:44.207450 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m02:25:44.208113 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m02:25:44.208282 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m02:25:44.208432 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m02:25:44.212040 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m02:25:44.212550 [debug] [Thread-1 (]: finished collecting timing info
[0m02:25:44.212708 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m02:25:44.222348 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m02:25:44.222523 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m02:25:44.222637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:25:45.625690 [debug] [Thread-1 (]: SQL status: DROP VIEW in 1.4 seconds
[0m02:25:45.631779 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m02:25:45.632791 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m02:25:45.632964 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m02:25:45.859041 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.22 seconds
[0m02:25:45.865290 [debug] [Thread-1 (]: finished collecting timing info
[0m02:25:45.865668 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m02:25:45.866825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d30cafb-bb5a-47b9-ae9c-d88d7f58ce91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb488a4760>]}
[0m02:25:45.867322 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 1.66s]
[0m02:25:45.867848 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m02:25:45.869453 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m02:25:45.870161 [info ] [MainThread]: 
[0m02:25:45.870473 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 7.33 seconds (7.33s).
[0m02:25:45.870743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:25:45.870874 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m02:25:45.881675 [info ] [MainThread]: 
[0m02:25:45.882013 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:25:45.882298 [info ] [MainThread]: 
[0m02:25:45.882543 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:25:45.882919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5a5d14b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb48737d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb488cafb0>]}
[0m02:25:45.883229 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 02:26:52.846977 | 12747a08-cfc5-4020-8c41-349604d4ffd3 ==============================
[0m02:26:52.847032 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:26:52.847646 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:26:52.847755 [debug] [MainThread]: Tracking: tracking
[0m02:26:52.878732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0124356f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb012435e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb012437700>]}
[0m02:26:52.924641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:26:52.924988 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m02:26:52.935592 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m02:26:52.957087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12747a08-cfc5-4020-8c41-349604d4ffd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff068c0a0>]}
[0m02:26:52.961619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12747a08-cfc5-4020-8c41-349604d4ffd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0004b40a0>]}
[0m02:26:52.961817 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:26:52.961987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12747a08-cfc5-4020-8c41-349604d4ffd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0004d16c0>]}
[0m02:26:52.962884 [info ] [MainThread]: 
[0m02:26:52.963295 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m02:26:52.963962 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m02:26:52.971610 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m02:26:52.971820 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m02:26:52.971921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:54.368444 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.4 seconds
[0m02:26:54.373568 [debug] [ThreadPool]: On list_materialize: Close
[0m02:26:54.376715 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m02:26:54.384393 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m02:26:54.384610 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m02:26:54.384765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:26:55.726724 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.34 seconds
[0m02:26:55.734440 [debug] [ThreadPool]: On list_materialize_public: Close
[0m02:26:55.736259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12747a08-cfc5-4020-8c41-349604d4ffd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff06baf20>]}
[0m02:26:55.737171 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m02:26:55.737496 [info ] [MainThread]: 
[0m02:26:55.744431 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m02:26:55.745082 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m02:26:55.745908 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m02:26:55.746123 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m02:26:55.746354 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m02:26:55.750551 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m02:26:55.751100 [debug] [Thread-1 (]: finished collecting timing info
[0m02:26:55.751235 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m02:26:55.765954 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m02:26:55.766162 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m02:26:55.766290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:26:57.254829 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.49 seconds
[0m02:26:57.269057 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m02:26:57.269950 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m02:26:57.270121 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m02:26:58.553390 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.28 seconds
[0m02:26:58.569934 [debug] [Thread-1 (]: finished collecting timing info
[0m02:26:58.570360 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m02:26:58.571343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12747a08-cfc5-4020-8c41-349604d4ffd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff06baf20>]}
[0m02:26:58.571789 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.83s]
[0m02:26:58.573832 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m02:26:58.574581 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m02:26:58.574885 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m02:26:58.575526 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m02:26:58.575692 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m02:26:58.575844 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m02:26:58.579478 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m02:26:58.580228 [debug] [Thread-1 (]: finished collecting timing info
[0m02:26:58.580399 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m02:26:58.590602 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m02:26:58.590847 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m02:26:58.591011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:26:59.886407 [debug] [Thread-1 (]: SQL status: DROP VIEW in 1.3 seconds
[0m02:26:59.893656 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m02:26:59.894681 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m02:26:59.894876 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    data->>'uid' AS uid,
    to_timestamp(data->>'timestamp') AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m02:27:00.049307 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Cannot call function to_timestamp(text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

[0m02:27:00.052077 [debug] [Thread-1 (]: finished collecting timing info
[0m02:27:00.052434 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m02:27:00.053488 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Cannot call function to_timestamp(text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m02:27:00.053891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12747a08-cfc5-4020-8c41-349604d4ffd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff0745060>]}
[0m02:27:00.054393 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 1.48s]
[0m02:27:00.054963 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m02:27:00.056230 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m02:27:00.056708 [info ] [MainThread]: 
[0m02:27:00.056992 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 7.09 seconds (7.09s).
[0m02:27:00.057258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:27:00.057396 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m02:27:00.066960 [info ] [MainThread]: 
[0m02:27:00.072632 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:27:00.072922 [info ] [MainThread]: 
[0m02:27:00.073165 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m02:27:00.073399 [error] [MainThread]:   Cannot call function to_timestamp(text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
[0m02:27:00.073623 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m02:27:00.073857 [info ] [MainThread]: 
[0m02:27:00.074092 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:27:00.074425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff071fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff071df60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff071dc60>]}
[0m02:27:00.074683 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 02:27:49.010384 | 85f76303-5be7-45a5-89b1-e1ec99086420 ==============================
[0m02:27:49.010463 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:27:49.011083 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:27:49.011214 [debug] [MainThread]: Tracking: tracking
[0m02:27:49.032939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f9332950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f93330d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f9331600>]}
[0m02:27:49.076707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:27:49.077057 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m02:27:49.086517 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m02:27:49.108223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85f76303-5be7-45a5-89b1-e1ec99086420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f95340d0>]}
[0m02:27:49.112852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85f76303-5be7-45a5-89b1-e1ec99086420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f9497ee0>]}
[0m02:27:49.113072 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:27:49.113248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85f76303-5be7-45a5-89b1-e1ec99086420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f94816f0>]}
[0m02:27:49.114120 [info ] [MainThread]: 
[0m02:27:49.114524 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m02:27:49.115204 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m02:27:49.122602 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m02:27:49.122783 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m02:27:49.122872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:27:50.484961 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.36 seconds
[0m02:27:50.490422 [debug] [ThreadPool]: On list_materialize: Close
[0m02:27:50.493419 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m02:27:50.501286 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m02:27:50.501534 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m02:27:50.501710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:52.234955 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.73 seconds
[0m02:27:52.240373 [debug] [ThreadPool]: On list_materialize_public: Close
[0m02:27:52.241658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85f76303-5be7-45a5-89b1-e1ec99086420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f93297e0>]}
[0m02:27:52.242550 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m02:27:52.242920 [info ] [MainThread]: 
[0m02:27:52.249739 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m02:27:52.250501 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m02:27:52.251441 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m02:27:52.251688 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m02:27:52.251861 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m02:27:52.255943 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m02:27:52.257082 [debug] [Thread-1 (]: finished collecting timing info
[0m02:27:52.257323 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m02:27:52.273160 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m02:27:52.273361 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m02:27:52.273475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:53.687350 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.41 seconds
[0m02:27:53.700331 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m02:27:53.701439 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m02:27:53.701613 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m02:27:54.871908 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.17 seconds
[0m02:27:54.892937 [debug] [Thread-1 (]: finished collecting timing info
[0m02:27:54.893261 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m02:27:54.894083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85f76303-5be7-45a5-89b1-e1ec99086420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f93297e0>]}
[0m02:27:54.894467 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.64s]
[0m02:27:54.895223 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m02:27:54.895898 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m02:27:54.896231 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m02:27:54.896931 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m02:27:54.897095 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m02:27:54.897242 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m02:27:54.900631 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m02:27:54.901165 [debug] [Thread-1 (]: finished collecting timing info
[0m02:27:54.901331 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m02:27:54.910488 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m02:27:54.910959 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m02:27:54.911096 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    data->>'uid' AS uid,
    to_timestamp(data->>'timestamp') AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m02:27:54.911217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:56.209488 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Cannot call function to_timestamp(text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

[0m02:27:56.211518 [debug] [Thread-1 (]: finished collecting timing info
[0m02:27:56.212147 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m02:27:56.214414 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Cannot call function to_timestamp(text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m02:27:56.214919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85f76303-5be7-45a5-89b1-e1ec99086420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f95de830>]}
[0m02:27:56.215327 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 1.32s]
[0m02:27:56.215771 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m02:27:56.217065 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m02:27:56.217635 [info ] [MainThread]: 
[0m02:27:56.217911 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 7.10 seconds (7.10s).
[0m02:27:56.218160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:27:56.218292 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m02:27:56.226656 [info ] [MainThread]: 
[0m02:27:56.226949 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:27:56.227215 [info ] [MainThread]: 
[0m02:27:56.227448 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m02:27:56.227684 [error] [MainThread]:   Cannot call function to_timestamp(text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
[0m02:27:56.227911 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m02:27:56.228140 [info ] [MainThread]: 
[0m02:27:56.228374 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:27:56.228718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f9563070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f95c5900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f95c4160>]}
[0m02:27:56.228957 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 02:28:20.600985 | ccc56edf-b96b-4d1b-aca4-81bb88261788 ==============================
[0m02:28:20.601051 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:28:20.604918 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:28:20.605067 [debug] [MainThread]: Tracking: tracking
[0m02:28:20.630831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc24ba8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc24bb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc24baa10>]}
[0m02:28:20.674708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:28:20.675040 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m02:28:20.687082 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m02:28:20.708190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccc56edf-b96b-4d1b-aca4-81bb88261788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c802840d0>]}
[0m02:28:20.712620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccc56edf-b96b-4d1b-aca4-81bb88261788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca030c790>]}
[0m02:28:20.712809 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:28:20.712979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccc56edf-b96b-4d1b-aca4-81bb88261788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca0329720>]}
[0m02:28:20.713818 [info ] [MainThread]: 
[0m02:28:20.714204 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m02:28:20.714885 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m02:28:20.722263 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m02:28:20.722445 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m02:28:20.722543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:28:22.209184 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.49 seconds
[0m02:28:22.214665 [debug] [ThreadPool]: On list_materialize: Close
[0m02:28:22.217020 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m02:28:22.224020 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m02:28:22.224228 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m02:28:22.224380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:28:23.631591 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.41 seconds
[0m02:28:23.638110 [debug] [ThreadPool]: On list_materialize_public: Close
[0m02:28:23.639706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccc56edf-b96b-4d1b-aca4-81bb88261788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c802b2ef0>]}
[0m02:28:23.640627 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m02:28:23.640962 [info ] [MainThread]: 
[0m02:28:23.647083 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m02:28:23.647702 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m02:28:23.648425 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m02:28:23.648634 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m02:28:23.648835 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m02:28:23.652828 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m02:28:23.653510 [debug] [Thread-1 (]: finished collecting timing info
[0m02:28:23.653696 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m02:28:23.668876 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m02:28:23.669081 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m02:28:23.669194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:25.086675 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.42 seconds
[0m02:28:25.098631 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m02:28:25.099651 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m02:28:25.099827 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m02:28:26.205614 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.11 seconds
[0m02:28:26.222643 [debug] [Thread-1 (]: finished collecting timing info
[0m02:28:26.223064 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m02:28:26.224063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccc56edf-b96b-4d1b-aca4-81bb88261788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c802b2a70>]}
[0m02:28:26.224404 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.58s]
[0m02:28:26.224953 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m02:28:26.225472 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m02:28:26.225658 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m02:28:26.226010 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m02:28:26.226103 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m02:28:26.226195 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m02:28:26.228781 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m02:28:26.229111 [debug] [Thread-1 (]: finished collecting timing info
[0m02:28:26.229203 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m02:28:26.238807 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m02:28:26.239387 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m02:28:26.239530 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    data->>'uid' AS uid,
    data->>'timestamp' AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m02:28:26.239657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:28:27.692326 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 1.45 seconds
[0m02:28:27.698405 [debug] [Thread-1 (]: finished collecting timing info
[0m02:28:27.698758 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m02:28:27.699900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccc56edf-b96b-4d1b-aca4-81bb88261788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8033cf70>]}
[0m02:28:27.700433 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 1.47s]
[0m02:28:27.700962 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m02:28:27.702511 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m02:28:27.703179 [info ] [MainThread]: 
[0m02:28:27.703488 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 6.99 seconds (6.99s).
[0m02:28:27.703763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:28:27.703896 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m02:28:27.713996 [info ] [MainThread]: 
[0m02:28:27.714246 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:28:27.714456 [info ] [MainThread]: 
[0m02:28:27.714675 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:28:27.715035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c80315690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c80317ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c803152a0>]}
[0m02:28:27.715282 [debug] [MainThread]: Flushing usage events


============================== 2022-12-06 00:58:03.833486 | 186186ac-1941-46fc-bf57-2f85a161bbc1 ==============================
[0m00:58:03.833560 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:58:03.835500 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:58:03.835669 [debug] [MainThread]: Tracking: tracking
[0m00:58:03.872407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5ae1a8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5ae1b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5ae1aa10>]}
[0m00:58:03.900938 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:58:03.901214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '186186ac-1941-46fc-bf57-2f85a161bbc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac59318be0>]}
[0m00:58:03.918885 [debug] [MainThread]: Parsing macros/mz_generate_name.sql
[0m00:58:03.920366 [debug] [MainThread]: Parsing macros/catalog.sql
[0m00:58:03.921678 [debug] [MainThread]: Parsing macros/adapters.sql
[0m00:58:03.928393 [debug] [MainThread]: Parsing macros/materializations/materialized_view.sql
[0m00:58:03.930457 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m00:58:03.933360 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m00:58:03.939276 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m00:58:03.941262 [debug] [MainThread]: Parsing macros/materializations/source.sql
[0m00:58:03.943309 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m00:58:03.945212 [debug] [MainThread]: Parsing macros/materializations/sink.sql
[0m00:58:03.947062 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m00:58:03.947643 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m00:58:03.948771 [debug] [MainThread]: Parsing macros/catalog.sql
[0m00:58:03.950140 [debug] [MainThread]: Parsing macros/relations.sql
[0m00:58:03.951003 [debug] [MainThread]: Parsing macros/adapters.sql
[0m00:58:03.966308 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m00:58:03.966936 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m00:58:03.967965 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:58:03.968334 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:58:03.969247 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:58:03.973457 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:58:03.973738 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:58:03.974492 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:58:03.975114 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m00:58:03.977433 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m00:58:03.978816 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m00:58:03.979824 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m00:58:03.990013 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m00:58:03.998140 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:58:04.005582 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m00:58:04.008340 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m00:58:04.009392 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m00:58:04.010453 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m00:58:04.015411 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m00:58:04.025144 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m00:58:04.026068 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m00:58:04.030192 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:58:04.036918 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m00:58:04.047672 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:58:04.051141 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:58:04.053260 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:58:04.056724 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m00:58:04.057486 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:58:04.059558 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:58:04.060911 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m00:58:04.065263 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:58:04.076898 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m00:58:04.077785 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m00:58:04.079290 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m00:58:04.080206 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m00:58:04.080740 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m00:58:04.081218 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m00:58:04.081619 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m00:58:04.082435 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m00:58:04.085742 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m00:58:04.090976 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m00:58:04.091473 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m00:58:04.092203 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m00:58:04.092760 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:58:04.093305 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:58:04.094027 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m00:58:04.094505 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:58:04.095132 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:58:04.095846 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:58:04.097244 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:58:04.097976 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:58:04.098604 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m00:58:04.099228 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:58:04.099831 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:58:04.100363 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m00:58:04.101013 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m00:58:04.101539 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m00:58:04.107147 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m00:58:04.107839 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:58:04.108381 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:58:04.109446 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:58:04.110759 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m00:58:04.111370 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m00:58:04.112254 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m00:58:04.112876 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m00:58:04.114244 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m00:58:04.116303 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m00:58:04.118028 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:58:04.127235 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:58:04.128428 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:58:04.137022 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m00:58:04.139784 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:58:04.144100 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:58:04.150108 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m00:58:04.153869 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m00:58:04.331724 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m00:58:04.340024 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m00:58:04.342841 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m00:58:04.376663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '186186ac-1941-46fc-bf57-2f85a161bbc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5afc1810>]}
[0m00:58:04.381442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '186186ac-1941-46fc-bf57-2f85a161bbc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5afa3df0>]}
[0m00:58:04.381631 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:58:04.381799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '186186ac-1941-46fc-bf57-2f85a161bbc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5b00a710>]}
[0m00:58:04.382743 [info ] [MainThread]: 
[0m00:58:04.383173 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:58:04.387029 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m00:58:04.394213 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m00:58:04.394339 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m00:58:04.394431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:05.858905 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.46 seconds
[0m00:58:05.863611 [debug] [ThreadPool]: On list_materialize: Close
[0m00:58:05.866206 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m00:58:05.874431 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m00:58:05.874672 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m00:58:05.874832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:58:06.932107 [debug] [ThreadPool]: SQL status: SELECT 0 in 1.06 seconds
[0m00:58:06.938235 [debug] [ThreadPool]: On list_materialize_public: Close
[0m00:58:06.939898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '186186ac-1941-46fc-bf57-2f85a161bbc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5afe9360>]}
[0m00:58:06.940824 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:58:06.941148 [info ] [MainThread]: 
[0m00:58:06.948459 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m00:58:06.948879 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m00:58:06.949645 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m00:58:06.949858 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m00:58:06.950125 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m00:58:06.954538 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m00:58:06.955447 [debug] [Thread-1 (]: finished collecting timing info
[0m00:58:06.955639 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m00:58:06.969792 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m00:58:06.970385 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:58:06.970525 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m00:58:06.970648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:08.138548 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.17 seconds
[0m00:58:08.154681 [debug] [Thread-1 (]: finished collecting timing info
[0m00:58:08.155000 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m00:58:08.155734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186186ac-1941-46fc-bf57-2f85a161bbc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5afc2560>]}
[0m00:58:08.156038 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.21s]
[0m00:58:08.156972 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m00:58:08.157558 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m00:58:08.157787 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m00:58:08.158389 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m00:58:08.158555 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m00:58:08.158700 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m00:58:08.162159 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m00:58:08.163201 [debug] [Thread-1 (]: finished collecting timing info
[0m00:58:08.163378 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m00:58:08.173348 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m00:58:08.174158 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m00:58:08.174329 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    data->>'uid' AS uid,
    data->>'timestamp' AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m00:58:08.174459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:08.939750 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.77 seconds
[0m00:58:08.946553 [debug] [Thread-1 (]: finished collecting timing info
[0m00:58:08.946962 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m00:58:08.948010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '186186ac-1941-46fc-bf57-2f85a161bbc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5b0bf160>]}
[0m00:58:08.948505 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 0.79s]
[0m00:58:08.949031 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m00:58:08.950443 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:58:08.951080 [info ] [MainThread]: 
[0m00:58:08.951360 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m00:58:08.951621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:58:08.951745 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m00:58:08.960877 [info ] [MainThread]: 
[0m00:58:08.961250 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:58:08.961538 [info ] [MainThread]: 
[0m00:58:08.961796 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:58:08.962159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5af4ad70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5af4ae30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5b0bf9d0>]}
[0m00:58:08.962443 [debug] [MainThread]: Flushing usage events


============================== 2022-12-06 00:58:51.948366 | 86ed7bac-da07-4aa3-bdb9-84639bec9aba ==============================
[0m00:58:51.948642 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:58:51.949403 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:58:51.949930 [debug] [MainThread]: Tracking: tracking
[0m00:58:51.977520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc518481e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc518482410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc518480f10>]}
[0m00:58:52.021799 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:58:52.022139 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m00:58:52.032476 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m00:58:52.042580 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m00:58:52.055926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86ed7bac-da07-4aa3-bdb9-84639bec9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54a79c0d0>]}
[0m00:58:52.060690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86ed7bac-da07-4aa3-bdb9-84639bec9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54a6e7fd0>]}
[0m00:58:52.060887 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:58:52.061055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ed7bac-da07-4aa3-bdb9-84639bec9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc518478400>]}
[0m00:58:52.061871 [info ] [MainThread]: 
[0m00:58:52.062275 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:58:52.062970 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m00:58:52.070137 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m00:58:52.070276 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m00:58:52.070369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:52.909025 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.84 seconds
[0m00:58:52.917076 [debug] [ThreadPool]: On list_materialize: Close
[0m00:58:52.919708 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m00:58:52.927218 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m00:58:52.927451 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m00:58:52.927602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:58:53.922692 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.0 seconds
[0m00:58:53.924462 [debug] [ThreadPool]: On list_materialize_public: Close
[0m00:58:53.925844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ed7bac-da07-4aa3-bdb9-84639bec9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5490445e0>]}
[0m00:58:53.926728 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:58:53.927094 [info ] [MainThread]: 
[0m00:58:53.933988 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m00:58:53.934375 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m00:58:53.935081 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m00:58:53.935265 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m00:58:53.935453 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m00:58:53.939536 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m00:58:53.940454 [debug] [Thread-1 (]: finished collecting timing info
[0m00:58:53.940672 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m00:58:53.956510 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:58:53.956818 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m00:58:53.956945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:54.766389 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.81 seconds
[0m00:58:54.778986 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m00:58:54.780167 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:58:54.780349 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');


--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m00:58:55.215233 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.43 seconds
[0m00:58:55.228898 [debug] [Thread-1 (]: finished collecting timing info
[0m00:58:55.229173 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m00:58:55.229951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ed7bac-da07-4aa3-bdb9-84639bec9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54a7ea680>]}
[0m00:58:55.230309 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.30s]
[0m00:58:55.232097 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m00:58:55.232693 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m00:58:55.232956 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m00:58:55.233592 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m00:58:55.233753 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m00:58:55.233887 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m00:58:55.236626 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m00:58:55.237032 [debug] [Thread-1 (]: finished collecting timing info
[0m00:58:55.237164 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m00:58:55.245627 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m00:58:55.245802 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m00:58:55.245906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:56.007978 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.76 seconds
[0m00:58:56.015630 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m00:58:56.016849 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m00:58:56.017253 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    data->>'uid' AS uid,
    data->>'timestamp' AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m00:58:56.164773 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.15 seconds
[0m00:58:56.170934 [debug] [Thread-1 (]: finished collecting timing info
[0m00:58:56.171356 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m00:58:56.172650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ed7bac-da07-4aa3-bdb9-84639bec9aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54a8587f0>]}
[0m00:58:56.173130 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 0.94s]
[0m00:58:56.173599 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m00:58:56.175333 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:58:56.175919 [info ] [MainThread]: 
[0m00:58:56.176198 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 4.11 seconds (4.11s).
[0m00:58:56.176454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:58:56.176586 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m00:58:56.186471 [info ] [MainThread]: 
[0m00:58:56.186787 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:58:56.187066 [info ] [MainThread]: 
[0m00:58:56.187309 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:58:56.187645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54a6e7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54a6e7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc54a878be0>]}
[0m00:58:56.187958 [debug] [MainThread]: Flushing usage events


============================== 2022-12-06 00:59:18.391849 | 784fae48-ff44-4c2d-8817-d7139fb77574 ==============================
[0m00:59:18.391898 [info ] [MainThread]: Running with dbt=1.3.1
[0m00:59:18.392658 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:59:18.392782 [debug] [MainThread]: Tracking: tracking
[0m00:59:18.419899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde3207a9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde3207af80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde32078d90>]}
[0m00:59:18.464654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:59:18.464971 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m00:59:18.475463 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m00:59:18.485728 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m00:59:18.500893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '784fae48-ff44-4c2d-8817-d7139fb77574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde321900d0>]}
[0m00:59:18.505614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '784fae48-ff44-4c2d-8817-d7139fb77574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde208c7fd0>]}
[0m00:59:18.505821 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:59:18.506025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '784fae48-ff44-4c2d-8817-d7139fb77574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde32070220>]}
[0m00:59:18.507063 [info ] [MainThread]: 
[0m00:59:18.507554 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:59:18.508312 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m00:59:18.515490 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m00:59:18.515697 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m00:59:18.515797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:59:19.275859 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.76 seconds
[0m00:59:19.281981 [debug] [ThreadPool]: On list_materialize: Close
[0m00:59:19.284124 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m00:59:19.291583 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m00:59:19.291859 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m00:59:19.292094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:59:19.995487 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.7 seconds
[0m00:59:20.002259 [debug] [ThreadPool]: On list_materialize_public: Close
[0m00:59:20.003928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '784fae48-ff44-4c2d-8817-d7139fb77574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde503645e0>]}
[0m00:59:20.004824 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:59:20.005153 [info ] [MainThread]: 
[0m00:59:20.012817 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m00:59:20.013204 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m00:59:20.013845 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m00:59:20.014024 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m00:59:20.014209 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m00:59:20.018000 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m00:59:20.018497 [debug] [Thread-1 (]: finished collecting timing info
[0m00:59:20.018654 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m00:59:20.031478 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:59:20.031692 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m00:59:20.031799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:21.018723 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.99 seconds
[0m00:59:21.029665 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m00:59:21.030181 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m00:59:21.030305 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

--
CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');


--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m00:59:21.729949 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.7 seconds
[0m00:59:21.747169 [debug] [Thread-1 (]: finished collecting timing info
[0m00:59:21.747604 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m00:59:21.748707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '784fae48-ff44-4c2d-8817-d7139fb77574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde321e2680>]}
[0m00:59:21.749215 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.74s]
[0m00:59:21.750143 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m00:59:21.751033 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m00:59:21.751325 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m00:59:21.751992 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m00:59:21.752159 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m00:59:21.752316 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m00:59:21.756035 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m00:59:21.757593 [debug] [Thread-1 (]: finished collecting timing info
[0m00:59:21.757805 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m00:59:21.767152 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m00:59:21.767337 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m00:59:21.767469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:22.550881 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.78 seconds
[0m00:59:22.556737 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m00:59:22.557763 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m00:59:22.557936 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    data->>'uid' AS uid,
    data->>'timestamp' AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m00:59:22.693253 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.14 seconds
[0m00:59:22.699057 [debug] [Thread-1 (]: finished collecting timing info
[0m00:59:22.699398 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m00:59:22.700463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '784fae48-ff44-4c2d-8817-d7139fb77574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde322847f0>]}
[0m00:59:22.700864 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 0.95s]
[0m00:59:22.701290 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m00:59:22.702610 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m00:59:22.703203 [info ] [MainThread]: 
[0m00:59:22.703491 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m00:59:22.703746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:59:22.703875 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m00:59:22.713545 [info ] [MainThread]: 
[0m00:59:22.713882 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:59:22.714161 [info ] [MainThread]: 
[0m00:59:22.714409 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:59:22.714741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde208c7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde208c7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde322a8460>]}
[0m00:59:22.715001 [debug] [MainThread]: Flushing usage events


============================== 2022-12-06 01:00:24.432397 | 5b883de9-f1a5-4442-82f8-2f2aa24adeb1 ==============================
[0m01:00:24.432466 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:00:24.434467 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:00:24.434628 [debug] [MainThread]: Tracking: tracking
[0m01:00:24.462784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea2d71d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea2d72530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea2d71ea0>]}
[0m01:00:24.509431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:00:24.509799 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m01:00:24.519793 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m01:00:24.530247 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m01:00:24.543244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b883de9-f1a5-4442-82f8-2f2aa24adeb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea2e8c0d0>]}
[0m01:00:24.547867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b883de9-f1a5-4442-82f8-2f2aa24adeb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb00d4910>]}
[0m01:00:24.548057 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:00:24.548224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b883de9-f1a5-4442-82f8-2f2aa24adeb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb00f1810>]}
[0m01:00:24.549062 [info ] [MainThread]: 
[0m01:00:24.549460 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:00:24.550169 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m01:00:24.557474 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m01:00:24.557630 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m01:00:24.557722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:25.343090 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.79 seconds
[0m01:00:25.348847 [debug] [ThreadPool]: On list_materialize: Close
[0m01:00:25.351647 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m01:00:25.359471 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m01:00:25.359695 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m01:00:25.359852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:25.993103 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.63 seconds
[0m01:00:25.995046 [debug] [ThreadPool]: On list_materialize_public: Close
[0m01:00:25.996551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b883de9-f1a5-4442-82f8-2f2aa24adeb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb0107ee0>]}
[0m01:00:25.997386 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:00:25.997703 [info ] [MainThread]: 
[0m01:00:26.004118 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m01:00:26.004458 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m01:00:26.005136 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m01:00:26.005310 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m01:00:26.005478 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m01:00:26.008785 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m01:00:26.009196 [debug] [Thread-1 (]: finished collecting timing info
[0m01:00:26.009323 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m01:00:26.025065 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:00:26.025298 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m01:00:26.025426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:26.839586 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.81 seconds
[0m01:00:26.848415 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m01:00:26.849698 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:00:26.849884 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

--
--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m01:00:27.481355 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.63 seconds
[0m01:00:27.498563 [debug] [Thread-1 (]: finished collecting timing info
[0m01:00:27.499082 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m01:00:27.500273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b883de9-f1a5-4442-82f8-2f2aa24adeb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea2eda620>]}
[0m01:00:27.500845 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.50s]
[0m01:00:27.503123 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m01:00:27.503960 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m01:00:27.504267 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m01:00:27.504929 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m01:00:27.505094 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m01:00:27.505253 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m01:00:27.508921 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m01:00:27.510588 [debug] [Thread-1 (]: finished collecting timing info
[0m01:00:27.510784 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m01:00:27.520945 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m01:00:27.521155 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m01:00:27.521276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:28.507374 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.99 seconds
[0m01:00:28.514724 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m01:00:28.517303 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m01:00:28.517505 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    data->>'uid' AS uid,
    data->>'timestamp' AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m01:00:28.691925 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.17 seconds
[0m01:00:28.698723 [debug] [Thread-1 (]: finished collecting timing info
[0m01:00:28.699072 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m01:00:28.700255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b883de9-f1a5-4442-82f8-2f2aa24adeb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea2f48790>]}
[0m01:00:28.700820 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 1.20s]
[0m01:00:28.701405 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m01:00:28.702888 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:00:28.703538 [info ] [MainThread]: 
[0m01:00:28.703836 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 4.15 seconds (4.15s).
[0m01:00:28.704106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:28.704239 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m01:00:28.713258 [info ] [MainThread]: 
[0m01:00:28.713594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:28.713881 [info ] [MainThread]: 
[0m01:00:28.714124 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:00:28.714468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb0107fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb0107880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea2f6bca0>]}
[0m01:00:28.714717 [debug] [MainThread]: Flushing usage events


============================== 2022-12-06 01:02:58.543266 | 711a4080-c209-4783-b942-6392e08ed265 ==============================
[0m01:02:58.543327 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:02:58.544933 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:02:58.545065 [debug] [MainThread]: Tracking: tracking
[0m01:02:58.577462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1227356c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc122735e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1227376a0>]}
[0m01:02:58.623456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:02:58.623802 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m01:02:58.633966 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m01:02:58.655848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '711a4080-c209-4783-b942-6392e08ed265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f01dc0d0>]}
[0m01:02:58.660475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '711a4080-c209-4783-b942-6392e08ed265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12289fee0>]}
[0m01:02:58.660677 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:02:58.660848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '711a4080-c209-4783-b942-6392e08ed265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1228896f0>]}
[0m01:02:58.661687 [info ] [MainThread]: 
[0m01:02:58.662083 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:02:58.662731 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m01:02:58.669956 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m01:02:58.670139 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m01:02:58.670247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:59.416398 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.75 seconds
[0m01:02:59.422529 [debug] [ThreadPool]: On list_materialize: Close
[0m01:02:59.425079 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m01:02:59.433048 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m01:02:59.433390 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m01:02:59.433548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:03:00.080309 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.65 seconds
[0m01:03:00.085909 [debug] [ThreadPool]: On list_materialize_public: Close
[0m01:03:00.087447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '711a4080-c209-4783-b942-6392e08ed265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1228df4c0>]}
[0m01:03:00.088074 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:03:00.088273 [info ] [MainThread]: 
[0m01:03:00.092798 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m01:03:00.093140 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m01:03:00.093543 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m01:03:00.093641 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m01:03:00.093745 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m01:03:00.095869 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m01:03:00.096231 [debug] [Thread-1 (]: finished collecting timing info
[0m01:03:00.096341 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m01:03:00.106908 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:03:00.107081 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m01:03:00.107171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:00.888763 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.78 seconds
[0m01:03:00.901252 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m01:03:00.902395 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:03:00.902574 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

--
--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m01:03:01.348048 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.45 seconds
[0m01:03:01.365623 [debug] [Thread-1 (]: finished collecting timing info
[0m01:03:01.366098 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m01:03:01.367090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '711a4080-c209-4783-b942-6392e08ed265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1228df4c0>]}
[0m01:03:01.367590 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.27s]
[0m01:03:01.369912 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m01:03:01.370841 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m01:03:01.371103 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m01:03:01.371744 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m01:03:01.371909 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m01:03:01.372074 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m01:03:01.376005 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m01:03:01.377535 [debug] [Thread-1 (]: finished collecting timing info
[0m01:03:01.377725 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m01:03:01.387228 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m01:03:01.387408 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m01:03:01.387524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:02.112867 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.73 seconds
[0m01:03:02.117317 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m01:03:02.120297 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m01:03:02.120502 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    CONVERT_FROM(key, 'utf8') as key
    data->>'uid' AS uid,
    data->>'timestamp' AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m01:03:02.184411 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected right parenthesis, found identifier "data"
LINE 16:     data->>'uid' AS uid,
             ^

[0m01:03:02.186473 [debug] [Thread-1 (]: finished collecting timing info
[0m01:03:02.186953 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m01:03:02.189191 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Expected right parenthesis, found identifier "data"
  LINE 16:     data->>'uid' AS uid,
               ^
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m01:03:02.189719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '711a4080-c209-4783-b942-6392e08ed265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f028d090>]}
[0m01:03:02.190308 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 0.82s]
[0m01:03:02.190884 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m01:03:02.192442 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:03:02.193081 [info ] [MainThread]: 
[0m01:03:02.193366 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m01:03:02.193625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:02.193750 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m01:03:02.204935 [info ] [MainThread]: 
[0m01:03:02.205267 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:03:02.205529 [info ] [MainThread]: 
[0m01:03:02.205768 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m01:03:02.206006 [error] [MainThread]:   Expected right parenthesis, found identifier "data"
[0m01:03:02.206223 [error] [MainThread]:   LINE 16:     data->>'uid' AS uid,
[0m01:03:02.206558 [error] [MainThread]:                ^
[0m01:03:02.206759 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m01:03:02.206949 [info ] [MainThread]: 
[0m01:03:02.207121 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m01:03:02.207437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f0269210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f02692d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f0268af0>]}
[0m01:03:02.207668 [debug] [MainThread]: Flushing usage events


============================== 2022-12-06 01:03:08.370471 | 00d84f9d-643e-49d2-b3ea-8517f42c224f ==============================
[0m01:03:08.370546 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:03:08.371128 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:03:08.371248 [debug] [MainThread]: Tracking: tracking
[0m01:03:08.398237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c84f56f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c84f5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c84f7700>]}
[0m01:03:08.442077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:03:08.442393 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m01:03:08.451892 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m01:03:08.475429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00d84f9d-643e-49d2-b3ea-8517f42c224f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c85fc0d0>]}
[0m01:03:08.480353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00d84f9d-643e-49d2-b3ea-8517f42c224f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ea780790>]}
[0m01:03:08.480577 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:03:08.480757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00d84f9d-643e-49d2-b3ea-8517f42c224f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ea7a16c0>]}
[0m01:03:08.481718 [info ] [MainThread]: 
[0m01:03:08.482152 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:03:08.482826 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m01:03:08.490245 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m01:03:08.490372 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m01:03:08.490472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:09.218805 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.73 seconds
[0m01:03:09.225285 [debug] [ThreadPool]: On list_materialize: Close
[0m01:03:09.227808 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m01:03:09.235150 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m01:03:09.235384 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m01:03:09.235533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:03:09.986366 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.75 seconds
[0m01:03:09.992528 [debug] [ThreadPool]: On list_materialize_public: Close
[0m01:03:09.993380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00d84f9d-643e-49d2-b3ea-8517f42c224f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c8626f20>]}
[0m01:03:09.993833 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:03:09.994091 [info ] [MainThread]: 
[0m01:03:10.000435 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m01:03:10.001099 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m01:03:10.001890 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m01:03:10.002081 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m01:03:10.002283 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m01:03:10.005816 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m01:03:10.006419 [debug] [Thread-1 (]: finished collecting timing info
[0m01:03:10.006614 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m01:03:10.023553 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:03:10.023900 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m01:03:10.024177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:10.808272 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.78 seconds
[0m01:03:10.820337 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m01:03:10.820915 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:03:10.821039 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

--
--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m01:03:11.256159 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.43 seconds
[0m01:03:11.272526 [debug] [Thread-1 (]: finished collecting timing info
[0m01:03:11.272868 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m01:03:11.273714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00d84f9d-643e-49d2-b3ea-8517f42c224f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c866ab30>]}
[0m01:03:11.274115 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.27s]
[0m01:03:11.274859 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m01:03:11.275350 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m01:03:11.275590 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m01:03:11.276200 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m01:03:11.276355 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m01:03:11.276630 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m01:03:11.280244 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m01:03:11.280871 [debug] [Thread-1 (]: finished collecting timing info
[0m01:03:11.281047 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m01:03:11.290630 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m01:03:11.291024 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m01:03:11.291152 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    data->>'timestamp' AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m01:03:11.291273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:11.932903 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "key" does not exist

[0m01:03:11.935392 [debug] [Thread-1 (]: finished collecting timing info
[0m01:03:11.935836 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m01:03:11.937650 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  column "key" does not exist
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m01:03:11.938299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00d84f9d-643e-49d2-b3ea-8517f42c224f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c8606aa0>]}
[0m01:03:11.938911 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 0.66s]
[0m01:03:11.939846 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m01:03:11.941560 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:03:11.942189 [info ] [MainThread]: 
[0m01:03:11.942482 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m01:03:11.942752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:11.942883 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m01:03:11.952511 [info ] [MainThread]: 
[0m01:03:11.952872 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:03:11.953157 [info ] [MainThread]: 
[0m01:03:11.953397 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m01:03:11.953630 [error] [MainThread]:   column "key" does not exist
[0m01:03:11.953855 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m01:03:11.954085 [info ] [MainThread]: 
[0m01:03:11.954322 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m01:03:11.954679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c868c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c868c700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c868c190>]}
[0m01:03:11.954939 [debug] [MainThread]: Flushing usage events


============================== 2022-12-06 01:03:54.584466 | 4286cd2c-3d41-4117-a77f-e5471c6dd277 ==============================
[0m01:03:54.584524 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:03:54.585969 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:03:54.586124 [debug] [MainThread]: Tracking: tracking
[0m01:03:54.614546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefea4d5660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefea4d5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefea4d5780>]}
[0m01:03:54.662415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:03:54.662771 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m01:03:54.673537 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m01:03:54.684098 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m01:03:54.697361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4286cd2c-3d41-4117-a77f-e5471c6dd277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefea5f00d0>]}
[0m01:03:54.702361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4286cd2c-3d41-4117-a77f-e5471c6dd277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd8697fd0>]}
[0m01:03:54.702553 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:03:54.702732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4286cd2c-3d41-4117-a77f-e5471c6dd277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd8681840>]}
[0m01:03:54.703661 [info ] [MainThread]: 
[0m01:03:54.704069 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:03:54.704765 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m01:03:54.712225 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m01:03:54.712420 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m01:03:54.712537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:55.632197 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.92 seconds
[0m01:03:55.637982 [debug] [ThreadPool]: On list_materialize: Close
[0m01:03:55.640717 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m01:03:55.648471 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m01:03:55.648712 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m01:03:55.648865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:03:56.305232 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.66 seconds
[0m01:03:56.306676 [debug] [ThreadPool]: On list_materialize_public: Close
[0m01:03:56.307767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4286cd2c-3d41-4117-a77f-e5471c6dd277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefea4d3130>]}
[0m01:03:56.308497 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:03:56.308763 [info ] [MainThread]: 
[0m01:03:56.314101 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m01:03:56.314489 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m01:03:56.315222 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m01:03:56.315495 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m01:03:56.315732 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m01:03:56.319693 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m01:03:56.320340 [debug] [Thread-1 (]: finished collecting timing info
[0m01:03:56.320544 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m01:03:56.338900 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:03:56.339195 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m01:03:56.339333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:57.115438 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.78 seconds
[0m01:03:57.128239 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m01:03:57.129735 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:03:57.129940 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

--
--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m01:03:57.197014 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected end of statement, found FORMAT
LINE 16:   FORMAT BYTES
           ^

[0m01:03:57.199484 [debug] [Thread-1 (]: finished collecting timing info
[0m01:03:57.200085 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m01:03:57.202158 [debug] [Thread-1 (]: Database Error in model src_driver_location (models/sources/src_driver_location.sql)
  Expected end of statement, found FORMAT
  LINE 16:   FORMAT BYTES
             ^
  compiled Code at target/run/onward_materialize/models/sources/src_driver_location.sql
[0m01:03:57.202655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4286cd2c-3d41-4117-a77f-e5471c6dd277', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefea611240>]}
[0m01:03:57.203219 [error] [Thread-1 (]: 1 of 2 ERROR creating sql source model public.src_driver_location .............. [[31mERROR[0m in 0.89s]
[0m01:03:57.204623 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m01:03:57.205619 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m01:03:57.205843 [info ] [Thread-1 (]: 2 of 2 SKIP relation public.json_driver_location ............................... [[33mSKIP[0m]
[0m01:03:57.206219 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m01:03:57.207357 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:03:57.207930 [info ] [MainThread]: 
[0m01:03:57.208197 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m01:03:57.208452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:57.208583 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m01:03:57.215932 [info ] [MainThread]: 
[0m01:03:57.216232 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:03:57.216503 [info ] [MainThread]: 
[0m01:03:57.216741 [error] [MainThread]: [33mDatabase Error in model src_driver_location (models/sources/src_driver_location.sql)[0m
[0m01:03:57.216977 [error] [MainThread]:   Expected end of statement, found FORMAT
[0m01:03:57.217197 [error] [MainThread]:   LINE 16:   FORMAT BYTES
[0m01:03:57.217414 [error] [MainThread]:              ^
[0m01:03:57.217628 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/sources/src_driver_location.sql
[0m01:03:57.217851 [info ] [MainThread]: 
[0m01:03:57.218080 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m01:03:57.218398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefea4d56f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd86977f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefea611600>]}
[0m01:03:57.218639 [debug] [MainThread]: Flushing usage events


============================== 2022-12-06 01:04:43.783402 | a9ddee21-42e8-4e1e-8d3c-17a1c068fa3d ==============================
[0m01:04:43.783463 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:04:43.784265 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:04:43.784401 [debug] [MainThread]: Tracking: tracking
[0m01:04:43.811419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d5ab1d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d5ab1dde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d5ab1c760>]}
[0m01:04:43.856510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:04:43.856833 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m01:04:43.866308 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m01:04:43.876585 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m01:04:43.889500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9ddee21-42e8-4e1e-8d3c-17a1c068fa3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d5ad380d0>]}
[0m01:04:43.894224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9ddee21-42e8-4e1e-8d3c-17a1c068fa3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d5ac717b0>]}
[0m01:04:43.894424 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:04:43.894591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9ddee21-42e8-4e1e-8d3c-17a1c068fa3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d5ac717e0>]}
[0m01:04:43.895401 [info ] [MainThread]: 
[0m01:04:43.895795 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:04:43.896492 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m01:04:43.903779 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m01:04:43.903941 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m01:04:43.904032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:44.893503 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.99 seconds
[0m01:04:44.898864 [debug] [ThreadPool]: On list_materialize: Close
[0m01:04:44.901755 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m01:04:44.910165 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m01:04:44.910408 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m01:04:44.910584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:45.957013 [debug] [ThreadPool]: SQL status: SELECT 0 in 1.05 seconds
[0m01:04:45.974038 [debug] [ThreadPool]: On list_materialize_public: Close
[0m01:04:45.976148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9ddee21-42e8-4e1e-8d3c-17a1c068fa3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d5ab19600>]}
[0m01:04:45.976864 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:04:45.977155 [info ] [MainThread]: 
[0m01:04:45.981939 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m01:04:45.982368 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m01:04:45.983266 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m01:04:45.983470 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m01:04:45.983649 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m01:04:45.987615 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m01:04:45.988655 [debug] [Thread-1 (]: finished collecting timing info
[0m01:04:45.988898 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m01:04:46.004633 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m01:04:46.005588 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:04:46.005737 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

--
--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
--  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m01:04:46.005870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:47.034651 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.03 seconds
[0m01:04:47.052160 [debug] [Thread-1 (]: finished collecting timing info
[0m01:04:47.052764 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m01:04:47.054166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9ddee21-42e8-4e1e-8d3c-17a1c068fa3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d5ad59510>]}
[0m01:04:47.054730 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.07s]
[0m01:04:47.056945 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m01:04:47.057771 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m01:04:47.058028 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m01:04:47.058688 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m01:04:47.058859 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m01:04:47.059024 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m01:04:47.062730 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m01:04:47.064279 [debug] [Thread-1 (]: finished collecting timing info
[0m01:04:47.064455 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m01:04:47.073747 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m01:04:47.074560 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m01:04:47.074689 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    data->>'timestamp' AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m01:04:47.074800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:47.717657 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "key" does not exist

[0m01:04:47.720789 [debug] [Thread-1 (]: finished collecting timing info
[0m01:04:47.721353 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m01:04:47.723301 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  column "key" does not exist
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m01:04:47.723910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9ddee21-42e8-4e1e-8d3c-17a1c068fa3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d5adc2140>]}
[0m01:04:47.724428 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 0.67s]
[0m01:04:47.724996 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m01:04:47.726541 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:04:47.727195 [info ] [MainThread]: 
[0m01:04:47.727526 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m01:04:47.727793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:47.727929 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m01:04:47.735185 [info ] [MainThread]: 
[0m01:04:47.735492 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:04:47.735760 [info ] [MainThread]: 
[0m01:04:47.736011 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m01:04:47.736245 [error] [MainThread]:   column "key" does not exist
[0m01:04:47.736477 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m01:04:47.736709 [info ] [MainThread]: 
[0m01:04:47.736943 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m01:04:47.737271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d5ad3b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d5ac87730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d5ad59840>]}
[0m01:04:47.737516 [debug] [MainThread]: Flushing usage events


============================== 2022-12-06 01:08:45.400355 | 9f407994-4b91-46fe-ab84-23b2d05e2717 ==============================
[0m01:08:45.400422 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:08:45.403019 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:08:45.403164 [debug] [MainThread]: Tracking: tracking
[0m01:08:45.433552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b02dfa8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b02dfb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b02dfaa10>]}
[0m01:08:45.480650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:08:45.480995 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m01:08:45.491534 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m01:08:45.501624 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m01:08:45.514563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f407994-4b91-46fe-ab84-23b2d05e2717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b02f140d0>]}
[0m01:08:45.519389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f407994-4b91-46fe-ab84-23b2d05e2717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae042c910>]}
[0m01:08:45.519598 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:08:45.519770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f407994-4b91-46fe-ab84-23b2d05e2717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae0449810>]}
[0m01:08:45.520625 [info ] [MainThread]: 
[0m01:08:45.521025 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:08:45.521730 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m01:08:45.529175 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m01:08:45.529384 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m01:08:45.529485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:46.698621 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.17 seconds
[0m01:08:46.704144 [debug] [ThreadPool]: On list_materialize: Close
[0m01:08:46.706893 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m01:08:46.714701 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m01:08:46.714903 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m01:08:46.715053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:08:48.012428 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.3 seconds
[0m01:08:48.017793 [debug] [ThreadPool]: On list_materialize_public: Close
[0m01:08:48.019338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f407994-4b91-46fe-ab84-23b2d05e2717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae045bee0>]}
[0m01:08:48.020177 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:08:48.020516 [info ] [MainThread]: 
[0m01:08:48.026401 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m01:08:48.026869 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m01:08:48.027663 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m01:08:48.027869 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m01:08:48.028081 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m01:08:48.032391 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m01:08:48.033180 [debug] [Thread-1 (]: finished collecting timing info
[0m01:08:48.033382 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m01:08:48.048803 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:08:48.049033 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m01:08:48.049166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:48.805055 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.76 seconds
[0m01:08:48.820446 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m01:08:48.821513 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:08:48.821691 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

--
CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

--
--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
----  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m01:08:49.252667 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.43 seconds
[0m01:08:49.269839 [debug] [Thread-1 (]: finished collecting timing info
[0m01:08:49.270178 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m01:08:49.271017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f407994-4b91-46fe-ab84-23b2d05e2717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b02f76440>]}
[0m01:08:49.271458 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.24s]
[0m01:08:49.272682 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m01:08:49.273508 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m01:08:49.273789 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m01:08:49.274276 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m01:08:49.274398 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m01:08:49.274513 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m01:08:49.277797 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m01:08:49.279089 [debug] [Thread-1 (]: finished collecting timing info
[0m01:08:49.279265 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m01:08:49.288656 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m01:08:49.289447 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m01:08:49.289577 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    data->>'timestamp' AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m01:08:49.289687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:49.937441 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "key" does not exist

[0m01:08:49.940299 [debug] [Thread-1 (]: finished collecting timing info
[0m01:08:49.940733 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m01:08:49.942582 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  column "key" does not exist
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m01:08:49.943211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f407994-4b91-46fe-ab84-23b2d05e2717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b02fb1ba0>]}
[0m01:08:49.943784 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 0.67s]
[0m01:08:49.944344 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m01:08:49.946109 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:08:49.946807 [info ] [MainThread]: 
[0m01:08:49.947105 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 4.43 seconds (4.43s).
[0m01:08:49.947371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:08:49.947502 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m01:08:49.957590 [info ] [MainThread]: 
[0m01:08:49.957939 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:08:49.958210 [info ] [MainThread]: 
[0m01:08:49.958444 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m01:08:49.958669 [error] [MainThread]:   column "key" does not exist
[0m01:08:49.958884 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m01:08:49.959116 [info ] [MainThread]: 
[0m01:08:49.959348 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m01:08:49.959696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b02f9c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b02f9f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b02f9f5e0>]}
[0m01:08:49.959951 [debug] [MainThread]: Flushing usage events


============================== 2022-12-06 01:09:42.764305 | f14e341c-df1b-484d-860f-d220fea13db7 ==============================
[0m01:09:42.764363 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:09:42.765065 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:09:42.765192 [debug] [MainThread]: Tracking: tracking
[0m01:09:42.792054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981a6a1d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981a6a2560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981a6a1ea0>]}
[0m01:09:42.839124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:09:42.839467 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m01:09:42.839641 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m01:09:42.849795 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m01:09:42.860297 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m01:09:42.861866 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m01:09:42.876328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f14e341c-df1b-484d-860f-d220fea13db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981a7b40a0>]}
[0m01:09:42.881388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f14e341c-df1b-484d-860f-d220fea13db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98084017e0>]}
[0m01:09:42.881661 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:09:42.881851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14e341c-df1b-484d-860f-d220fea13db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98084018a0>]}
[0m01:09:42.882851 [info ] [MainThread]: 
[0m01:09:42.883286 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:09:42.884002 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m01:09:42.891383 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m01:09:42.891527 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m01:09:42.891616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:44.034334 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.14 seconds
[0m01:09:44.045366 [debug] [ThreadPool]: On list_materialize: Close
[0m01:09:44.048019 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m01:09:44.056998 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m01:09:44.057228 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m01:09:44.057381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:44.922959 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.87 seconds
[0m01:09:44.927720 [debug] [ThreadPool]: On list_materialize_public: Close
[0m01:09:44.929508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14e341c-df1b-484d-860f-d220fea13db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981a699870>]}
[0m01:09:44.930409 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:09:44.930749 [info ] [MainThread]: 
[0m01:09:44.937545 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m01:09:44.937936 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m01:09:44.938495 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m01:09:44.938637 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m01:09:44.938790 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m01:09:44.942529 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m01:09:44.943483 [debug] [Thread-1 (]: finished collecting timing info
[0m01:09:44.943714 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m01:09:44.959861 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:09:44.960131 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m01:09:44.960268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:45.807387 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.85 seconds
[0m01:09:45.821323 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m01:09:45.822261 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:09:45.822438 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

--
--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');

--
  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
--  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m01:09:46.330738 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.51 seconds
[0m01:09:46.348065 [debug] [Thread-1 (]: finished collecting timing info
[0m01:09:46.348514 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m01:09:46.349663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14e341c-df1b-484d-860f-d220fea13db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981a81e680>]}
[0m01:09:46.350176 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.41s]
[0m01:09:46.351133 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m01:09:46.352025 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m01:09:46.352424 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m01:09:46.353064 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m01:09:46.353233 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m01:09:46.353402 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m01:09:46.357156 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m01:09:46.360000 [debug] [Thread-1 (]: finished collecting timing info
[0m01:09:46.360182 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m01:09:46.369582 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m01:09:46.370417 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m01:09:46.370549 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    key,
    data->>'uid' AS uid,
    data->>'timestamp' AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(key, 'utf8') as key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m01:09:46.370659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:47.040572 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "key" does not exist

[0m01:09:47.042990 [debug] [Thread-1 (]: finished collecting timing info
[0m01:09:47.043422 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m01:09:47.045214 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  column "key" does not exist
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m01:09:47.045826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14e341c-df1b-484d-860f-d220fea13db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981a7e1540>]}
[0m01:09:47.046389 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 0.69s]
[0m01:09:47.046981 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m01:09:47.048612 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:09:47.049285 [info ] [MainThread]: 
[0m01:09:47.049581 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m01:09:47.049880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:09:47.050017 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m01:09:47.060260 [info ] [MainThread]: 
[0m01:09:47.060606 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:09:47.060881 [info ] [MainThread]: 
[0m01:09:47.061122 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m01:09:47.061359 [error] [MainThread]:   column "key" does not exist
[0m01:09:47.061583 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m01:09:47.061815 [info ] [MainThread]: 
[0m01:09:47.062060 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m01:09:47.062444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981a84f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981a84d1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981a84e4d0>]}
[0m01:09:47.062704 [debug] [MainThread]: Flushing usage events


============================== 2022-12-06 01:10:20.597522 | a727f202-0776-48ac-939d-51961a3b9f1d ==============================
[0m01:10:20.597597 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:10:20.598306 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:10:20.598436 [debug] [MainThread]: Tracking: tracking
[0m01:10:20.634587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcac84d14b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcac84d35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcac84d0940>]}
[0m01:10:20.678978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:10:20.679153 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:10:20.683920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a727f202-0776-48ac-939d-51961a3b9f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeaad80d0>]}
[0m01:10:20.689224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a727f202-0776-48ac-939d-51961a3b9f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeaaa8b80>]}
[0m01:10:20.689418 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:10:20.689583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a727f202-0776-48ac-939d-51961a3b9f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeaaa8c10>]}
[0m01:10:20.690447 [info ] [MainThread]: 
[0m01:10:20.690845 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:10:20.691595 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m01:10:20.699211 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m01:10:20.699331 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m01:10:20.699419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:21.472218 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.77 seconds
[0m01:10:21.478742 [debug] [ThreadPool]: On list_materialize: Close
[0m01:10:21.481318 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m01:10:21.489430 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m01:10:21.489644 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m01:10:21.489797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:22.258518 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.77 seconds
[0m01:10:22.263803 [debug] [ThreadPool]: On list_materialize_public: Close
[0m01:10:22.266026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a727f202-0776-48ac-939d-51961a3b9f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeaaa8880>]}
[0m01:10:22.266982 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:10:22.267308 [info ] [MainThread]: 
[0m01:10:22.273568 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m01:10:22.274276 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m01:10:22.275024 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m01:10:22.275206 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m01:10:22.275417 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m01:10:22.279744 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m01:10:22.280404 [debug] [Thread-1 (]: finished collecting timing info
[0m01:10:22.280590 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m01:10:22.296241 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:10:22.296502 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m01:10:22.296638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:23.152386 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.86 seconds
[0m01:10:23.168388 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m01:10:23.169440 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:10:23.169617 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

--
--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');

--
  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
--  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m01:10:23.662716 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.49 seconds
[0m01:10:23.682126 [debug] [Thread-1 (]: finished collecting timing info
[0m01:10:23.682530 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m01:10:23.683746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a727f202-0776-48ac-939d-51961a3b9f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeaaa8880>]}
[0m01:10:23.684246 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.41s]
[0m01:10:23.685675 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m01:10:23.686529 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m01:10:23.686778 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m01:10:23.687404 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m01:10:23.687560 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m01:10:23.687715 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m01:10:23.691455 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m01:10:23.692220 [debug] [Thread-1 (]: finished collecting timing info
[0m01:10:23.692396 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m01:10:23.702949 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m01:10:23.703378 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m01:10:23.703519 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    key,
    data->>'uid' AS uid,
    data->>'timestamp' AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(key, 'utf8') as key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m01:10:23.703630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:24.344947 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "key" does not exist

[0m01:10:24.347732 [debug] [Thread-1 (]: finished collecting timing info
[0m01:10:24.348163 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m01:10:24.350273 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  column "key" does not exist
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m01:10:24.350866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a727f202-0776-48ac-939d-51961a3b9f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeaab8a90>]}
[0m01:10:24.351408 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 0.66s]
[0m01:10:24.352020 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m01:10:24.353305 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:10:24.353774 [info ] [MainThread]: 
[0m01:10:24.354051 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 3.66 seconds (3.66s).
[0m01:10:24.354314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:10:24.354441 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m01:10:24.364038 [info ] [MainThread]: 
[0m01:10:24.364349 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:10:24.364611 [info ] [MainThread]: 
[0m01:10:24.364853 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m01:10:24.365084 [error] [MainThread]:   column "key" does not exist
[0m01:10:24.365306 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m01:10:24.365532 [info ] [MainThread]: 
[0m01:10:24.365767 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m01:10:24.366083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeaaa8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeaaa88b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeaab8e20>]}
[0m01:10:24.366316 [debug] [MainThread]: Flushing usage events


============================== 2022-12-06 01:11:02.629088 | 92f585ce-08b3-4285-8c3d-86507512be2d ==============================
[0m01:11:02.629144 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:11:02.629882 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:11:02.630007 [debug] [MainThread]: Tracking: tracking
[0m01:11:02.663397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86283fa8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86283fb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86283faa10>]}
[0m01:11:02.709202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:11:02.709545 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m01:11:02.719373 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m01:11:02.729553 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m01:11:02.742428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92f585ce-08b3-4285-8c3d-86507512be2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864aaec0d0>]}
[0m01:11:02.747466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92f585ce-08b3-4285-8c3d-86507512be2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864aa37fd0>]}
[0m01:11:02.747671 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:11:02.747843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92f585ce-08b3-4285-8c3d-86507512be2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864aa21840>]}
[0m01:11:02.748683 [info ] [MainThread]: 
[0m01:11:02.749070 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:11:02.749762 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m01:11:02.757000 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m01:11:02.757127 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m01:11:02.757215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:03.470145 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.71 seconds
[0m01:11:03.475289 [debug] [ThreadPool]: On list_materialize: Close
[0m01:11:03.477739 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m01:11:03.485255 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m01:11:03.485500 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m01:11:03.485661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:11:04.149585 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.66 seconds
[0m01:11:04.155286 [debug] [ThreadPool]: On list_materialize_public: Close
[0m01:11:04.157125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92f585ce-08b3-4285-8c3d-86507512be2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86283f17e0>]}
[0m01:11:04.157981 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:11:04.158301 [info ] [MainThread]: 
[0m01:11:04.164430 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m01:11:04.164887 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m01:11:04.165767 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m01:11:04.166036 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m01:11:04.166629 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m01:11:04.171796 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m01:11:04.172465 [debug] [Thread-1 (]: finished collecting timing info
[0m01:11:04.172664 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m01:11:04.189656 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:11:04.189908 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m01:11:04.190032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:05.038304 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.85 seconds
[0m01:11:05.053045 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m01:11:05.054008 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:11:05.054176 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

--
CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

--
--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
----  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m01:11:05.456353 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.4 seconds
[0m01:11:05.474140 [debug] [Thread-1 (]: finished collecting timing info
[0m01:11:05.474572 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m01:11:05.475600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92f585ce-08b3-4285-8c3d-86507512be2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864ab4e470>]}
[0m01:11:05.476095 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.31s]
[0m01:11:05.478228 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m01:11:05.479079 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m01:11:05.479337 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m01:11:05.479957 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m01:11:05.480120 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m01:11:05.480273 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m01:11:05.483785 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m01:11:05.485194 [debug] [Thread-1 (]: finished collecting timing info
[0m01:11:05.485334 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m01:11:05.493442 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m01:11:05.494431 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m01:11:05.494544 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    key,
    data->>'uid' AS uid,
    data->>'timestamp' AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(key, 'utf8') as key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m01:11:05.494642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:06.283349 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.79 seconds
[0m01:11:06.291644 [debug] [Thread-1 (]: finished collecting timing info
[0m01:11:06.292052 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m01:11:06.293222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92f585ce-08b3-4285-8c3d-86507512be2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864ab94a00>]}
[0m01:11:06.293736 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 0.81s]
[0m01:11:06.294182 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m01:11:06.295565 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:11:06.296209 [info ] [MainThread]: 
[0m01:11:06.296499 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m01:11:06.296769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:06.296901 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m01:11:06.307430 [info ] [MainThread]: 
[0m01:11:06.307760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:11:06.308052 [info ] [MainThread]: 
[0m01:11:06.308304 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:11:06.308682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864ab8e0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864ab8f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864ab8d9c0>]}
[0m01:11:06.308951 [debug] [MainThread]: Flushing usage events


============================== 2022-12-06 01:12:03.801656 | abcbb228-7749-4ac2-a40e-2ab31cab2c57 ==============================
[0m01:12:03.801711 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:12:03.802312 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:12:03.802424 [debug] [MainThread]: Tracking: tracking
[0m01:12:03.831791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9992749d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f999274a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9992749ea0>]}
[0m01:12:03.882869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:12:03.883230 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m01:12:03.894423 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m01:12:03.917215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abcbb228-7749-4ac2-a40e-2ab31cab2c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99703a00d0>]}
[0m01:12:03.922580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abcbb228-7749-4ac2-a40e-2ab31cab2c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99928affa0>]}
[0m01:12:03.922789 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:12:03.922969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abcbb228-7749-4ac2-a40e-2ab31cab2c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9992899750>]}
[0m01:12:03.923928 [info ] [MainThread]: 
[0m01:12:03.924353 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:12:03.925106 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m01:12:03.932939 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m01:12:03.933136 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m01:12:03.933231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:12:04.814858 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.88 seconds
[0m01:12:04.821590 [debug] [ThreadPool]: On list_materialize: Close
[0m01:12:04.824178 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m01:12:04.831888 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m01:12:04.832234 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m01:12:04.832393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:12:05.935609 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.1 seconds
[0m01:12:05.938869 [debug] [ThreadPool]: On list_materialize_public: Close
[0m01:12:05.940335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abcbb228-7749-4ac2-a40e-2ab31cab2c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99703dafb0>]}
[0m01:12:05.941168 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:12:05.941505 [info ] [MainThread]: 
[0m01:12:05.948037 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m01:12:05.948699 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m01:12:05.949451 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m01:12:05.949648 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m01:12:05.949848 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m01:12:05.953931 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m01:12:05.954665 [debug] [Thread-1 (]: finished collecting timing info
[0m01:12:05.954851 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m01:12:05.970742 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:12:05.971032 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m01:12:05.971166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:06.750371 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.78 seconds
[0m01:12:06.760061 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m01:12:06.760663 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:12:06.760825 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

--
CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

--
--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
----  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m01:12:07.202474 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.44 seconds
[0m01:12:07.219306 [debug] [Thread-1 (]: finished collecting timing info
[0m01:12:07.219633 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m01:12:07.220429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abcbb228-7749-4ac2-a40e-2ab31cab2c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99703dafb0>]}
[0m01:12:07.220836 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.27s]
[0m01:12:07.222676 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m01:12:07.223306 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m01:12:07.223601 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m01:12:07.224289 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m01:12:07.224457 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m01:12:07.224611 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m01:12:07.227956 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m01:12:07.228917 [debug] [Thread-1 (]: finished collecting timing info
[0m01:12:07.229044 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m01:12:07.239288 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m01:12:07.239489 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m01:12:07.239604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:07.936980 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.7 seconds
[0m01:12:07.941074 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m01:12:07.943411 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m01:12:07.943567 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    key,
    data->>'uid' AS uid,
    to_timestamp(data->>'timestamp') AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(key, 'utf8') as key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m01:12:08.011107 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Cannot call function to_timestamp(text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

[0m01:12:08.014550 [debug] [Thread-1 (]: finished collecting timing info
[0m01:12:08.014989 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m01:12:08.016189 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Cannot call function to_timestamp(text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m01:12:08.016780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abcbb228-7749-4ac2-a40e-2ab31cab2c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99704650f0>]}
[0m01:12:08.018087 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 0.79s]
[0m01:12:08.018974 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m01:12:08.020756 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:12:08.021464 [info ] [MainThread]: 
[0m01:12:08.021764 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 4.10 seconds (4.10s).
[0m01:12:08.022025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:12:08.022153 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m01:12:08.032539 [info ] [MainThread]: 
[0m01:12:08.032894 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:12:08.033185 [info ] [MainThread]: 
[0m01:12:08.033429 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m01:12:08.033671 [error] [MainThread]:   Cannot call function to_timestamp(text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
[0m01:12:08.033895 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m01:12:08.034127 [info ] [MainThread]: 
[0m01:12:08.034366 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m01:12:08.034749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f997043c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f997043e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f997043e230>]}
[0m01:12:08.035035 [debug] [MainThread]: Flushing usage events


============================== 2022-12-06 01:13:04.701606 | 6705ffdf-8469-4256-88e8-dc43e253647e ==============================
[0m01:13:04.701651 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:13:04.702396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:13:04.702536 [debug] [MainThread]: Tracking: tracking
[0m01:13:04.736614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83a541de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83a542560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83a5406a0>]}
[0m01:13:04.782825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:13:04.783173 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m01:13:04.794408 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m01:13:04.816546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6705ffdf-8469-4256-88e8-dc43e253647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83a69c0d0>]}
[0m01:13:04.821358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6705ffdf-8469-4256-88e8-dc43e253647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd818307ee0>]}
[0m01:13:04.821556 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:13:04.821728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6705ffdf-8469-4256-88e8-dc43e253647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8182f16f0>]}
[0m01:13:04.822597 [info ] [MainThread]: 
[0m01:13:04.823014 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:13:04.823691 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m01:13:04.830897 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m01:13:04.831047 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m01:13:04.831138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:13:05.831821 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m01:13:05.837555 [debug] [ThreadPool]: On list_materialize: Close
[0m01:13:05.839947 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m01:13:05.847876 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m01:13:05.848179 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m01:13:05.848332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:13:06.915329 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.07 seconds
[0m01:13:06.920926 [debug] [ThreadPool]: On list_materialize_public: Close
[0m01:13:06.922550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6705ffdf-8469-4256-88e8-dc43e253647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83a6caec0>]}
[0m01:13:06.923384 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:13:06.923701 [info ] [MainThread]: 
[0m01:13:06.928555 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m01:13:06.929205 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m01:13:06.930053 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m01:13:06.930315 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m01:13:06.930537 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m01:13:06.934685 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m01:13:06.935475 [debug] [Thread-1 (]: finished collecting timing info
[0m01:13:06.935682 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m01:13:06.951110 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:13:06.951359 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m01:13:06.951489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:07.933668 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.98 seconds
[0m01:13:07.948343 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m01:13:07.949164 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:13:07.949291 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

--
CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

--
--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
----  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m01:13:08.377146 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.43 seconds
[0m01:13:08.393818 [debug] [Thread-1 (]: finished collecting timing info
[0m01:13:08.394255 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m01:13:08.395286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6705ffdf-8469-4256-88e8-dc43e253647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8182d48e0>]}
[0m01:13:08.395773 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.47s]
[0m01:13:08.397256 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m01:13:08.398392 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m01:13:08.398761 [info ] [Thread-1 (]: 2 of 2 START sql view model public.json_driver_location ........................ [RUN]
[0m01:13:08.399463 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m01:13:08.399631 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m01:13:08.399793 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m01:13:08.403436 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m01:13:08.404877 [debug] [Thread-1 (]: finished collecting timing info
[0m01:13:08.405071 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m01:13:08.414645 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m01:13:08.415584 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m01:13:08.415755 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    key,
    data->>'uid' AS uid,
    cast(data->>'timestamp' as timestamp) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(key, 'utf8') as key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m01:13:08.415868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:09.169068 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.75 seconds
[0m01:13:09.175415 [debug] [Thread-1 (]: finished collecting timing info
[0m01:13:09.175830 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m01:13:09.176815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6705ffdf-8469-4256-88e8-dc43e253647e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83a754f40>]}
[0m01:13:09.177281 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 0.78s]
[0m01:13:09.177768 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m01:13:09.179203 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:13:09.179817 [info ] [MainThread]: 
[0m01:13:09.180111 [info ] [MainThread]: Finished running 1 source model, 1 view model in 0 hours 0 minutes and 4.36 seconds (4.36s).
[0m01:13:09.180405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:13:09.180538 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m01:13:09.191899 [info ] [MainThread]: 
[0m01:13:09.192196 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:13:09.192415 [info ] [MainThread]: 
[0m01:13:09.192594 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:13:09.192849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83a72ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83a72ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83a72c9d0>]}
[0m01:13:09.193049 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 01:05:55.162708 | 0fc7446f-8a04-47d8-a544-67fd4d57bc97 ==============================
[0m01:05:55.162779 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:05:55.163713 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:05:55.163857 [debug] [MainThread]: Tracking: tracking
[0m01:05:55.199512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a29a980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a29b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a2995a0>]}
[0m01:05:55.249240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m01:05:55.249529 [debug] [MainThread]: Partial parsing: added file: onward_materialize://models/materializedviews/staging/staging_json_driver_location.sql
[0m01:05:55.249669 [debug] [MainThread]: Partial parsing: added file: onward_materialize://models/sources/staging/staging_src_driver_location.sql
[0m01:05:55.249832 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m01:05:55.262024 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/staging/staging_json_driver_location.sql
[0m01:05:55.272456 [debug] [MainThread]: 1603: static parser failed on sources/staging/staging_src_driver_location.sql
[0m01:05:55.275529 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/staging/staging_src_driver_location.sql
[0m01:05:55.276418 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m01:05:55.279137 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m01:05:55.293628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fc7446f-8a04-47d8-a544-67fd4d57bc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a4c80d0>]}
[0m01:05:55.299018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fc7446f-8a04-47d8-a544-67fd4d57bc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a3cc730>]}
[0m01:05:55.299229 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:05:55.299403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fc7446f-8a04-47d8-a544-67fd4d57bc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a3e97b0>]}
[0m01:05:55.300432 [info ] [MainThread]: 
[0m01:05:55.300849 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:05:55.301598 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m01:05:55.309309 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m01:05:55.309448 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m01:05:55.309534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:05:56.656430 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.35 seconds
[0m01:05:56.663953 [debug] [ThreadPool]: On list_materialize: Close
[0m01:05:56.667008 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m01:05:56.674267 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m01:05:56.674489 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m01:05:56.674636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:05:57.900611 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.23 seconds
[0m01:05:57.904985 [debug] [ThreadPool]: On list_materialize_public: Close
[0m01:05:57.906224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fc7446f-8a04-47d8-a544-67fd4d57bc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a4c9930>]}
[0m01:05:57.907180 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:05:57.907729 [info ] [MainThread]: 
[0m01:05:57.912230 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m01:05:57.912545 [info ] [Thread-1 (]: 1 of 4 START sql source model public.src_driver_location ....................... [RUN]
[0m01:05:57.913345 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m01:05:57.913549 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m01:05:57.913731 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m01:05:57.917405 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m01:05:57.918133 [debug] [Thread-1 (]: finished collecting timing info
[0m01:05:57.918403 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m01:05:57.934710 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:05:57.935019 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m01:05:57.935152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:58.743976 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.81 seconds
[0m01:05:58.758217 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m01:05:58.759688 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m01:05:58.759873 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

--
--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
----  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m01:05:59.171017 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.41 seconds
[0m01:05:59.204632 [debug] [Thread-1 (]: finished collecting timing info
[0m01:05:59.205037 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m01:05:59.205839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc7446f-8a04-47d8-a544-67fd4d57bc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a50f370>]}
[0m01:05:59.206233 [info ] [Thread-1 (]: 1 of 4 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.29s]
[0m01:05:59.207354 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m01:05:59.207566 [debug] [Thread-1 (]: Began running node model.onward_materialize.staging_src_driver_location
[0m01:05:59.207911 [info ] [Thread-1 (]: 2 of 4 START sql source model public.staging_src_driver_location ............... [RUN]
[0m01:05:59.208710 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.staging_src_driver_location"
[0m01:05:59.208944 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.staging_src_driver_location
[0m01:05:59.209120 [debug] [Thread-1 (]: Compiling model.onward_materialize.staging_src_driver_location
[0m01:05:59.212599 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.staging_src_driver_location"
[0m01:05:59.213214 [debug] [Thread-1 (]: finished collecting timing info
[0m01:05:59.213382 [debug] [Thread-1 (]: Began executing node model.onward_materialize.staging_src_driver_location
[0m01:05:59.215408 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.staging_src_driver_location"
[0m01:05:59.215800 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_src_driver_location"
[0m01:05:59.215905 [debug] [Thread-1 (]: On model.onward_materialize.staging_src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."staging_src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'staging_driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

--
--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."staging_src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
----  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m01:05:59.216005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:00.381718 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.17 seconds
[0m01:06:00.388573 [debug] [Thread-1 (]: finished collecting timing info
[0m01:06:00.388990 [debug] [Thread-1 (]: On model.onward_materialize.staging_src_driver_location: Close
[0m01:06:00.390230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc7446f-8a04-47d8-a544-67fd4d57bc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a4db400>]}
[0m01:06:00.390758 [info ] [Thread-1 (]: 2 of 4 OK created sql source model public.staging_src_driver_location .......... [[32mCREATE SOURCE[0m in 1.18s]
[0m01:06:00.391255 [debug] [Thread-1 (]: Finished running node model.onward_materialize.staging_src_driver_location
[0m01:06:00.391466 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m01:06:00.391678 [info ] [Thread-1 (]: 3 of 4 START sql view model public.json_driver_location ........................ [RUN]
[0m01:06:00.392754 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m01:06:00.393044 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m01:06:00.393263 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m01:06:00.399390 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m01:06:00.401162 [debug] [Thread-1 (]: finished collecting timing info
[0m01:06:00.401369 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m01:06:00.412566 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m01:06:00.412771 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m01:06:00.412915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:01.057376 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.64 seconds
[0m01:06:01.068038 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m01:06:01.068940 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m01:06:01.069138 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    key,
    data->>'uid' AS uid,
    cast(data->>'timestamp' as timestamp) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(key, 'utf8') as key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m01:06:01.243366 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.17 seconds
[0m01:06:01.249213 [debug] [Thread-1 (]: finished collecting timing info
[0m01:06:01.249610 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m01:06:01.250887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc7446f-8a04-47d8-a544-67fd4d57bc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a558e50>]}
[0m01:06:01.251439 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 0.86s]
[0m01:06:01.252042 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m01:06:01.252280 [debug] [Thread-1 (]: Began running node model.onward_materialize.staging_json_driver_location
[0m01:06:01.252630 [info ] [Thread-1 (]: 4 of 4 START sql view model public.staging_json_driver_location ................ [RUN]
[0m01:06:01.253329 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.staging_json_driver_location"
[0m01:06:01.253505 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.staging_json_driver_location
[0m01:06:01.253673 [debug] [Thread-1 (]: Compiling model.onward_materialize.staging_json_driver_location
[0m01:06:01.257915 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.staging_json_driver_location"
[0m01:06:01.258629 [debug] [Thread-1 (]: finished collecting timing info
[0m01:06:01.258761 [debug] [Thread-1 (]: Began executing node model.onward_materialize.staging_json_driver_location
[0m01:06:01.261077 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.staging_json_driver_location"
[0m01:06:01.261621 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_json_driver_location"
[0m01:06:01.261775 [debug] [Thread-1 (]: On model.onward_materialize.staging_json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_json_driver_location"} */
create view "materialize"."public"."staging_json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    key,
    data->>'uid' AS uid,
    cast(data->>'timestamp' as timestamp) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(key, 'utf8') as key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."staging_src_driver_location")
  where data->>'routeKey' is not null
  );
[0m01:06:01.261912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:02.100263 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.84 seconds
[0m01:06:02.101963 [debug] [Thread-1 (]: finished collecting timing info
[0m01:06:02.102161 [debug] [Thread-1 (]: On model.onward_materialize.staging_json_driver_location: Close
[0m01:06:02.102722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc7446f-8a04-47d8-a544-67fd4d57bc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a555300>]}
[0m01:06:02.102965 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.staging_json_driver_location ........... [[32mCREATE VIEW[0m in 0.85s]
[0m01:06:02.103218 [debug] [Thread-1 (]: Finished running node model.onward_materialize.staging_json_driver_location
[0m01:06:02.104611 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m01:06:02.105251 [info ] [MainThread]: 
[0m01:06:02.105483 [info ] [MainThread]: Finished running 2 source models, 2 view models in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m01:06:02.105634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:02.105708 [debug] [MainThread]: Connection 'model.onward_materialize.staging_json_driver_location' was properly closed.
[0m01:06:02.112187 [info ] [MainThread]: 
[0m01:06:02.112453 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:06:02.112780 [info ] [MainThread]: 
[0m01:06:02.112984 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:06:02.113233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a558e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a3ffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a4dada0>]}
[0m01:06:02.113416 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 17:49:56.112808 | 78476399-f703-4203-b485-5dcc78c3d8fd ==============================
[0m17:49:56.112878 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:49:56.115885 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:49:56.116056 [debug] [MainThread]: Tracking: tracking
[0m17:49:56.151102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a24529e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a2453070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a2450e20>]}
[0m17:49:56.199465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:49:56.199835 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m17:49:56.211621 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m17:49:56.234035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78476399-f703-4203-b485-5dcc78c3d8fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6b09e00d0>]}
[0m17:49:56.239302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78476399-f703-4203-b485-5dcc78c3d8fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a0af92d0>]}
[0m17:49:56.239515 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:49:56.239688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78476399-f703-4203-b485-5dcc78c3d8fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a25a5ab0>]}
[0m17:49:56.240619 [info ] [MainThread]: 
[0m17:49:56.241018 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:49:56.241774 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m17:49:56.249092 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m17:49:56.249244 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m17:49:56.249342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:57.100706 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.85 seconds
[0m17:49:57.113397 [debug] [ThreadPool]: On list_materialize: Close
[0m17:49:57.114830 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m17:49:57.119467 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m17:49:57.119629 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m17:49:57.119719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:57.980038 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.86 seconds
[0m17:49:57.987943 [debug] [ThreadPool]: On list_materialize_public: Close
[0m17:49:57.989756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78476399-f703-4203-b485-5dcc78c3d8fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a25b7e50>]}
[0m17:49:57.990577 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m17:49:57.990889 [info ] [MainThread]: 
[0m17:49:57.997181 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m17:49:57.997858 [info ] [Thread-1 (]: 1 of 4 START sql source model public.src_driver_location ....................... [RUN]
[0m17:49:57.998415 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m17:49:57.998568 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m17:49:57.998731 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m17:49:58.002551 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m17:49:58.003553 [debug] [Thread-1 (]: finished collecting timing info
[0m17:49:58.003743 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m17:49:58.018610 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m17:49:58.018829 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m17:49:58.018951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:58.766442 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.75 seconds
[0m17:49:58.779923 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m17:49:58.780805 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m17:49:58.780983 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

--
--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
----  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m17:49:59.287517 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.51 seconds
[0m17:49:59.306208 [debug] [Thread-1 (]: finished collecting timing info
[0m17:49:59.306663 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m17:49:59.307982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78476399-f703-4203-b485-5dcc78c3d8fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a25b7e50>]}
[0m17:49:59.308506 [info ] [Thread-1 (]: 1 of 4 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.31s]
[0m17:49:59.309563 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m17:49:59.309900 [debug] [Thread-1 (]: Began running node model.onward_materialize.staging_src_driver_location
[0m17:49:59.310334 [info ] [Thread-1 (]: 2 of 4 START sql source model public.staging_src_driver_location ............... [RUN]
[0m17:49:59.311159 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.staging_src_driver_location"
[0m17:49:59.311382 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.staging_src_driver_location
[0m17:49:59.311556 [debug] [Thread-1 (]: Compiling model.onward_materialize.staging_src_driver_location
[0m17:49:59.315313 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.staging_src_driver_location"
[0m17:49:59.316888 [debug] [Thread-1 (]: finished collecting timing info
[0m17:49:59.317115 [debug] [Thread-1 (]: Began executing node model.onward_materialize.staging_src_driver_location
[0m17:49:59.321061 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_src_driver_location"
[0m17:49:59.321240 [debug] [Thread-1 (]: On model.onward_materialize.staging_src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_src_driver_location"} */

      drop source if exists "materialize"."public"."staging_src_driver_location" cascade
    
[0m17:49:59.321374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:00.294636 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.97 seconds
[0m17:50:00.300989 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.staging_src_driver_location"
[0m17:50:00.303105 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_src_driver_location"
[0m17:50:00.303378 [debug] [Thread-1 (]: On model.onward_materialize.staging_src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."staging_src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'staging_driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

--
--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."staging_src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
----  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m17:50:00.927651 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.62 seconds
[0m17:50:00.933158 [debug] [Thread-1 (]: finished collecting timing info
[0m17:50:00.933566 [debug] [Thread-1 (]: On model.onward_materialize.staging_src_driver_location: Close
[0m17:50:00.934537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78476399-f703-4203-b485-5dcc78c3d8fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6b09e3ac0>]}
[0m17:50:00.934967 [info ] [Thread-1 (]: 2 of 4 OK created sql source model public.staging_src_driver_location .......... [[32mCREATE SOURCE[0m in 1.62s]
[0m17:50:00.935429 [debug] [Thread-1 (]: Finished running node model.onward_materialize.staging_src_driver_location
[0m17:50:00.935636 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m17:50:00.935999 [info ] [Thread-1 (]: 3 of 4 START sql view model public.json_driver_location ........................ [RUN]
[0m17:50:00.936748 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m17:50:00.936903 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m17:50:00.937083 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m17:50:00.940836 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m17:50:00.942218 [debug] [Thread-1 (]: finished collecting timing info
[0m17:50:00.942405 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m17:50:00.954805 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m17:50:00.955086 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m17:50:00.955248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:01.684077 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.73 seconds
[0m17:50:01.691020 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m17:50:01.693881 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m17:50:01.694096 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    key,
    data->>'uid' AS uid,
    data->>'timestamp' as timestamp, -- AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(key, 'utf8') as key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m17:50:01.913811 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.22 seconds
[0m17:50:01.919180 [debug] [Thread-1 (]: finished collecting timing info
[0m17:50:01.919432 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m17:50:01.920178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78476399-f703-4203-b485-5dcc78c3d8fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6b0a7c100>]}
[0m17:50:01.920577 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 0.98s]
[0m17:50:01.921032 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m17:50:01.921242 [debug] [Thread-1 (]: Began running node model.onward_materialize.staging_json_driver_location
[0m17:50:01.921456 [info ] [Thread-1 (]: 4 of 4 START sql view model public.staging_json_driver_location ................ [RUN]
[0m17:50:01.922212 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.staging_json_driver_location"
[0m17:50:01.922396 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.staging_json_driver_location
[0m17:50:01.922559 [debug] [Thread-1 (]: Compiling model.onward_materialize.staging_json_driver_location
[0m17:50:01.926289 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.staging_json_driver_location"
[0m17:50:01.926801 [debug] [Thread-1 (]: finished collecting timing info
[0m17:50:01.926968 [debug] [Thread-1 (]: Began executing node model.onward_materialize.staging_json_driver_location
[0m17:50:01.931102 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_json_driver_location"
[0m17:50:01.931274 [debug] [Thread-1 (]: On model.onward_materialize.staging_json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_json_driver_location"} */

      drop view if exists "materialize"."public"."staging_json_driver_location" cascade
    
[0m17:50:01.931422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:02.680878 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.75 seconds
[0m17:50:02.686734 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.staging_json_driver_location"
[0m17:50:02.688926 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_json_driver_location"
[0m17:50:02.689206 [debug] [Thread-1 (]: On model.onward_materialize.staging_json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_json_driver_location"} */
create view "materialize"."public"."staging_json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    key,
    data->>'uid' AS uid,
    cast(data->>'timestamp' as timestamp) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(key, 'utf8') as key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."staging_src_driver_location")
  where data->>'routeKey' is not null
  );
[0m17:50:02.904124 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.21 seconds
[0m17:50:02.910372 [debug] [Thread-1 (]: finished collecting timing info
[0m17:50:02.910666 [debug] [Thread-1 (]: On model.onward_materialize.staging_json_driver_location: Close
[0m17:50:02.911514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78476399-f703-4203-b485-5dcc78c3d8fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6902c66e0>]}
[0m17:50:02.911886 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.staging_json_driver_location ........... [[32mCREATE VIEW[0m in 0.99s]
[0m17:50:02.912356 [debug] [Thread-1 (]: Finished running node model.onward_materialize.staging_json_driver_location
[0m17:50:02.913675 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:50:02.914257 [info ] [MainThread]: 
[0m17:50:02.914529 [info ] [MainThread]: Finished running 2 source models, 2 view models in 0 hours 0 minutes and 6.67 seconds (6.67s).
[0m17:50:02.914796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:02.914931 [debug] [MainThread]: Connection 'model.onward_materialize.staging_json_driver_location' was properly closed.
[0m17:50:02.924540 [info ] [MainThread]: 
[0m17:50:02.924973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:02.925358 [info ] [MainThread]: 
[0m17:50:02.925690 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:50:02.926025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a25b7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a25b7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6b09f2b30>]}
[0m17:50:02.926225 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 17:52:39.756357 | 9b3c1fbf-14c1-475c-a5f1-d6598449a35c ==============================
[0m17:52:39.756397 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:52:39.757088 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:52:39.757216 [debug] [MainThread]: Tracking: tracking
[0m17:52:39.794605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8892c1a8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8892c1b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8892c1aa10>]}
[0m17:52:39.841973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:52:39.842307 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m17:52:39.852150 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m17:52:39.862363 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m17:52:39.875176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b3c1fbf-14c1-475c-a5f1-d6598449a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8892d3c0d0>]}
[0m17:52:39.880808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b3c1fbf-14c1-475c-a5f1-d6598449a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88802bc940>]}
[0m17:52:39.881016 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:52:39.881192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b3c1fbf-14c1-475c-a5f1-d6598449a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88802e1c00>]}
[0m17:52:39.882153 [info ] [MainThread]: 
[0m17:52:39.882552 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:52:39.883298 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m17:52:39.890553 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m17:52:39.890705 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m17:52:39.890802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:41.047954 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.16 seconds
[0m17:52:41.055384 [debug] [ThreadPool]: On list_materialize: Close
[0m17:52:41.058117 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m17:52:41.065769 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m17:52:41.065981 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m17:52:41.066130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:41.845509 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.78 seconds
[0m17:52:41.850955 [debug] [ThreadPool]: On list_materialize_public: Close
[0m17:52:41.852701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b3c1fbf-14c1-475c-a5f1-d6598449a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88802eff70>]}
[0m17:52:41.853597 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m17:52:41.853943 [info ] [MainThread]: 
[0m17:52:41.860622 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m17:52:41.861123 [info ] [Thread-1 (]: 1 of 4 START sql source model public.src_driver_location ....................... [RUN]
[0m17:52:41.862032 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m17:52:41.862238 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m17:52:41.862441 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m17:52:41.866557 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m17:52:41.867110 [debug] [Thread-1 (]: finished collecting timing info
[0m17:52:41.867290 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m17:52:41.884586 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m17:52:41.884882 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m17:52:41.885020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:42.654501 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.77 seconds
[0m17:52:42.666596 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m17:52:42.668377 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m17:52:42.668578 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m17:52:43.149909 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.48 seconds
[0m17:52:43.166777 [debug] [Thread-1 (]: finished collecting timing info
[0m17:52:43.167161 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m17:52:43.168097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3c1fbf-14c1-475c-a5f1-d6598449a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8892d9ad10>]}
[0m17:52:43.168513 [info ] [Thread-1 (]: 1 of 4 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.31s]
[0m17:52:43.169287 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m17:52:43.169480 [debug] [Thread-1 (]: Began running node model.onward_materialize.staging_src_driver_location
[0m17:52:43.169931 [info ] [Thread-1 (]: 2 of 4 START sql source model public.staging_src_driver_location ............... [RUN]
[0m17:52:43.170645 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.staging_src_driver_location"
[0m17:52:43.170819 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.staging_src_driver_location
[0m17:52:43.170984 [debug] [Thread-1 (]: Compiling model.onward_materialize.staging_src_driver_location
[0m17:52:43.174810 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.staging_src_driver_location"
[0m17:52:43.177072 [debug] [Thread-1 (]: finished collecting timing info
[0m17:52:43.177261 [debug] [Thread-1 (]: Began executing node model.onward_materialize.staging_src_driver_location
[0m17:52:43.181071 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_src_driver_location"
[0m17:52:43.181237 [debug] [Thread-1 (]: On model.onward_materialize.staging_src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_src_driver_location"} */

      drop source if exists "materialize"."public"."staging_src_driver_location" cascade
    
[0m17:52:43.181359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:43.954227 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.77 seconds
[0m17:52:43.959694 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.staging_src_driver_location"
[0m17:52:43.961860 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_src_driver_location"
[0m17:52:43.962034 [debug] [Thread-1 (]: On model.onward_materialize.staging_src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."staging_src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'staging_driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

--
--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."staging_src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
----  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m17:52:44.414118 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.45 seconds
[0m17:52:44.419328 [debug] [Thread-1 (]: finished collecting timing info
[0m17:52:44.419654 [debug] [Thread-1 (]: On model.onward_materialize.staging_src_driver_location: Close
[0m17:52:44.420882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3c1fbf-14c1-475c-a5f1-d6598449a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8892ddcfa0>]}
[0m17:52:44.421405 [info ] [Thread-1 (]: 2 of 4 OK created sql source model public.staging_src_driver_location .......... [[32mCREATE SOURCE[0m in 1.25s]
[0m17:52:44.421906 [debug] [Thread-1 (]: Finished running node model.onward_materialize.staging_src_driver_location
[0m17:52:44.422128 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m17:52:44.422612 [info ] [Thread-1 (]: 3 of 4 START sql view model public.json_driver_location ........................ [RUN]
[0m17:52:44.423300 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m17:52:44.423466 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m17:52:44.423630 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m17:52:44.428937 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m17:52:44.431344 [debug] [Thread-1 (]: finished collecting timing info
[0m17:52:44.431523 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m17:52:44.442494 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m17:52:44.442714 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m17:52:44.442871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:45.953948 [debug] [Thread-1 (]: SQL status: DROP VIEW in 1.51 seconds
[0m17:52:45.960321 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m17:52:45.963082 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m17:52:45.963209 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    key,
    data->>'uid' AS uid,
    data->>'timestamp' as timestamp, -- AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(key, 'utf8') as key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m17:52:46.025746 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "key" does not exist

[0m17:52:46.027079 [debug] [Thread-1 (]: finished collecting timing info
[0m17:52:46.027546 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m17:52:46.029639 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  column "key" does not exist
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m17:52:46.030404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3c1fbf-14c1-475c-a5f1-d6598449a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8892e0a9e0>]}
[0m17:52:46.031098 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 1.61s]
[0m17:52:46.031757 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m17:52:46.031992 [debug] [Thread-1 (]: Began running node model.onward_materialize.staging_json_driver_location
[0m17:52:46.032366 [info ] [Thread-1 (]: 4 of 4 START sql view model public.staging_json_driver_location ................ [RUN]
[0m17:52:46.033141 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.staging_json_driver_location"
[0m17:52:46.033340 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.staging_json_driver_location
[0m17:52:46.033523 [debug] [Thread-1 (]: Compiling model.onward_materialize.staging_json_driver_location
[0m17:52:46.037406 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.staging_json_driver_location"
[0m17:52:46.037934 [debug] [Thread-1 (]: finished collecting timing info
[0m17:52:46.038064 [debug] [Thread-1 (]: Began executing node model.onward_materialize.staging_json_driver_location
[0m17:52:46.042533 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_json_driver_location"
[0m17:52:46.042709 [debug] [Thread-1 (]: On model.onward_materialize.staging_json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_json_driver_location"} */

      drop view if exists "materialize"."public"."staging_json_driver_location" cascade
    
[0m17:52:46.042850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:46.680365 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.64 seconds
[0m17:52:46.685817 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.staging_json_driver_location"
[0m17:52:46.687450 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_json_driver_location"
[0m17:52:46.687654 [debug] [Thread-1 (]: On model.onward_materialize.staging_json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_json_driver_location"} */
create view "materialize"."public"."staging_json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    key,
    data->>'uid' AS uid,
    cast(data->>'timestamp' as timestamp) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(key, 'utf8') as key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."staging_src_driver_location")
  where data->>'routeKey' is not null
  );
[0m17:52:46.904541 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.22 seconds
[0m17:52:46.910164 [debug] [Thread-1 (]: finished collecting timing info
[0m17:52:46.910535 [debug] [Thread-1 (]: On model.onward_materialize.staging_json_driver_location: Close
[0m17:52:46.911643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3c1fbf-14c1-475c-a5f1-d6598449a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8892d555a0>]}
[0m17:52:46.912069 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.staging_json_driver_location ........... [[32mCREATE VIEW[0m in 0.88s]
[0m17:52:46.912489 [debug] [Thread-1 (]: Finished running node model.onward_materialize.staging_json_driver_location
[0m17:52:46.914032 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:52:46.914682 [info ] [MainThread]: 
[0m17:52:46.914958 [info ] [MainThread]: Finished running 2 source models, 2 view models in 0 hours 0 minutes and 7.03 seconds (7.03s).
[0m17:52:46.915217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:46.915348 [debug] [MainThread]: Connection 'model.onward_materialize.staging_json_driver_location' was properly closed.
[0m17:52:46.924112 [info ] [MainThread]: 
[0m17:52:46.924423 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:52:46.924689 [info ] [MainThread]: 
[0m17:52:46.924931 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m17:52:46.925167 [error] [MainThread]:   column "key" does not exist
[0m17:52:46.925388 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m17:52:46.925624 [info ] [MainThread]: 
[0m17:52:46.925860 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:52:46.926208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88802effd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88802efca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8880300430>]}
[0m17:52:46.926470 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 17:53:31.362040 | 00ba4fab-4ca5-4aa8-ac83-975efc894e82 ==============================
[0m17:53:31.362103 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:53:31.362714 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:53:31.362838 [debug] [MainThread]: Tracking: tracking
[0m17:53:31.392500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37aadd660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37aadde40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37aadd780>]}
[0m17:53:31.441768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:31.442197 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m17:53:31.455165 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m17:53:31.479696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00ba4fab-4ca5-4aa8-ac83-975efc894e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37ace00d0>]}
[0m17:53:31.485113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00ba4fab-4ca5-4aa8-ac83-975efc894e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37ac14940>]}
[0m17:53:31.485345 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:53:31.485523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00ba4fab-4ca5-4aa8-ac83-975efc894e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37ac39b10>]}
[0m17:53:31.486481 [info ] [MainThread]: 
[0m17:53:31.486882 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:53:31.487707 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m17:53:31.495283 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m17:53:31.495473 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m17:53:31.495574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:32.388089 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.89 seconds
[0m17:53:32.393275 [debug] [ThreadPool]: On list_materialize: Close
[0m17:53:32.396188 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m17:53:32.403089 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m17:53:32.403303 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m17:53:32.403452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:33.124354 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.72 seconds
[0m17:53:33.129975 [debug] [ThreadPool]: On list_materialize_public: Close
[0m17:53:33.131300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00ba4fab-4ca5-4aa8-ac83-975efc894e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37ac47f70>]}
[0m17:53:33.132004 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m17:53:33.132303 [info ] [MainThread]: 
[0m17:53:33.136109 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m17:53:33.136527 [info ] [Thread-1 (]: 1 of 4 START sql source model public.src_driver_location ....................... [RUN]
[0m17:53:33.137016 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m17:53:33.137141 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m17:53:33.137271 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m17:53:33.140687 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m17:53:33.141363 [debug] [Thread-1 (]: finished collecting timing info
[0m17:53:33.141545 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m17:53:33.156953 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m17:53:33.157159 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m17:53:33.157287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:33.924634 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.77 seconds
[0m17:53:33.937038 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m17:53:33.940306 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m17:53:33.940551 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m17:53:34.622684 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.68 seconds
[0m17:53:34.637165 [debug] [Thread-1 (]: finished collecting timing info
[0m17:53:34.637497 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m17:53:34.638336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00ba4fab-4ca5-4aa8-ac83-975efc894e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37ac47f70>]}
[0m17:53:34.638737 [info ] [Thread-1 (]: 1 of 4 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.50s]
[0m17:53:34.640275 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m17:53:34.640439 [debug] [Thread-1 (]: Began running node model.onward_materialize.staging_src_driver_location
[0m17:53:34.640612 [info ] [Thread-1 (]: 2 of 4 START sql source model public.staging_src_driver_location ............... [RUN]
[0m17:53:34.641177 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.staging_src_driver_location"
[0m17:53:34.641380 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.staging_src_driver_location
[0m17:53:34.641499 [debug] [Thread-1 (]: Compiling model.onward_materialize.staging_src_driver_location
[0m17:53:34.644792 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.staging_src_driver_location"
[0m17:53:34.645973 [debug] [Thread-1 (]: finished collecting timing info
[0m17:53:34.646174 [debug] [Thread-1 (]: Began executing node model.onward_materialize.staging_src_driver_location
[0m17:53:34.650085 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_src_driver_location"
[0m17:53:34.650260 [debug] [Thread-1 (]: On model.onward_materialize.staging_src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_src_driver_location"} */

      drop source if exists "materialize"."public"."staging_src_driver_location" cascade
    
[0m17:53:34.650396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:35.431443 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.78 seconds
[0m17:53:35.436454 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.staging_src_driver_location"
[0m17:53:35.437397 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_src_driver_location"
[0m17:53:35.437573 [debug] [Thread-1 (]: On model.onward_materialize.staging_src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."staging_src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'staging_driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

--
--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."staging_src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
----  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m17:53:36.236084 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.8 seconds
[0m17:53:36.241824 [debug] [Thread-1 (]: finished collecting timing info
[0m17:53:36.242197 [debug] [Thread-1 (]: On model.onward_materialize.staging_src_driver_location: Close
[0m17:53:36.243245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00ba4fab-4ca5-4aa8-ac83-975efc894e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37ace2b90>]}
[0m17:53:36.243680 [info ] [Thread-1 (]: 2 of 4 OK created sql source model public.staging_src_driver_location .......... [[32mCREATE SOURCE[0m in 1.60s]
[0m17:53:36.244155 [debug] [Thread-1 (]: Finished running node model.onward_materialize.staging_src_driver_location
[0m17:53:36.244359 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m17:53:36.244731 [info ] [Thread-1 (]: 3 of 4 START sql view model public.json_driver_location ........................ [RUN]
[0m17:53:36.245452 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m17:53:36.245757 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m17:53:36.245978 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m17:53:36.250160 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m17:53:36.252739 [debug] [Thread-1 (]: finished collecting timing info
[0m17:53:36.252922 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m17:53:36.265099 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m17:53:36.266417 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m17:53:36.266534 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
--    key,
    data->>'uid' AS uid,
    data->>'timestamp' as timestamp, -- AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m17:53:36.266633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:37.001494 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.73 seconds
[0m17:53:37.007681 [debug] [Thread-1 (]: finished collecting timing info
[0m17:53:37.008018 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m17:53:37.008871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00ba4fab-4ca5-4aa8-ac83-975efc894e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37ad7c100>]}
[0m17:53:37.009278 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 0.76s]
[0m17:53:37.009694 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m17:53:37.009906 [debug] [Thread-1 (]: Began running node model.onward_materialize.staging_json_driver_location
[0m17:53:37.010261 [info ] [Thread-1 (]: 4 of 4 START sql view model public.staging_json_driver_location ................ [RUN]
[0m17:53:37.010944 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.staging_json_driver_location"
[0m17:53:37.011116 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.staging_json_driver_location
[0m17:53:37.011275 [debug] [Thread-1 (]: Compiling model.onward_materialize.staging_json_driver_location
[0m17:53:37.015708 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.staging_json_driver_location"
[0m17:53:37.016491 [debug] [Thread-1 (]: finished collecting timing info
[0m17:53:37.016666 [debug] [Thread-1 (]: Began executing node model.onward_materialize.staging_json_driver_location
[0m17:53:37.020804 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_json_driver_location"
[0m17:53:37.020979 [debug] [Thread-1 (]: On model.onward_materialize.staging_json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_json_driver_location"} */

      drop view if exists "materialize"."public"."staging_json_driver_location" cascade
    
[0m17:53:37.021112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:37.674330 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.65 seconds
[0m17:53:37.679768 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.staging_json_driver_location"
[0m17:53:37.680691 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_json_driver_location"
[0m17:53:37.680861 [debug] [Thread-1 (]: On model.onward_materialize.staging_json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_json_driver_location"} */
create view "materialize"."public"."staging_json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    key,
    data->>'uid' AS uid,
    cast(data->>'timestamp' as timestamp) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(key, 'utf8') as key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."staging_src_driver_location")
  where data->>'routeKey' is not null
  );
[0m17:53:37.845243 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.16 seconds
[0m17:53:37.849933 [debug] [Thread-1 (]: finished collecting timing info
[0m17:53:37.850217 [debug] [Thread-1 (]: On model.onward_materialize.staging_json_driver_location: Close
[0m17:53:37.851155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00ba4fab-4ca5-4aa8-ac83-975efc894e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37ad7f340>]}
[0m17:53:37.851632 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.staging_json_driver_location ........... [[32mCREATE VIEW[0m in 0.84s]
[0m17:53:37.852039 [debug] [Thread-1 (]: Finished running node model.onward_materialize.staging_json_driver_location
[0m17:53:37.853469 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:53:37.853954 [info ] [MainThread]: 
[0m17:53:37.854179 [info ] [MainThread]: Finished running 2 source models, 2 view models in 0 hours 0 minutes and 6.37 seconds (6.37s).
[0m17:53:37.854368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:37.854461 [debug] [MainThread]: Connection 'model.onward_materialize.staging_json_driver_location' was properly closed.
[0m17:53:37.861968 [info ] [MainThread]: 
[0m17:53:37.862248 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:53:37.862492 [info ] [MainThread]: 
[0m17:53:37.862734 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:53:37.863079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37ac47970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37ac47b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37ad7ec50>]}
[0m17:53:37.863316 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 17:54:27.325384 | 159c51df-d3f3-4000-a7a5-29e163bf86bb ==============================
[0m17:54:27.325914 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:54:27.327597 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:54:27.327861 [debug] [MainThread]: Tracking: tracking
[0m17:54:27.352487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec283a8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec283b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec283aa10>]}
[0m17:54:27.400975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:54:27.401159 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:54:27.406111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '159c51df-d3f3-4000-a7a5-29e163bf86bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec29e8430>]}
[0m17:54:27.411591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '159c51df-d3f3-4000-a7a5-29e163bf86bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec29b1390>]}
[0m17:54:27.411794 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:54:27.411964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '159c51df-d3f3-4000-a7a5-29e163bf86bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec29b1420>]}
[0m17:54:27.413046 [info ] [MainThread]: 
[0m17:54:27.413632 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:54:27.414697 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m17:54:27.422965 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m17:54:27.423120 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m17:54:27.423216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:28.889455 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.47 seconds
[0m17:54:28.896912 [debug] [ThreadPool]: On list_materialize: Close
[0m17:54:28.899458 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m17:54:28.906513 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m17:54:28.906738 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m17:54:28.906892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:29.916124 [debug] [ThreadPool]: SQL status: SELECT 4 in 1.01 seconds
[0m17:54:29.920267 [debug] [ThreadPool]: On list_materialize_public: Close
[0m17:54:29.922370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '159c51df-d3f3-4000-a7a5-29e163bf86bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec299fd90>]}
[0m17:54:29.923370 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m17:54:29.923707 [info ] [MainThread]: 
[0m17:54:29.930056 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m17:54:29.930431 [info ] [Thread-1 (]: 1 of 4 START sql source model public.src_driver_location ....................... [RUN]
[0m17:54:29.931165 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m17:54:29.931356 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m17:54:29.931545 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m17:54:29.935692 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m17:54:29.937013 [debug] [Thread-1 (]: finished collecting timing info
[0m17:54:29.937161 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m17:54:29.953618 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m17:54:29.953893 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m17:54:29.954010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:30.880941 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.93 seconds
[0m17:54:30.895722 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m17:54:30.897271 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m17:54:30.897470 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m17:54:31.431831 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.53 seconds
[0m17:54:31.449882 [debug] [Thread-1 (]: finished collecting timing info
[0m17:54:31.450259 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m17:54:31.451297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '159c51df-d3f3-4000-a7a5-29e163bf86bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec2a57fa0>]}
[0m17:54:31.451756 [info ] [Thread-1 (]: 1 of 4 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.52s]
[0m17:54:31.452908 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m17:54:31.453135 [debug] [Thread-1 (]: Began running node model.onward_materialize.staging_src_driver_location
[0m17:54:31.453599 [info ] [Thread-1 (]: 2 of 4 START sql source model public.staging_src_driver_location ............... [RUN]
[0m17:54:31.454331 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.staging_src_driver_location"
[0m17:54:31.454500 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.staging_src_driver_location
[0m17:54:31.454656 [debug] [Thread-1 (]: Compiling model.onward_materialize.staging_src_driver_location
[0m17:54:31.458364 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.staging_src_driver_location"
[0m17:54:31.459938 [debug] [Thread-1 (]: finished collecting timing info
[0m17:54:31.460121 [debug] [Thread-1 (]: Began executing node model.onward_materialize.staging_src_driver_location
[0m17:54:31.465306 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_src_driver_location"
[0m17:54:31.465505 [debug] [Thread-1 (]: On model.onward_materialize.staging_src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_src_driver_location"} */

      drop source if exists "materialize"."public"."staging_src_driver_location" cascade
    
[0m17:54:31.465633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:32.282219 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.82 seconds
[0m17:54:32.287521 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.staging_src_driver_location"
[0m17:54:32.288512 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_src_driver_location"
[0m17:54:32.288707 [debug] [Thread-1 (]: On model.onward_materialize.staging_src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."staging_src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'staging_driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');

--
--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."staging_src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
----  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m17:54:32.793077 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.5 seconds
[0m17:54:32.799031 [debug] [Thread-1 (]: finished collecting timing info
[0m17:54:32.799429 [debug] [Thread-1 (]: On model.onward_materialize.staging_src_driver_location: Close
[0m17:54:32.800543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '159c51df-d3f3-4000-a7a5-29e163bf86bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec2a85570>]}
[0m17:54:32.801106 [info ] [Thread-1 (]: 2 of 4 OK created sql source model public.staging_src_driver_location .......... [[32mCREATE SOURCE[0m in 1.35s]
[0m17:54:32.801625 [debug] [Thread-1 (]: Finished running node model.onward_materialize.staging_src_driver_location
[0m17:54:32.801854 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m17:54:32.802321 [info ] [Thread-1 (]: 3 of 4 START sql view model public.json_driver_location ........................ [RUN]
[0m17:54:32.803049 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m17:54:32.803224 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m17:54:32.803401 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m17:54:32.807750 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m17:54:32.810423 [debug] [Thread-1 (]: finished collecting timing info
[0m17:54:32.810642 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m17:54:32.822011 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m17:54:32.822210 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m17:54:32.822337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:33.481190 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.66 seconds
[0m17:54:33.488316 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m17:54:33.490887 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m17:54:33.491082 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
--    key,
    data->>'uid' AS uid,
    data->>'timestamp' as timestamp, -- AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  where data->>'routeKey' is not null
  );
[0m17:54:33.641823 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.15 seconds
[0m17:54:33.645784 [debug] [Thread-1 (]: finished collecting timing info
[0m17:54:33.646029 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m17:54:33.647001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '159c51df-d3f3-4000-a7a5-29e163bf86bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec2a79390>]}
[0m17:54:33.647498 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 0.84s]
[0m17:54:33.648023 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m17:54:33.648170 [debug] [Thread-1 (]: Began running node model.onward_materialize.staging_json_driver_location
[0m17:54:33.648386 [info ] [Thread-1 (]: 4 of 4 START sql view model public.staging_json_driver_location ................ [RUN]
[0m17:54:33.648862 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.staging_json_driver_location"
[0m17:54:33.648984 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.staging_json_driver_location
[0m17:54:33.649091 [debug] [Thread-1 (]: Compiling model.onward_materialize.staging_json_driver_location
[0m17:54:33.652656 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.staging_json_driver_location"
[0m17:54:33.653123 [debug] [Thread-1 (]: finished collecting timing info
[0m17:54:33.653288 [debug] [Thread-1 (]: Began executing node model.onward_materialize.staging_json_driver_location
[0m17:54:33.657411 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_json_driver_location"
[0m17:54:33.657604 [debug] [Thread-1 (]: On model.onward_materialize.staging_json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_json_driver_location"} */

      drop view if exists "materialize"."public"."staging_json_driver_location" cascade
    
[0m17:54:33.657747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:34.302526 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.64 seconds
[0m17:54:34.307901 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.staging_json_driver_location"
[0m17:54:34.310192 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.staging_json_driver_location"
[0m17:54:34.310371 [debug] [Thread-1 (]: On model.onward_materialize.staging_json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.staging_json_driver_location"} */
create view "materialize"."public"."staging_json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
    key,
    data->>'uid' AS uid,
    cast(data->>'timestamp' as timestamp) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT CONVERT_FROM(key, 'utf8') as key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."staging_src_driver_location")
  where data->>'routeKey' is not null
  );
[0m17:54:34.513565 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.2 seconds
[0m17:54:34.520014 [debug] [Thread-1 (]: finished collecting timing info
[0m17:54:34.520527 [debug] [Thread-1 (]: On model.onward_materialize.staging_json_driver_location: Close
[0m17:54:34.521709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '159c51df-d3f3-4000-a7a5-29e163bf86bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec2ac3fa0>]}
[0m17:54:34.522193 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.staging_json_driver_location ........... [[32mCREATE VIEW[0m in 0.87s]
[0m17:54:34.522703 [debug] [Thread-1 (]: Finished running node model.onward_materialize.staging_json_driver_location
[0m17:54:34.524406 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m17:54:34.525075 [info ] [MainThread]: 
[0m17:54:34.525358 [info ] [MainThread]: Finished running 2 source models, 2 view models in 0 hours 0 minutes and 7.11 seconds (7.11s).
[0m17:54:34.525626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:34.525758 [debug] [MainThread]: Connection 'model.onward_materialize.staging_json_driver_location' was properly closed.
[0m17:54:34.535956 [info ] [MainThread]: 
[0m17:54:34.536262 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:34.536544 [info ] [MainThread]: 
[0m17:54:34.536788 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:54:34.537116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec2add090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec2adf490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec2ade3e0>]}
[0m17:54:34.537366 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 20:23:05.204442 | 414da0f5-a698-458e-a24c-043e21826d59 ==============================
[0m20:23:05.204540 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:23:05.205212 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['src_driver_location'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:23:05.205337 [debug] [MainThread]: Tracking: tracking
[0m20:23:05.232182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc19836de70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc19836e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc19836cf10>]}
[0m20:23:05.279506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:23:05.279859 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m20:23:05.290664 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m20:23:05.312945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '414da0f5-a698-458e-a24c-043e21826d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1884f40d0>]}
[0m20:23:05.318064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '414da0f5-a698-458e-a24c-043e21826d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1aa410ca0>]}
[0m20:23:05.318281 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:23:05.318463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '414da0f5-a698-458e-a24c-043e21826d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1983643d0>]}
[0m20:23:05.319460 [info ] [MainThread]: 
[0m20:23:05.319876 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:23:05.320677 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m20:23:05.328264 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m20:23:05.328433 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m20:23:05.328537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:06.094341 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.77 seconds
[0m20:23:06.100015 [debug] [ThreadPool]: On list_materialize: Close
[0m20:23:06.102602 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m20:23:06.112027 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m20:23:06.112300 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m20:23:06.112474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:06.923526 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.81 seconds
[0m20:23:06.929772 [debug] [ThreadPool]: On list_materialize_public: Close
[0m20:23:06.931343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '414da0f5-a698-458e-a24c-043e21826d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1aa43fd60>]}
[0m20:23:06.932185 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:23:06.932532 [info ] [MainThread]: 
[0m20:23:06.939248 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m20:23:06.939660 [info ] [Thread-1 (]: 1 of 1 START sql source model public.src_driver_location ....................... [RUN]
[0m20:23:06.940619 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m20:23:06.940819 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m20:23:06.941038 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m20:23:06.945141 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m20:23:06.946354 [debug] [Thread-1 (]: finished collecting timing info
[0m20:23:06.946552 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m20:23:06.961261 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m20:23:06.961867 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m20:23:06.962000 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


--CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
--  ENVELOPE UPSERT
--  WITH (SIZE = '3xsmall');


  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
--  KEY FORMAT BYTES
--  VALUE FORMAT BYTES
  FORMAT BYTES
  WITH (SIZE = '3xsmall');


-- where id is not null
[0m20:23:06.962118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:07.988395 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.03 seconds
[0m20:23:08.005288 [debug] [Thread-1 (]: finished collecting timing info
[0m20:23:08.005813 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m20:23:08.006897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414da0f5-a698-458e-a24c-043e21826d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1884f4670>]}
[0m20:23:08.007392 [info ] [Thread-1 (]: 1 of 1 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.07s]
[0m20:23:08.008309 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m20:23:08.009628 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:23:08.010098 [info ] [MainThread]: 
[0m20:23:08.010312 [info ] [MainThread]: Finished running 1 source model in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m20:23:08.010529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:08.010668 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m20:23:08.019571 [info ] [MainThread]: 
[0m20:23:08.019859 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:23:08.020115 [info ] [MainThread]: 
[0m20:23:08.020335 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:23:08.020673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a8df45e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1aa43fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc188506860>]}
[0m20:23:08.020910 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 20:25:03.611280 | ade3d248-489a-4374-bb71-ebc4fc8c478f ==============================
[0m20:25:03.611549 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:25:03.612233 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['src_driver_location'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:25:03.612372 [debug] [MainThread]: Tracking: tracking
[0m20:25:03.639477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9a1a5b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9a1a60e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9a1a4be0>]}
[0m20:25:03.687370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:25:03.687751 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/sources/src_driver_location.sql
[0m20:25:03.698921 [debug] [MainThread]: 1603: static parser failed on sources/src_driver_location.sql
[0m20:25:03.709986 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sources/src_driver_location.sql
[0m20:25:03.723655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ade3d248-489a-4374-bb71-ebc4fc8c478f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc886f00d0>]}
[0m20:25:03.728663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ade3d248-489a-4374-bb71-ebc4fc8c478f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9a2d4ac0>]}
[0m20:25:03.728875 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:25:03.729055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ade3d248-489a-4374-bb71-ebc4fc8c478f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9a19c400>]}
[0m20:25:03.729937 [info ] [MainThread]: 
[0m20:25:03.730341 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:25:03.731016 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m20:25:03.738691 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m20:25:03.738855 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m20:25:03.738946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:05.018479 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.28 seconds
[0m20:25:05.023854 [debug] [ThreadPool]: On list_materialize: Close
[0m20:25:05.026349 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m20:25:05.034610 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m20:25:05.034884 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m20:25:05.035036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:05.916448 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.88 seconds
[0m20:25:05.921830 [debug] [ThreadPool]: On list_materialize_public: Close
[0m20:25:05.923564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ade3d248-489a-4374-bb71-ebc4fc8c478f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9a30bd60>]}
[0m20:25:05.924481 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:25:05.924808 [info ] [MainThread]: 
[0m20:25:05.931466 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m20:25:05.931911 [info ] [Thread-1 (]: 1 of 1 START sql source model public.src_driver_location ....................... [RUN]
[0m20:25:05.932695 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m20:25:05.932904 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m20:25:05.933111 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m20:25:05.937709 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m20:25:05.938794 [debug] [Thread-1 (]: finished collecting timing info
[0m20:25:05.939012 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m20:25:05.952743 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m20:25:05.953314 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m20:25:05.953455 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');


--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
----  KEY FORMAT BYTES
----  VALUE FORMAT BYTES
--  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m20:25:05.953581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:07.167957 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 1.21 seconds
[0m20:25:07.184037 [debug] [Thread-1 (]: finished collecting timing info
[0m20:25:07.184346 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m20:25:07.185181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade3d248-489a-4374-bb71-ebc4fc8c478f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc8870f940>]}
[0m20:25:07.185578 [info ] [Thread-1 (]: 1 of 1 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.25s]
[0m20:25:07.186343 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m20:25:07.187756 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:25:07.188361 [info ] [MainThread]: 
[0m20:25:07.188658 [info ] [MainThread]: Finished running 1 source model in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m20:25:07.188907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:07.189039 [debug] [MainThread]: Connection 'model.onward_materialize.src_driver_location' was properly closed.
[0m20:25:07.196662 [info ] [MainThread]: 
[0m20:25:07.196952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:25:07.197196 [info ] [MainThread]: 
[0m20:25:07.197404 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:25:07.197690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9a1a40d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9a30bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9a31c400>]}
[0m20:25:07.197911 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 20:35:50.625710 | 901fae5b-be91-4c68-b98d-616ccf3e9677 ==============================
[0m20:35:50.625755 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:35:50.626446 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['json_driver_location'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:35:50.626573 [debug] [MainThread]: Tracking: tracking
[0m20:35:50.650623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83a34e9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83a34ef80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83a34cd90>]}
[0m20:35:50.698553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:35:50.698909 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m20:35:50.709380 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m20:35:50.731302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '901fae5b-be91-4c68-b98d-616ccf3e9677', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8287000d0>]}
[0m20:35:50.736347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '901fae5b-be91-4c68-b98d-616ccf3e9677', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8202a0ac0>]}
[0m20:35:50.736558 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:35:50.736732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '901fae5b-be91-4c68-b98d-616ccf3e9677', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83a347250>]}
[0m20:35:50.737568 [info ] [MainThread]: 
[0m20:35:50.737960 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:35:50.738609 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m20:35:50.745643 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m20:35:50.745796 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m20:35:50.745888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:53.011605 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.27 seconds
[0m20:35:53.017319 [debug] [ThreadPool]: On list_materialize: Close
[0m20:35:53.020250 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m20:35:53.027805 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m20:35:53.028000 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m20:35:53.028120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:35:53.827748 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.8 seconds
[0m20:35:53.834179 [debug] [ThreadPool]: On list_materialize_public: Close
[0m20:35:53.835746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '901fae5b-be91-4c68-b98d-616ccf3e9677', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe828737610>]}
[0m20:35:53.836555 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:35:53.836886 [info ] [MainThread]: 
[0m20:35:53.842538 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m20:35:53.843598 [info ] [Thread-1 (]: 1 of 1 START sql view model public.json_driver_location ........................ [RUN]
[0m20:35:53.844918 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m20:35:53.845149 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m20:35:53.845361 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m20:35:53.850046 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m20:35:53.851610 [debug] [Thread-1 (]: finished collecting timing info
[0m20:35:53.851810 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m20:35:53.866467 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m20:35:53.867749 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m20:35:53.867886 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
-   key,
    data->>'uid' AS uid,
    cast(data->>'timestamp'as timestamp) as timestamp, -- AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT
            CONVERT_FROM(key, 'utf8') as key
            ,CONVERT_FROM(data, 'utf8')::jsonb AS data
        FROM "materialize"."public"."src_driver_location")
  );
[0m20:35:53.868050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:55.073185 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no overload for - text: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

[0m20:35:55.075757 [debug] [Thread-1 (]: finished collecting timing info
[0m20:35:55.076237 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m20:35:55.078163 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  no overload for - text: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:35:55.078816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '901fae5b-be91-4c68-b98d-616ccf3e9677', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe828737b80>]}
[0m20:35:55.079378 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 1.23s]
[0m20:35:55.080465 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m20:35:55.081902 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:35:55.082359 [info ] [MainThread]: 
[0m20:35:55.082599 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m20:35:55.082850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:55.082980 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m20:35:55.091200 [info ] [MainThread]: 
[0m20:35:55.091538 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:35:55.091823 [info ] [MainThread]: 
[0m20:35:55.092057 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m20:35:55.092289 [error] [MainThread]:   no overload for - text: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
[0m20:35:55.092511 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:35:55.092737 [info ] [MainThread]: 
[0m20:35:55.092979 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:35:55.093328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83a347250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8202d3fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8287127a0>]}
[0m20:35:55.093586 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 20:36:39.715936 | 6c23112c-c433-4c6f-9aab-fa5fe793ff47 ==============================
[0m20:36:39.715997 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:36:39.716541 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['json_driver_location'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:36:39.716657 [debug] [MainThread]: Tracking: tracking
[0m20:36:39.738138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe930c15a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe930c16230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe930c15b70>]}
[0m20:36:39.778499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:36:39.778836 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m20:36:39.788960 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m20:36:39.810444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c23112c-c433-4c6f-9aab-fa5fe793ff47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9294d80d0>]}
[0m20:36:39.815514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c23112c-c433-4c6f-9aab-fa5fe793ff47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92940cb20>]}
[0m20:36:39.815711 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:36:39.815881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c23112c-c433-4c6f-9aab-fa5fe793ff47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe929435b10>]}
[0m20:36:39.816791 [info ] [MainThread]: 
[0m20:36:39.817198 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:36:39.817865 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m20:36:39.825293 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m20:36:39.825428 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m20:36:39.825524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:40.645788 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.82 seconds
[0m20:36:40.650776 [debug] [ThreadPool]: On list_materialize: Close
[0m20:36:40.653537 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m20:36:40.661274 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m20:36:40.661518 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m20:36:40.661672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:41.350968 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.69 seconds
[0m20:36:41.357152 [debug] [ThreadPool]: On list_materialize_public: Close
[0m20:36:41.358985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c23112c-c433-4c6f-9aab-fa5fe793ff47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92943fd30>]}
[0m20:36:41.360016 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:36:41.360361 [info ] [MainThread]: 
[0m20:36:41.364891 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m20:36:41.365567 [info ] [Thread-1 (]: 1 of 1 START sql view model public.json_driver_location ........................ [RUN]
[0m20:36:41.366301 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m20:36:41.366487 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m20:36:41.366692 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m20:36:41.370429 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m20:36:41.370996 [debug] [Thread-1 (]: finished collecting timing info
[0m20:36:41.371191 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m20:36:41.386639 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m20:36:41.387287 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m20:36:41.387433 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
-   key,
    data->>'uid' AS uid,
    cast(cast(data->>'timestamp' as varchar) as timestamp) as timestamp, -- AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT
            CONVERT_FROM(key, 'utf8') as key
            ,CONVERT_FROM(data, 'utf8')::jsonb AS data
        FROM "materialize"."public"."src_driver_location")
  );
[0m20:36:41.387558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:42.087015 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no overload for - text: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

[0m20:36:42.088389 [debug] [Thread-1 (]: finished collecting timing info
[0m20:36:42.089022 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m20:36:42.089981 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  no overload for - text: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:36:42.090320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c23112c-c433-4c6f-9aab-fa5fe793ff47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92950f460>]}
[0m20:36:42.090773 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 0.72s]
[0m20:36:42.091755 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m20:36:42.093031 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:36:42.093368 [info ] [MainThread]: 
[0m20:36:42.093522 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m20:36:42.093658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:42.093771 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m20:36:42.101990 [info ] [MainThread]: 
[0m20:36:42.102367 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:36:42.102647 [info ] [MainThread]: 
[0m20:36:42.102883 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m20:36:42.103109 [error] [MainThread]:   no overload for - text: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
[0m20:36:42.103324 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:36:42.103543 [info ] [MainThread]: 
[0m20:36:42.103764 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:36:42.104082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe929435ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92943feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9294eab60>]}
[0m20:36:42.104344 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 20:39:57.271273 | fc1aa4ff-581b-4597-b53e-5bb56891bb24 ==============================
[0m20:39:57.271323 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:39:57.271998 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['json_driver_location'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:39:57.272126 [debug] [MainThread]: Tracking: tracking
[0m20:39:57.299088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9208c820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9208e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9208fd00>]}
[0m20:39:57.348408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:39:57.348779 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m20:39:57.360625 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m20:39:57.383437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc1aa4ff-581b-4597-b53e-5bb56891bb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba705a40d0>]}
[0m20:39:57.388908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc1aa4ff-581b-4597-b53e-5bb56891bb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba50084ca0>]}
[0m20:39:57.389112 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:39:57.389284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc1aa4ff-581b-4597-b53e-5bb56891bb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba92085570>]}
[0m20:39:57.390141 [info ] [MainThread]: 
[0m20:39:57.390523 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:39:57.391261 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m20:39:57.398918 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m20:39:57.399094 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m20:39:57.399191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:58.190522 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.79 seconds
[0m20:39:58.199014 [debug] [ThreadPool]: On list_materialize: Close
[0m20:39:58.202789 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m20:39:58.210848 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m20:39:58.211095 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m20:39:58.211274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:00.617597 [debug] [ThreadPool]: SQL status: SELECT 1 in 2.41 seconds
[0m20:40:00.625749 [debug] [ThreadPool]: On list_materialize_public: Close
[0m20:40:00.627456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc1aa4ff-581b-4597-b53e-5bb56891bb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba705cf5b0>]}
[0m20:40:00.628326 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:40:00.628706 [info ] [MainThread]: 
[0m20:40:00.634051 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m20:40:00.634595 [info ] [Thread-1 (]: 1 of 1 START sql view model public.json_driver_location ........................ [RUN]
[0m20:40:00.635170 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m20:40:00.635314 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m20:40:00.635484 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m20:40:00.639715 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m20:40:00.640624 [debug] [Thread-1 (]: finished collecting timing info
[0m20:40:00.640900 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m20:40:00.657022 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m20:40:00.657723 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m20:40:00.657881 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
-   key,
    data->>'uid' AS uid,
    data->>'timestamp' as timestamp, -- AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT
            CONVERT_FROM(key, 'utf8') as key
            ,CONVERT_FROM(data, 'utf8')::jsonb AS data
        FROM "materialize"."public"."src_driver_location")
  );
[0m20:40:00.658003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:01.315528 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no overload for - text: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

[0m20:40:01.318127 [debug] [Thread-1 (]: finished collecting timing info
[0m20:40:01.318667 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m20:40:01.321025 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  no overload for - text: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:40:01.321861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc1aa4ff-581b-4597-b53e-5bb56891bb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba705cf250>]}
[0m20:40:01.322691 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 0.69s]
[0m20:40:01.325320 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m20:40:01.327147 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:40:01.327779 [info ] [MainThread]: 
[0m20:40:01.328082 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m20:40:01.328357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:01.328484 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m20:40:01.338099 [info ] [MainThread]: 
[0m20:40:01.338416 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:40:01.338689 [info ] [MainThread]: 
[0m20:40:01.338931 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m20:40:01.339164 [error] [MainThread]:   no overload for - text: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
[0m20:40:01.339379 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:40:01.339599 [info ] [MainThread]: 
[0m20:40:01.339842 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:40:01.340195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba92085570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba500bbfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba705b6b00>]}
[0m20:40:01.340469 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 20:40:28.262948 | 63b5d584-f6bb-433b-a8e3-f5f728a879b0 ==============================
[0m20:40:28.263023 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:40:28.264171 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['json_driver_location'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:40:28.265413 [debug] [MainThread]: Tracking: tracking
[0m20:40:28.314057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d932c820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d932e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d932fd00>]}
[0m20:40:28.362159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:40:28.362373 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:40:28.367746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63b5d584-f6bb-433b-a8e3-f5f728a879b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91e8d18430>]}
[0m20:40:28.372984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63b5d584-f6bb-433b-a8e3-f5f728a879b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91e8ce52a0>]}
[0m20:40:28.373194 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:40:28.373370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63b5d584-f6bb-433b-a8e3-f5f728a879b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d9325570>]}
[0m20:40:28.374369 [info ] [MainThread]: 
[0m20:40:28.374780 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:40:28.375460 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m20:40:28.383444 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m20:40:28.383584 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m20:40:28.383676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:29.157024 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.77 seconds
[0m20:40:29.163776 [debug] [ThreadPool]: On list_materialize: Close
[0m20:40:29.166574 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m20:40:29.174616 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m20:40:29.174875 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m20:40:29.175031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:29.919519 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.74 seconds
[0m20:40:29.924686 [debug] [ThreadPool]: On list_materialize_public: Close
[0m20:40:29.926039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63b5d584-f6bb-433b-a8e3-f5f728a879b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91e8ca0040>]}
[0m20:40:29.926854 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:40:29.927187 [info ] [MainThread]: 
[0m20:40:29.932963 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m20:40:29.933736 [info ] [Thread-1 (]: 1 of 1 START sql view model public.json_driver_location ........................ [RUN]
[0m20:40:29.934583 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m20:40:29.934790 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m20:40:29.935112 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m20:40:29.939411 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m20:40:29.940139 [debug] [Thread-1 (]: finished collecting timing info
[0m20:40:29.940371 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m20:40:29.956771 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m20:40:29.957653 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m20:40:29.957790 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
-   key,
    data->>'uid' AS uid,
    data->>'timestamp' as timestamp, -- AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT
            CONVERT_FROM(key, 'utf8') as key
            ,CONVERT_FROM(data, 'utf8')::jsonb AS data
        FROM "materialize"."public"."src_driver_location")
  );
[0m20:40:29.957908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:31.236661 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no overload for - text: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

[0m20:40:31.239563 [debug] [Thread-1 (]: finished collecting timing info
[0m20:40:31.240051 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m20:40:31.242069 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  no overload for - text: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:40:31.242784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b5d584-f6bb-433b-a8e3-f5f728a879b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b859fc40>]}
[0m20:40:31.243368 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 1.31s]
[0m20:40:31.244378 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m20:40:31.246104 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:40:31.246773 [info ] [MainThread]: 
[0m20:40:31.247127 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m20:40:31.247398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:31.247525 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m20:40:31.257081 [info ] [MainThread]: 
[0m20:40:31.257402 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:40:31.257779 [info ] [MainThread]: 
[0m20:40:31.258061 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m20:40:31.258301 [error] [MainThread]:   no overload for - text: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
[0m20:40:31.258531 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:40:31.258759 [info ] [MainThread]: 
[0m20:40:31.258995 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:40:31.259399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b859fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91e8ce5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b85a9870>]}
[0m20:40:31.259710 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 20:41:03.204046 | a91371d9-c0ff-4c71-ae7c-791ca8ee2a95 ==============================
[0m20:41:03.204110 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:41:03.204679 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['json_driver_location'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:41:03.204796 [debug] [MainThread]: Tracking: tracking
[0m20:41:03.227532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939920e8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939920f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939920ea10>]}
[0m20:41:03.277631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:41:03.278063 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m20:41:03.290123 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m20:41:03.312470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a91371d9-c0ff-4c71-ae7c-791ca8ee2a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93a06900d0>]}
[0m20:41:03.317447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a91371d9-c0ff-4c71-ae7c-791ca8ee2a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93805ecb20>]}
[0m20:41:03.317653 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:41:03.317832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a91371d9-c0ff-4c71-ae7c-791ca8ee2a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9380611b10>]}
[0m20:41:03.318702 [info ] [MainThread]: 
[0m20:41:03.319093 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:41:03.319747 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m20:41:03.326948 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m20:41:03.327129 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m20:41:03.327234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:05.959167 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.63 seconds
[0m20:41:05.961386 [debug] [ThreadPool]: On list_materialize: Close
[0m20:41:05.963923 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m20:41:05.970805 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m20:41:05.971055 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m20:41:05.971190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:07.087833 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.12 seconds
[0m20:41:07.094327 [debug] [ThreadPool]: On list_materialize_public: Close
[0m20:41:07.095773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a91371d9-c0ff-4c71-ae7c-791ca8ee2a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93a06c75e0>]}
[0m20:41:07.096503 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:41:07.096818 [info ] [MainThread]: 
[0m20:41:07.102582 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m20:41:07.103258 [info ] [Thread-1 (]: 1 of 1 START sql view model public.json_driver_location ........................ [RUN]
[0m20:41:07.104035 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m20:41:07.104174 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m20:41:07.104307 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m20:41:07.107749 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m20:41:07.108298 [debug] [Thread-1 (]: finished collecting timing info
[0m20:41:07.108488 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m20:41:07.124078 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m20:41:07.124704 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m20:41:07.124866 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
-   key,
    data->>'uid' AS uid,
    data->>'timestamp' as timestamp, -- AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
    data->>'routeNumber' as routeNumber,
    data->>'routeKey' as routeKey
  FROM (SELECT
            key
            ,CONVERT_FROM(data, 'utf8')::jsonb AS data
        FROM "materialize"."public"."src_driver_location")
  );
[0m20:41:07.125000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:07.803729 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no overload for - bytea: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

[0m20:41:07.804637 [debug] [Thread-1 (]: finished collecting timing info
[0m20:41:07.804925 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m20:41:07.806710 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  no overload for - bytea: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:41:07.808771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a91371d9-c0ff-4c71-ae7c-791ca8ee2a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93a06c7b50>]}
[0m20:41:07.809876 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 0.70s]
[0m20:41:07.811209 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m20:41:07.812698 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:41:07.813332 [info ] [MainThread]: 
[0m20:41:07.813619 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m20:41:07.813884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:07.814013 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m20:41:07.823756 [info ] [MainThread]: 
[0m20:41:07.824148 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:41:07.824427 [info ] [MainThread]: 
[0m20:41:07.824662 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m20:41:07.824888 [error] [MainThread]:   no overload for - bytea: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
[0m20:41:07.825105 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:41:07.825322 [info ] [MainThread]: 
[0m20:41:07.825550 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:41:07.825923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9380611ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f938061fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93a06a2b00>]}
[0m20:41:07.826188 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 20:44:36.444725 | 9f070263-de79-43a0-a06f-2cf9a1ff936b ==============================
[0m20:44:36.444766 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:44:36.445533 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['json_driver_location'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:44:36.445685 [debug] [MainThread]: Tracking: tracking
[0m20:44:36.469176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb462725e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb462726410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb462724f10>]}
[0m20:44:36.516129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:44:36.516473 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m20:44:36.527044 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m20:44:36.550069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f070263-de79-43a0-a06f-2cf9a1ff936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb46292c0d0>]}
[0m20:44:36.555718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f070263-de79-43a0-a06f-2cf9a1ff936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb462854ca0>]}
[0m20:44:36.555958 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:44:36.556135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f070263-de79-43a0-a06f-2cf9a1ff936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb46271dd20>]}
[0m20:44:36.557070 [info ] [MainThread]: 
[0m20:44:36.557492 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:44:36.558207 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m20:44:36.565526 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m20:44:36.565661 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m20:44:36.565762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:38.033519 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.47 seconds
[0m20:44:38.039918 [debug] [ThreadPool]: On list_materialize: Close
[0m20:44:38.042737 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m20:44:38.050037 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m20:44:38.050264 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m20:44:38.050418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:38.933835 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.88 seconds
[0m20:44:38.940695 [debug] [ThreadPool]: On list_materialize_public: Close
[0m20:44:38.942454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f070263-de79-43a0-a06f-2cf9a1ff936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb462957610>]}
[0m20:44:38.943325 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:44:38.943671 [info ] [MainThread]: 
[0m20:44:38.949292 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m20:44:38.950029 [info ] [Thread-1 (]: 1 of 1 START sql view model public.json_driver_location ........................ [RUN]
[0m20:44:38.950589 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m20:44:38.950727 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m20:44:38.950871 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m20:44:38.954642 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m20:44:38.955225 [debug] [Thread-1 (]: finished collecting timing info
[0m20:44:38.955417 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m20:44:38.970023 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m20:44:38.970582 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m20:44:38.970795 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
-   key,
    data->>'uid' AS uid,
    data->>'timestamp' as timestamp, -- AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed,
--    data->>'routeNumber' as routeNumber,
--    data->>'routeKey' as routeKey
  FROM (SELECT
            CONVERT_FROM(key, 'utf8') as key
            ,CONVERT_FROM(data, 'utf8')::jsonb AS data
        FROM "materialize"."public"."src_driver_location")
  );
[0m20:44:38.970900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:39.854985 [debug] [Thread-1 (]: Postgres adapter: Postgres error: expected expression, but found reserved keyword
LINE 23:   FROM (SELECT
           ^

[0m20:44:39.857027 [debug] [Thread-1 (]: finished collecting timing info
[0m20:44:39.857477 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m20:44:39.859200 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  expected expression, but found reserved keyword
  LINE 23:   FROM (SELECT
             ^
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:44:39.859904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f070263-de79-43a0-a06f-2cf9a1ff936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb462957b80>]}
[0m20:44:39.860472 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 0.91s]
[0m20:44:39.861544 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m20:44:39.863413 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:44:39.864066 [info ] [MainThread]: 
[0m20:44:39.864364 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.31 seconds (3.31s).
[0m20:44:39.864624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:39.864757 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m20:44:39.873357 [info ] [MainThread]: 
[0m20:44:39.873684 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:44:39.873961 [info ] [MainThread]: 
[0m20:44:39.874194 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m20:44:39.874419 [error] [MainThread]:   expected expression, but found reserved keyword
[0m20:44:39.874630 [error] [MainThread]:   LINE 23:   FROM (SELECT
[0m20:44:39.874843 [error] [MainThread]:              ^
[0m20:44:39.875080 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:44:39.875337 [info ] [MainThread]: 
[0m20:44:39.875565 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:44:39.875919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb46271dd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb46288bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb462936a70>]}
[0m20:44:39.876182 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 20:45:08.387039 | af0aa2f1-47d6-47c9-8faa-edcf1b847a7f ==============================
[0m20:45:08.387089 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:45:08.387635 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['json_driver_location'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:45:08.387754 [debug] [MainThread]: Tracking: tracking
[0m20:45:08.409389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c9de5e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c9de6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c9de4f10>]}
[0m20:45:08.452325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:45:08.452661 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m20:45:08.462401 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m20:45:08.483338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af0aa2f1-47d6-47c9-8faa-edcf1b847a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa388b280d0>]}
[0m20:45:08.488006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af0aa2f1-47d6-47c9-8faa-edcf1b847a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c9f14ca0>]}
[0m20:45:08.488198 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:45:08.488363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af0aa2f1-47d6-47c9-8faa-edcf1b847a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c9ddd6f0>]}
[0m20:45:08.489152 [info ] [MainThread]: 
[0m20:45:08.489532 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:45:08.490122 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m20:45:08.497292 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m20:45:08.497428 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m20:45:08.497523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:09.309856 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.81 seconds
[0m20:45:09.314883 [debug] [ThreadPool]: On list_materialize: Close
[0m20:45:09.317619 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m20:45:09.324429 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m20:45:09.324640 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m20:45:09.324794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:10.062272 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.74 seconds
[0m20:45:10.068329 [debug] [ThreadPool]: On list_materialize_public: Close
[0m20:45:10.070292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af0aa2f1-47d6-47c9-8faa-edcf1b847a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa388b5f610>]}
[0m20:45:10.071111 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:45:10.071447 [info ] [MainThread]: 
[0m20:45:10.075883 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m20:45:10.076605 [info ] [Thread-1 (]: 1 of 1 START sql view model public.json_driver_location ........................ [RUN]
[0m20:45:10.077355 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m20:45:10.077539 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m20:45:10.077718 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m20:45:10.081621 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m20:45:10.083339 [debug] [Thread-1 (]: finished collecting timing info
[0m20:45:10.083562 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m20:45:10.099591 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m20:45:10.100592 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m20:45:10.100832 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
-   key,
    data->>'uid' AS uid,
    data->>'timestamp' as timestamp, -- AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
--    data->>'routeNumber' as routeNumber,
--    data->>'routeKey' as routeKey
  FROM (SELECT
            CONVERT_FROM(key, 'utf8') as key
            ,CONVERT_FROM(data, 'utf8')::jsonb AS data
        FROM "materialize"."public"."src_driver_location")
  );
[0m20:45:10.100972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:10.836866 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no overload for - text: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

[0m20:45:10.839394 [debug] [Thread-1 (]: finished collecting timing info
[0m20:45:10.839819 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m20:45:10.841647 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  no overload for - text: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:45:10.842329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af0aa2f1-47d6-47c9-8faa-edcf1b847a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa388b5fb80>]}
[0m20:45:10.842930 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 0.77s]
[0m20:45:10.843997 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m20:45:10.845758 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:45:10.846433 [info ] [MainThread]: 
[0m20:45:10.846733 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m20:45:10.847027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:10.847160 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m20:45:10.855474 [info ] [MainThread]: 
[0m20:45:10.855782 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:45:10.856047 [info ] [MainThread]: 
[0m20:45:10.856274 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m20:45:10.856498 [error] [MainThread]:   no overload for - text: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
[0m20:45:10.856711 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:45:10.856927 [info ] [MainThread]: 
[0m20:45:10.857146 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:45:10.857461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c9ddd6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c9f47fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa388b3a7a0>]}
[0m20:45:10.857705 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 20:46:03.175452 | f61bc7e6-d7e6-4944-bf30-fdfaae2be402 ==============================
[0m20:46:03.175495 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:46:03.176070 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['json_driver_location'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:46:03.176188 [debug] [MainThread]: Tracking: tracking
[0m20:46:03.196818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd778fb5b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd778fb60e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd778fb4be0>]}
[0m20:46:03.237975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:46:03.238363 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m20:46:03.247888 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m20:46:03.270024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f61bc7e6-d7e6-4944-bf30-fdfaae2be402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7685c80d0>]}
[0m20:46:03.274873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f61bc7e6-d7e6-4944-bf30-fdfaae2be402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd798a44ca0>]}
[0m20:46:03.275069 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:46:03.275247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f61bc7e6-d7e6-4944-bf30-fdfaae2be402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd778faf1f0>]}
[0m20:46:03.276129 [info ] [MainThread]: 
[0m20:46:03.276534 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:46:03.277215 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m20:46:03.284378 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m20:46:03.284525 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m20:46:03.284618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:04.077474 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.79 seconds
[0m20:46:04.083222 [debug] [ThreadPool]: On list_materialize: Close
[0m20:46:04.086031 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m20:46:04.093952 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m20:46:04.094185 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m20:46:04.094350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:04.750772 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.66 seconds
[0m20:46:04.758238 [debug] [ThreadPool]: On list_materialize_public: Close
[0m20:46:04.759537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f61bc7e6-d7e6-4944-bf30-fdfaae2be402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd768603610>]}
[0m20:46:04.760251 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:46:04.760602 [info ] [MainThread]: 
[0m20:46:04.765556 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m20:46:04.766342 [info ] [Thread-1 (]: 1 of 1 START sql view model public.json_driver_location ........................ [RUN]
[0m20:46:04.767081 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m20:46:04.767258 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m20:46:04.767433 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m20:46:04.770439 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m20:46:04.770855 [debug] [Thread-1 (]: finished collecting timing info
[0m20:46:04.770953 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m20:46:04.784598 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m20:46:04.785194 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m20:46:04.785341 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
-   key,
    data->>'uid' AS uid,
    data->>'timestamp' as timestamp, -- AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
--    data->>'routeNumber' as routeNumber,
--    data->>'routeKey' as routeKey
  FROM (SELECT
            key
--            CAST(CONVERT_FROM(key, 'utf8') as text) as key
            ,CAST(CONVERT_FROM(data, 'utf8') as jsonb) AS data
        FROM "materialize"."public"."src_driver_location")
  );
[0m20:46:04.785479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:07.755572 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no overload for - bytea: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

[0m20:46:07.756653 [debug] [Thread-1 (]: finished collecting timing info
[0m20:46:07.757017 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m20:46:07.758614 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  no overload for - bytea: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:46:07.759449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61bc7e6-d7e6-4944-bf30-fdfaae2be402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd768603b80>]}
[0m20:46:07.760022 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 2.99s]
[0m20:46:07.760916 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m20:46:07.762445 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:46:07.763015 [info ] [MainThread]: 
[0m20:46:07.763298 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m20:46:07.763558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:07.763687 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m20:46:07.772422 [info ] [MainThread]: 
[0m20:46:07.772752 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:46:07.773022 [info ] [MainThread]: 
[0m20:46:07.773261 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m20:46:07.773521 [error] [MainThread]:   no overload for - bytea: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
[0m20:46:07.773835 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:46:07.774125 [info ] [MainThread]: 
[0m20:46:07.774380 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:46:07.774610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd778faf1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd798a7bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7685da7a0>]}
[0m20:46:07.774770 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 20:47:18.116700 | 308e0e40-c834-41a5-bb46-f678342bca30 ==============================
[0m20:47:18.116765 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:47:18.118690 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['json_driver_location'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:47:18.118823 [debug] [MainThread]: Tracking: tracking
[0m20:47:18.142476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb69e65a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb69e66200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb69e65b70>]}
[0m20:47:18.190626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:47:18.191051 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m20:47:18.200762 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m20:47:18.223293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '308e0e40-c834-41a5-bb46-f678342bca30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb58a4c0d0>]}
[0m20:47:18.228623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '308e0e40-c834-41a5-bb46-f678342bca30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb58974b50>]}
[0m20:47:18.228831 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:47:18.229009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '308e0e40-c834-41a5-bb46-f678342bca30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb58999ae0>]}
[0m20:47:18.229876 [info ] [MainThread]: 
[0m20:47:18.230273 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:47:18.230904 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m20:47:18.238066 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m20:47:18.238194 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m20:47:18.238288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:18.968298 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.73 seconds
[0m20:47:18.976436 [debug] [ThreadPool]: On list_materialize: Close
[0m20:47:18.979447 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m20:47:18.986620 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m20:47:18.986833 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m20:47:18.986991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:20.223514 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.24 seconds
[0m20:47:20.228639 [debug] [ThreadPool]: On list_materialize_public: Close
[0m20:47:20.230287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '308e0e40-c834-41a5-bb46-f678342bca30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb58a775b0>]}
[0m20:47:20.231177 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:47:20.231508 [info ] [MainThread]: 
[0m20:47:20.238247 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m20:47:20.238879 [info ] [Thread-1 (]: 1 of 1 START sql view model public.json_driver_location ........................ [RUN]
[0m20:47:20.239602 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m20:47:20.239790 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m20:47:20.239993 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m20:47:20.244281 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m20:47:20.244966 [debug] [Thread-1 (]: finished collecting timing info
[0m20:47:20.245150 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m20:47:20.260512 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m20:47:20.261063 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m20:47:20.261179 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
-   key,
    data->>'uid' AS uid,
    data
--    data->>'timestamp' as timestamp, -- AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--    data->>'routeNumber' as routeNumber,
--    data->>'routeKey' as routeKey
  FROM (SELECT
            key
--            CAST(CONVERT_FROM(key, 'utf8') as text) as key
            ,CAST(CONVERT_FROM(data, 'utf8') as text) AS data
        FROM "materialize"."public"."src_driver_location")
  );
[0m20:47:20.261277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:20.963393 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no overload for - bytea: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

[0m20:47:20.966134 [debug] [Thread-1 (]: finished collecting timing info
[0m20:47:20.966564 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m20:47:20.968629 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  no overload for - bytea: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:47:20.969287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '308e0e40-c834-41a5-bb46-f678342bca30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb58a77b20>]}
[0m20:47:20.969887 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 0.73s]
[0m20:47:20.970749 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m20:47:20.972320 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:47:20.972921 [info ] [MainThread]: 
[0m20:47:20.973204 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m20:47:20.973454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:20.973580 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m20:47:20.983163 [info ] [MainThread]: 
[0m20:47:20.983520 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:47:20.983805 [info ] [MainThread]: 
[0m20:47:20.984048 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m20:47:20.984271 [error] [MainThread]:   no overload for - bytea: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
[0m20:47:20.984484 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:47:20.984710 [info ] [MainThread]: 
[0m20:47:20.984947 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:47:20.985325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb58999ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb589a7be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb58a5ead0>]}
[0m20:47:20.985617 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 20:47:59.108970 | b5ca195c-5d8d-4568-b048-b27dcadae449 ==============================
[0m20:47:59.109037 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:47:59.110962 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['json_driver_location'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:47:59.111082 [debug] [MainThread]: Tracking: tracking
[0m20:47:59.131900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f20df68f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f20df70a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f20df6a10>]}
[0m20:47:59.179365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:47:59.179746 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m20:47:59.190748 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m20:47:59.215508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5ca195c-5d8d-4568-b048-b27dcadae449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef0a680d0>]}
[0m20:47:59.221487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5ca195c-5d8d-4568-b048-b27dcadae449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f008acb50>]}
[0m20:47:59.221762 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:47:59.221950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5ca195c-5d8d-4568-b048-b27dcadae449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f008d5ae0>]}
[0m20:47:59.222954 [info ] [MainThread]: 
[0m20:47:59.223487 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:47:59.224187 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m20:47:59.232111 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m20:47:59.232316 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m20:47:59.232411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:01.939423 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.71 seconds
[0m20:48:01.947834 [debug] [ThreadPool]: On list_materialize: Close
[0m20:48:01.950820 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m20:48:01.958122 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m20:48:01.958299 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m20:48:01.958413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:03.122322 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.16 seconds
[0m20:48:03.128289 [debug] [ThreadPool]: On list_materialize_public: Close
[0m20:48:03.130137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5ca195c-5d8d-4568-b048-b27dcadae449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f008e3cd0>]}
[0m20:48:03.131026 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:48:03.131291 [info ] [MainThread]: 
[0m20:48:03.136720 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m20:48:03.137381 [info ] [Thread-1 (]: 1 of 1 START sql view model public.json_driver_location ........................ [RUN]
[0m20:48:03.138122 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m20:48:03.138351 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m20:48:03.138563 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m20:48:03.143133 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m20:48:03.143821 [debug] [Thread-1 (]: finished collecting timing info
[0m20:48:03.144013 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m20:48:03.159344 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m20:48:03.159961 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m20:48:03.160227 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


 SELECT
-   key,
--    data->>'uid' AS uid,
    data
--    data->>'timestamp' as timestamp, -- AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--    data->>'routeNumber' as routeNumber,
--    data->>'routeKey' as routeKey
  FROM (SELECT
            key
--            CAST(CONVERT_FROM(key, 'utf8') as text) as key
            ,CAST(CONVERT_FROM(data, 'utf8') as text) AS data
        FROM "materialize"."public"."src_driver_location")
  );
[0m20:48:03.160384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:03.898460 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no overload for - bytea: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

[0m20:48:03.901218 [debug] [Thread-1 (]: finished collecting timing info
[0m20:48:03.901801 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m20:48:03.903567 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  no overload for - bytea: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:48:03.904233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5ca195c-5d8d-4568-b048-b27dcadae449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f008e3cd0>]}
[0m20:48:03.904822 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.json_driver_location ............... [[31mERROR[0m in 0.77s]
[0m20:48:03.905878 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m20:48:03.907716 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:48:03.908500 [info ] [MainThread]: 
[0m20:48:03.908830 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m20:48:03.909103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:03.909242 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m20:48:03.918692 [info ] [MainThread]: 
[0m20:48:03.919076 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:48:03.919366 [info ] [MainThread]: 
[0m20:48:03.919606 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m20:48:03.919839 [error] [MainThread]:   no overload for - bytea: arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
[0m20:48:03.920061 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m20:48:03.920294 [info ] [MainThread]: 
[0m20:48:03.920529 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:48:03.920897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f008d5ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef0a7a7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef0a7ab60>]}
[0m20:48:03.921165 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 20:48:26.410390 | c18c7241-5fbe-489d-9ebc-e548b487aa80 ==============================
[0m20:48:26.410454 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:48:26.410964 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['json_driver_location'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:48:26.411077 [debug] [MainThread]: Tracking: tracking
[0m20:48:26.432301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe190f15d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe190f16530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe190f15ea0>]}
[0m20:48:26.474346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:48:26.474704 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m20:48:26.484434 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m20:48:26.507910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c18c7241-5fbe-489d-9ebc-e548b487aa80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1707800d0>]}
[0m20:48:26.513073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c18c7241-5fbe-489d-9ebc-e548b487aa80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a0c24b50>]}
[0m20:48:26.513301 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m20:48:26.513473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c18c7241-5fbe-489d-9ebc-e548b487aa80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a0c4dae0>]}
[0m20:48:26.514437 [info ] [MainThread]: 
[0m20:48:26.514874 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:48:26.515571 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m20:48:26.523099 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m20:48:26.523252 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m20:48:26.523344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:27.319113 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.8 seconds
[0m20:48:27.324624 [debug] [ThreadPool]: On list_materialize: Close
[0m20:48:27.326718 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m20:48:27.333975 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m20:48:27.334227 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m20:48:27.334377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:28.030495 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.7 seconds
[0m20:48:28.036423 [debug] [ThreadPool]: On list_materialize_public: Close
[0m20:48:28.038030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c18c7241-5fbe-489d-9ebc-e548b487aa80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1707b75b0>]}
[0m20:48:28.038926 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:48:28.039269 [info ] [MainThread]: 
[0m20:48:28.045790 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m20:48:28.046485 [info ] [Thread-1 (]: 1 of 1 START sql view model public.json_driver_location ........................ [RUN]
[0m20:48:28.047326 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m20:48:28.047532 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m20:48:28.047740 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m20:48:28.052296 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m20:48:28.052929 [debug] [Thread-1 (]: finished collecting timing info
[0m20:48:28.053119 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m20:48:28.068517 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m20:48:28.069034 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m20:48:28.069133 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create view "materialize"."public"."json_driver_location"
  as (
    --SELECT
--    CONVERT_FROM(key, 'utf8') as key,
--    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
--    data->>'latitude' AS latitude,
--    data->>'longitude' AS longitude,
--    data->>'speed' AS speed
--  FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")


select *
from "materialize"."public"."src_driver_location"

-- SELECT
---   key,
----    data->>'uid' AS uid,
--    data
----    data->>'timestamp' as timestamp, -- AS timestamp,
----    data->>'latitude' AS latitude,
----    data->>'longitude' AS longitude,
----    data->>'speed' AS speed
----    data->>'routeNumber' as routeNumber,
----    data->>'routeKey' as routeKey
--  FROM (SELECT
--            key
----            CAST(CONVERT_FROM(key, 'utf8') as text) as key
--            ,CAST(CONVERT_FROM(data, 'utf8') as text) AS data
--        FROM "materialize"."public"."src_driver_location")
  );
[0m20:48:28.069214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:28.846417 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.78 seconds
[0m20:48:28.862981 [debug] [Thread-1 (]: finished collecting timing info
[0m20:48:28.863293 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m20:48:28.864225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c18c7241-5fbe-489d-9ebc-e548b487aa80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1707b7b20>]}
[0m20:48:28.864684 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.json_driver_location ................... [[32mCREATE VIEW[0m in 0.82s]
[0m20:48:28.865486 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m20:48:28.866808 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m20:48:28.867386 [info ] [MainThread]: 
[0m20:48:28.867716 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m20:48:28.868004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:28.868149 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m20:48:28.875982 [info ] [MainThread]: 
[0m20:48:28.876290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:48:28.876541 [info ] [MainThread]: 
[0m20:48:28.876748 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:48:28.877043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a0c4dae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1a0c57d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe170790970>]}
[0m20:48:28.877263 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 21:03:40.519886 | 67675ad5-4304-4846-8ef7-6941af45b04a ==============================
[0m21:03:40.519928 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:03:40.520611 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:03:40.520737 [debug] [MainThread]: Tracking: tracking
[0m21:03:40.554399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa427277f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa42726350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa42727c70>]}
[0m21:03:40.601837 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 1 files changed.
[0m21:03:40.602088 [debug] [MainThread]: Partial parsing: deleted file: onward_materialize://models/materializedviews/staging/staging_json_driver_location.sql
[0m21:03:40.602176 [debug] [MainThread]: Partial parsing: deleted file: onward_materialize://models/sources/staging/staging_src_driver_location.sql
[0m21:03:40.602399 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m21:03:40.612700 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m21:03:40.634922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67675ad5-4304-4846-8ef7-6941af45b04a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa202dc0d0>]}
[0m21:03:40.639906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67675ad5-4304-4846-8ef7-6941af45b04a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa410e12d0>]}
[0m21:03:40.640103 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m21:03:40.640266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67675ad5-4304-4846-8ef7-6941af45b04a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa428dda50>]}
[0m21:03:40.641154 [info ] [MainThread]: 
[0m21:03:40.641721 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m21:03:40.642524 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m21:03:40.650388 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m21:03:40.650589 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m21:03:40.650687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:41.717109 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.07 seconds
[0m21:03:41.724058 [debug] [ThreadPool]: On list_materialize: Close
[0m21:03:41.726520 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m21:03:41.734472 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m21:03:41.734785 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m21:03:41.734957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:42.939047 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.2 seconds
[0m21:03:42.946769 [debug] [ThreadPool]: On list_materialize_public: Close
[0m21:03:42.948475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67675ad5-4304-4846-8ef7-6941af45b04a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa2030b040>]}
[0m21:03:42.949349 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:03:42.949692 [info ] [MainThread]: 
[0m21:03:42.956382 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m21:03:42.957092 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m21:03:42.957904 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m21:03:42.958109 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m21:03:42.958328 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m21:03:42.962174 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m21:03:42.962932 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:42.963073 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m21:03:42.977855 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m21:03:42.978051 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m21:03:42.978159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:43.896274 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.92 seconds
[0m21:03:43.909534 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m21:03:43.910502 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m21:03:43.910709 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');


--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
----  KEY FORMAT BYTES
----  VALUE FORMAT BYTES
--  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m21:03:44.375142 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.46 seconds
[0m21:03:44.392053 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:44.392374 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m21:03:44.393123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67675ad5-4304-4846-8ef7-6941af45b04a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa2030b040>]}
[0m21:03:44.393544 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.44s]
[0m21:03:44.395386 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m21:03:44.396024 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m21:03:44.396281 [info ] [Thread-1 (]: 2 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m21:03:44.396935 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m21:03:44.397112 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m21:03:44.397262 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m21:03:44.400576 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m21:03:44.401328 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:44.401524 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m21:03:44.411574 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m21:03:44.411777 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop view if exists "materialize"."public"."json_driver_location" cascade
    
[0m21:03:44.411904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:45.097780 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.69 seconds
[0m21:03:45.106870 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m21:03:45.109319 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m21:03:45.109507 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    


SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location";
  );
[0m21:03:45.177017 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Expected joined table, found comma
LINE 17: FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data ...
                         ^

[0m21:03:45.179187 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:45.179655 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m21:03:45.181655 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Expected joined table, found comma
  LINE 17: FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data ...
                           ^
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m21:03:45.182184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67675ad5-4304-4846-8ef7-6941af45b04a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa203950f0>]}
[0m21:03:45.182735 [error] [Thread-1 (]: 2 of 2 ERROR creating sql materializedview model public.json_driver_location ... [[31mERROR[0m in 0.79s]
[0m21:03:45.183337 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m21:03:45.184920 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m21:03:45.185705 [info ] [MainThread]: 
[0m21:03:45.186044 [info ] [MainThread]: Finished running 1 source model, 1 materializedview model in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m21:03:45.186310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:45.186448 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m21:03:45.197558 [info ] [MainThread]: 
[0m21:03:45.197900 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:03:45.198177 [info ] [MainThread]: 
[0m21:03:45.198430 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m21:03:45.198669 [error] [MainThread]:   Expected joined table, found comma
[0m21:03:45.198889 [error] [MainThread]:   LINE 17: FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data ...
[0m21:03:45.199108 [error] [MainThread]:                            ^
[0m21:03:45.199325 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m21:03:45.199556 [info ] [MainThread]: 
[0m21:03:45.199795 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:03:45.200176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa2036eb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa2036d570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa2036ff70>]}
[0m21:03:45.200461 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 21:04:18.389904 | 17cab43d-28a3-4ecc-bae1-d134f6f836fc ==============================
[0m21:04:18.390077 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:04:18.391069 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:04:18.391206 [debug] [MainThread]: Tracking: tracking
[0m21:04:18.416427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd99ead720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd99ead7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd99eac460>]}
[0m21:04:18.463919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:04:18.464290 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m21:04:18.475050 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m21:04:18.497934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17cab43d-28a3-4ecc-bae1-d134f6f836fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd88a500d0>]}
[0m21:04:18.502864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17cab43d-28a3-4ecc-bae1-d134f6f836fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd88988790>]}
[0m21:04:18.503073 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m21:04:18.503252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17cab43d-28a3-4ecc-bae1-d134f6f836fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd889ad690>]}
[0m21:04:18.504138 [info ] [MainThread]: 
[0m21:04:18.504537 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m21:04:18.505214 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m21:04:18.512411 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m21:04:18.512546 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m21:04:18.512638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:19.307178 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.79 seconds
[0m21:04:19.314236 [debug] [ThreadPool]: On list_materialize: Close
[0m21:04:19.316968 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m21:04:19.324200 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m21:04:19.324405 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m21:04:19.324558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:04:20.391629 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.07 seconds
[0m21:04:20.397317 [debug] [ThreadPool]: On list_materialize_public: Close
[0m21:04:20.398987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17cab43d-28a3-4ecc-bae1-d134f6f836fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd88a8aef0>]}
[0m21:04:20.399882 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:04:20.400212 [info ] [MainThread]: 
[0m21:04:20.406778 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m21:04:20.407418 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m21:04:20.408140 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m21:04:20.408331 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m21:04:20.408544 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m21:04:20.412666 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m21:04:20.413884 [debug] [Thread-1 (]: finished collecting timing info
[0m21:04:20.414112 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m21:04:20.429150 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m21:04:20.429407 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m21:04:20.429526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:21.456596 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.03 seconds
[0m21:04:21.469021 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m21:04:21.471146 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m21:04:21.471362 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');


--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
----  KEY FORMAT BYTES
----  VALUE FORMAT BYTES
--  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m21:04:21.954610 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.48 seconds
[0m21:04:21.971778 [debug] [Thread-1 (]: finished collecting timing info
[0m21:04:21.972293 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m21:04:21.973594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cab43d-28a3-4ecc-bae1-d134f6f836fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd88ac6b00>]}
[0m21:04:21.974147 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.57s]
[0m21:04:21.975098 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m21:04:21.976133 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m21:04:21.976544 [info ] [Thread-1 (]: 2 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m21:04:21.977271 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m21:04:21.977454 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m21:04:21.977613 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m21:04:21.981653 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m21:04:21.982308 [debug] [Thread-1 (]: finished collecting timing info
[0m21:04:21.982461 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m21:04:21.992961 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m21:04:21.993342 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m21:04:21.993492 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    


SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m21:04:21.993605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:22.929566 [debug] [Thread-1 (]: SQL status: CREATE MATERIALIZED VIEW in 0.94 seconds
[0m21:04:22.934839 [debug] [Thread-1 (]: finished collecting timing info
[0m21:04:22.935255 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m21:04:22.936386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cab43d-28a3-4ecc-bae1-d134f6f836fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd88b14ee0>]}
[0m21:04:22.936873 [info ] [Thread-1 (]: 2 of 2 OK created sql materializedview model public.json_driver_location ....... [[32mCREATE MATERIALIZED VIEW[0m in 0.96s]
[0m21:04:22.937424 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m21:04:22.938892 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m21:04:22.939557 [info ] [MainThread]: 
[0m21:04:22.939877 [info ] [MainThread]: Finished running 1 source model, 1 materializedview model in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m21:04:22.940101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:22.940196 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m21:04:22.950196 [info ] [MainThread]: 
[0m21:04:22.950551 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:04:22.950832 [info ] [MainThread]: 
[0m21:04:22.951075 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:04:22.951407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd88aed5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd88aec4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd88aee2c0>]}
[0m21:04:22.951653 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 21:04:35.748973 | 8c97c61b-8983-4db6-a976-b8110a1ca151 ==============================
[0m21:04:35.749030 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:04:35.749524 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:04:35.749640 [debug] [MainThread]: Tracking: tracking
[0m21:04:35.773937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82889ca8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82889cb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82889caa10>]}
[0m21:04:35.819681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:04:35.820201 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m21:04:35.829735 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m21:04:35.852065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c97c61b-8983-4db6-a976-b8110a1ca151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a84f00d0>]}
[0m21:04:35.856683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c97c61b-8983-4db6-a976-b8110a1ca151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8288b54790>]}
[0m21:04:35.856909 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m21:04:35.857105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c97c61b-8983-4db6-a976-b8110a1ca151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8288b71720>]}
[0m21:04:35.858047 [info ] [MainThread]: 
[0m21:04:35.858511 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m21:04:35.859193 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m21:04:35.866726 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m21:04:35.866902 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m21:04:35.866997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:36.638247 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.77 seconds
[0m21:04:36.644391 [debug] [ThreadPool]: On list_materialize: Close
[0m21:04:36.646843 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m21:04:36.654444 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m21:04:36.654673 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m21:04:36.654824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:04:37.355464 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.7 seconds
[0m21:04:37.362491 [debug] [ThreadPool]: On list_materialize_public: Close
[0m21:04:37.364146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c97c61b-8983-4db6-a976-b8110a1ca151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a852af80>]}
[0m21:04:37.365015 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:04:37.365386 [info ] [MainThread]: 
[0m21:04:37.372060 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m21:04:37.372691 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m21:04:37.373422 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m21:04:37.373613 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m21:04:37.373825 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m21:04:37.377973 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m21:04:37.378727 [debug] [Thread-1 (]: finished collecting timing info
[0m21:04:37.378931 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m21:04:37.395171 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m21:04:37.395555 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m21:04:37.395691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:38.383819 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.99 seconds
[0m21:04:38.395729 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m21:04:38.397182 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m21:04:38.397424 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');


--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
----  KEY FORMAT BYTES
----  VALUE FORMAT BYTES
--  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m21:04:38.849765 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.45 seconds
[0m21:04:38.867368 [debug] [Thread-1 (]: finished collecting timing info
[0m21:04:38.867852 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m21:04:38.868955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c97c61b-8983-4db6-a976-b8110a1ca151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a852af80>]}
[0m21:04:38.869483 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.50s]
[0m21:04:38.870550 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m21:04:38.871504 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m21:04:38.871845 [info ] [Thread-1 (]: 2 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m21:04:38.872587 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m21:04:38.872767 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m21:04:38.872941 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m21:04:38.876695 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m21:04:38.877380 [debug] [Thread-1 (]: finished collecting timing info
[0m21:04:38.877511 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m21:04:38.887694 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m21:04:38.887853 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop materialized view if exists "materialize"."public"."json_driver_location" cascade
    
[0m21:04:38.887968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:39.582057 [debug] [Thread-1 (]: SQL status: DROP MATERIALIZED VIEW in 0.69 seconds
[0m21:04:39.590808 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m21:04:39.591805 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m21:04:39.591937 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    


SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
--    to_timestamp(cast(data->>'timestamp' as double)) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m21:04:39.837798 [debug] [Thread-1 (]: SQL status: CREATE MATERIALIZED VIEW in 0.25 seconds
[0m21:04:39.844032 [debug] [Thread-1 (]: finished collecting timing info
[0m21:04:39.844377 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m21:04:39.845421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c97c61b-8983-4db6-a976-b8110a1ca151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a85bcee0>]}
[0m21:04:39.845878 [info ] [Thread-1 (]: 2 of 2 OK created sql materializedview model public.json_driver_location ....... [[32mCREATE MATERIALIZED VIEW[0m in 0.97s]
[0m21:04:39.846462 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m21:04:39.848051 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m21:04:39.848666 [info ] [MainThread]: 
[0m21:04:39.848956 [info ] [MainThread]: Finished running 1 source model, 1 materializedview model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m21:04:39.849211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:39.849343 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m21:04:39.860212 [info ] [MainThread]: 
[0m21:04:39.860566 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:04:39.860861 [info ] [MainThread]: 
[0m21:04:39.861121 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:04:39.861512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82889c2cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a859fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a859cca0>]}
[0m21:04:39.861789 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 21:07:01.157472 | 45f0b3aa-7be9-4ed5-85dc-b22c3b9c5395 ==============================
[0m21:07:01.157564 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:07:01.158350 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:07:01.158484 [debug] [MainThread]: Tracking: tracking
[0m21:07:01.182015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab25428f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab25430a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab2542a10>]}
[0m21:07:01.237317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:07:01.237693 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m21:07:01.250401 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m21:07:01.274266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45f0b3aa-7be9-4ed5-85dc-b22c3b9c5395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aa028c0d0>]}
[0m21:07:01.279861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45f0b3aa-7be9-4ed5-85dc-b22c3b9c5395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab2674790>]}
[0m21:07:01.280142 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m21:07:01.280378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45f0b3aa-7be9-4ed5-85dc-b22c3b9c5395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab2691720>]}
[0m21:07:01.281539 [info ] [MainThread]: 
[0m21:07:01.282082 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m21:07:01.282934 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m21:07:01.290534 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m21:07:01.290726 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m21:07:01.290843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:02.037519 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.75 seconds
[0m21:07:02.043680 [debug] [ThreadPool]: On list_materialize: Close
[0m21:07:02.046232 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m21:07:02.053865 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m21:07:02.054084 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m21:07:02.054195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:07:02.796093 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.74 seconds
[0m21:07:02.799657 [debug] [ThreadPool]: On list_materialize_public: Close
[0m21:07:02.801206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45f0b3aa-7be9-4ed5-85dc-b22c3b9c5395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aa02caf80>]}
[0m21:07:02.801961 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:07:02.802232 [info ] [MainThread]: 
[0m21:07:02.805849 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m21:07:02.806335 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m21:07:02.806876 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m21:07:02.807017 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m21:07:02.807155 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m21:07:02.810158 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m21:07:02.811189 [debug] [Thread-1 (]: finished collecting timing info
[0m21:07:02.811374 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m21:07:02.825881 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m21:07:02.826142 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m21:07:02.826274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:07:04.075705 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.25 seconds
[0m21:07:04.086194 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m21:07:04.087917 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m21:07:04.088091 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');


--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
----  KEY FORMAT BYTES
----  VALUE FORMAT BYTES
--  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m21:07:04.621712 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.53 seconds
[0m21:07:04.637546 [debug] [Thread-1 (]: finished collecting timing info
[0m21:07:04.637802 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m21:07:04.638658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45f0b3aa-7be9-4ed5-85dc-b22c3b9c5395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aa02caf80>]}
[0m21:07:04.639057 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.83s]
[0m21:07:04.640073 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m21:07:04.640703 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m21:07:04.641146 [info ] [Thread-1 (]: 2 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m21:07:04.642075 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m21:07:04.642356 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m21:07:04.642566 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m21:07:04.646377 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m21:07:04.648363 [debug] [Thread-1 (]: finished collecting timing info
[0m21:07:04.648708 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m21:07:04.658686 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m21:07:04.658912 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop materialized view if exists "materialize"."public"."json_driver_location" cascade
    
[0m21:07:04.659030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:07:05.293495 [debug] [Thread-1 (]: SQL status: DROP MATERIALIZED VIEW in 0.63 seconds
[0m21:07:05.303415 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m21:07:05.305789 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m21:07:05.305966 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    


SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    to_timestamp(data->>'timestamp') AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m21:07:05.369684 [debug] [Thread-1 (]: Postgres adapter: Postgres error: Cannot call function to_timestamp(text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts

[0m21:07:05.371547 [debug] [Thread-1 (]: finished collecting timing info
[0m21:07:05.372541 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m21:07:05.373957 [debug] [Thread-1 (]: Database Error in model json_driver_location (models/materializedviews/json_driver_location.sql)
  Cannot call function to_timestamp(text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
  compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m21:07:05.374299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45f0b3aa-7be9-4ed5-85dc-b22c3b9c5395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aa02a37f0>]}
[0m21:07:05.374723 [error] [Thread-1 (]: 2 of 2 ERROR creating sql materializedview model public.json_driver_location ... [[31mERROR[0m in 0.73s]
[0m21:07:05.375352 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m21:07:05.376621 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m21:07:05.377211 [info ] [MainThread]: 
[0m21:07:05.377498 [info ] [MainThread]: Finished running 1 source model, 1 materializedview model in 0 hours 0 minutes and 4.10 seconds (4.10s).
[0m21:07:05.377748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:07:05.377870 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m21:07:05.387155 [info ] [MainThread]: 
[0m21:07:05.387482 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:07:05.387750 [info ] [MainThread]: 
[0m21:07:05.387988 [error] [MainThread]: [33mDatabase Error in model json_driver_location (models/materializedviews/json_driver_location.sql)[0m
[0m21:07:05.388227 [error] [MainThread]:   Cannot call function to_timestamp(text): arguments cannot be implicitly cast to any implementation's parameters; try providing explicit casts
[0m21:07:05.388459 [error] [MainThread]:   compiled Code at target/run/onward_materialize/models/materializedviews/json_driver_location.sql
[0m21:07:05.388684 [info ] [MainThread]: 
[0m21:07:05.388910 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:07:05.389236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aa032f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aa032c670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aa032f010>]}
[0m21:07:05.389485 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 21:07:20.024800 | 1aec6e57-8ed5-401b-ae15-13e5297fb324 ==============================
[0m21:07:20.024872 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:07:20.027858 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:07:20.028008 [debug] [MainThread]: Tracking: tracking
[0m21:07:20.052437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a0aea9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a0aeb070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a0ae8e20>]}
[0m21:07:20.098818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:07:20.099265 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m21:07:20.108831 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m21:07:20.130863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aec6e57-8ed5-401b-ae15-13e5297fb324', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0c10ec0d0>]}
[0m21:07:20.135716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aec6e57-8ed5-401b-ae15-13e5297fb324', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0d08492d0>]}
[0m21:07:20.135927 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m21:07:20.136101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aec6e57-8ed5-401b-ae15-13e5297fb324', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a0c396f0>]}
[0m21:07:20.136996 [info ] [MainThread]: 
[0m21:07:20.137398 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m21:07:20.138120 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m21:07:20.145483 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m21:07:20.145682 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m21:07:20.145778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:20.915942 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.77 seconds
[0m21:07:20.922022 [debug] [ThreadPool]: On list_materialize: Close
[0m21:07:20.924650 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m21:07:20.931126 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m21:07:20.931319 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m21:07:20.931476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:07:21.781626 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.85 seconds
[0m21:07:21.788071 [debug] [ThreadPool]: On list_materialize_public: Close
[0m21:07:21.789628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aec6e57-8ed5-401b-ae15-13e5297fb324', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0c112af50>]}
[0m21:07:21.790473 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:07:21.790801 [info ] [MainThread]: 
[0m21:07:21.797685 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m21:07:21.798202 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m21:07:21.798806 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m21:07:21.798991 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m21:07:21.799205 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m21:07:21.803338 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m21:07:21.804137 [debug] [Thread-1 (]: finished collecting timing info
[0m21:07:21.804364 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m21:07:21.819769 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m21:07:21.819983 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m21:07:21.820103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:07:22.605694 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 0.79 seconds
[0m21:07:22.618484 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m21:07:22.620906 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m21:07:22.621105 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');


--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
----  KEY FORMAT BYTES
----  VALUE FORMAT BYTES
--  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m21:07:23.203139 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.58 seconds
[0m21:07:23.220047 [debug] [Thread-1 (]: finished collecting timing info
[0m21:07:23.220369 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m21:07:23.221176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aec6e57-8ed5-401b-ae15-13e5297fb324', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a0c1c8b0>]}
[0m21:07:23.221578 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.42s]
[0m21:07:23.222324 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m21:07:23.223014 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m21:07:23.223295 [info ] [Thread-1 (]: 2 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m21:07:23.223938 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m21:07:23.224108 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m21:07:23.224258 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m21:07:23.227709 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m21:07:23.229475 [debug] [Thread-1 (]: finished collecting timing info
[0m21:07:23.229644 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m21:07:23.239625 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m21:07:23.240060 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m21:07:23.240198 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    


SELECT
    CONVERT_FROM(key, 'utf8') as key,
    data->>'uid' AS uid,
    cast(data->>'timestamp' as timestamp) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m21:07:23.240323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:07:25.640429 [debug] [Thread-1 (]: SQL status: CREATE MATERIALIZED VIEW in 2.4 seconds
[0m21:07:25.646641 [debug] [Thread-1 (]: finished collecting timing info
[0m21:07:25.647045 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m21:07:25.648223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aec6e57-8ed5-401b-ae15-13e5297fb324', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0c11b0f40>]}
[0m21:07:25.648725 [info ] [Thread-1 (]: 2 of 2 OK created sql materializedview model public.json_driver_location ....... [[32mCREATE MATERIALIZED VIEW[0m in 2.42s]
[0m21:07:25.649240 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m21:07:25.650768 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m21:07:25.651395 [info ] [MainThread]: 
[0m21:07:25.651682 [info ] [MainThread]: Finished running 1 source model, 1 materializedview model in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m21:07:25.651944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:07:25.652076 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m21:07:25.661457 [info ] [MainThread]: 
[0m21:07:25.661788 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:07:25.662093 [info ] [MainThread]: 
[0m21:07:25.662356 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:07:25.662689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0c118d960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0c118f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0c118f850>]}
[0m21:07:25.662935 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 21:07:37.612060 | a90ec232-3037-4eb1-b6f6-423de800293d ==============================
[0m21:07:37.612116 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:07:37.612606 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:07:37.612716 [debug] [MainThread]: Tracking: tracking
[0m21:07:37.633323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c0baa8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c0bab0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8c0baaa10>]}
[0m21:07:37.674014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:07:37.674386 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m21:07:37.683932 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m21:07:37.707097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a90ec232-3037-4eb1-b6f6-423de800293d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8d02a00d0>]}
[0m21:07:37.712514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a90ec232-3037-4eb1-b6f6-423de800293d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb890b54790>]}
[0m21:07:37.712736 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m21:07:37.712919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a90ec232-3037-4eb1-b6f6-423de800293d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb890b75720>]}
[0m21:07:37.713843 [info ] [MainThread]: 
[0m21:07:37.714293 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m21:07:37.715052 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m21:07:37.722507 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m21:07:37.722650 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m21:07:37.722739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:38.870971 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.15 seconds
[0m21:07:38.877319 [debug] [ThreadPool]: On list_materialize: Close
[0m21:07:38.880039 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m21:07:38.887926 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m21:07:38.888173 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m21:07:38.888329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:07:39.952262 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.06 seconds
[0m21:07:39.957151 [debug] [ThreadPool]: On list_materialize_public: Close
[0m21:07:39.958795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a90ec232-3037-4eb1-b6f6-423de800293d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb890bc7400>]}
[0m21:07:39.959652 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:07:39.959983 [info ] [MainThread]: 
[0m21:07:39.964246 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m21:07:39.964922 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m21:07:39.965702 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m21:07:39.965901 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m21:07:39.966114 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m21:07:39.970911 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m21:07:39.971751 [debug] [Thread-1 (]: finished collecting timing info
[0m21:07:39.971969 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m21:07:39.987861 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m21:07:39.988150 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m21:07:39.988272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:07:41.725189 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.74 seconds
[0m21:07:41.738112 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m21:07:41.739241 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m21:07:41.739424 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');


--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
----  KEY FORMAT BYTES
----  VALUE FORMAT BYTES
--  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m21:07:42.481655 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.74 seconds
[0m21:07:42.498999 [debug] [Thread-1 (]: finished collecting timing info
[0m21:07:42.499433 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m21:07:42.500611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a90ec232-3037-4eb1-b6f6-423de800293d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8d02d7010>]}
[0m21:07:42.501088 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 2.54s]
[0m21:07:42.501879 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m21:07:42.502610 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m21:07:42.502946 [info ] [Thread-1 (]: 2 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m21:07:42.503624 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m21:07:42.503794 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m21:07:42.503956 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m21:07:42.507867 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m21:07:42.508803 [debug] [Thread-1 (]: finished collecting timing info
[0m21:07:42.508984 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m21:07:42.518930 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m21:07:42.519123 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop materialized view if exists "materialize"."public"."json_driver_location" cascade
    
[0m21:07:42.519242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:07:43.236396 [debug] [Thread-1 (]: SQL status: DROP MATERIALIZED VIEW in 0.72 seconds
[0m21:07:43.242608 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m21:07:43.243293 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m21:07:43.243459 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    


SELECT
    cast(CONVERT_FROM(key, 'utf8') as text) as key,
    data->>'uid' AS uid,
    cast(data->>'timestamp' as timestamp) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
FROM (SELECT key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m21:07:43.522239 [debug] [Thread-1 (]: SQL status: CREATE MATERIALIZED VIEW in 0.28 seconds
[0m21:07:43.528396 [debug] [Thread-1 (]: finished collecting timing info
[0m21:07:43.528644 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m21:07:43.529640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a90ec232-3037-4eb1-b6f6-423de800293d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8d036cee0>]}
[0m21:07:43.530100 [info ] [Thread-1 (]: 2 of 2 OK created sql materializedview model public.json_driver_location ....... [[32mCREATE MATERIALIZED VIEW[0m in 1.03s]
[0m21:07:43.530593 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m21:07:43.532196 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m21:07:43.532784 [info ] [MainThread]: 
[0m21:07:43.533061 [info ] [MainThread]: Finished running 1 source model, 1 materializedview model in 0 hours 0 minutes and 5.82 seconds (5.82s).
[0m21:07:43.533325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:07:43.533456 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m21:07:43.543553 [info ] [MainThread]: 
[0m21:07:43.543931 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:07:43.544224 [info ] [MainThread]: 
[0m21:07:43.544472 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:07:43.544808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8d0349570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8d034b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8d0348c10>]}
[0m21:07:43.545067 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 21:09:20.671387 | 8ce21367-91b2-4b16-9dcf-2feda17cb231 ==============================
[0m21:09:20.671496 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:09:20.672323 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/claytonvanhovel/Desktop/onward-materialize-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:09:20.672483 [debug] [MainThread]: Tracking: tracking
[0m21:09:20.714436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23817d660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23817de40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23817d780>]}
[0m21:09:20.767732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:09:20.768094 [debug] [MainThread]: Partial parsing: updated file: onward_materialize://models/materializedviews/json_driver_location.sql
[0m21:09:20.781876 [debug] [MainThread]: 1699: static parser successfully parsed materializedviews/json_driver_location.sql
[0m21:09:20.805191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ce21367-91b2-4b16-9dcf-2feda17cb231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2682d80d0>]}
[0m21:09:20.812545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ce21367-91b2-4b16-9dcf-2feda17cb231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2180e7fa0>]}
[0m21:09:20.812841 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m21:09:20.813042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ce21367-91b2-4b16-9dcf-2feda17cb231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2180d1750>]}
[0m21:09:20.814374 [info ] [MainThread]: 
[0m21:09:20.814898 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m21:09:20.816116 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize"
[0m21:09:20.824023 [debug] [ThreadPool]: Using materialize connection "list_materialize"
[0m21:09:20.824187 [debug] [ThreadPool]: On list_materialize: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize"} */

    select distinct nspname from pg_namespace
  
[0m21:09:20.824277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:22.358828 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.53 seconds
[0m21:09:22.362681 [debug] [ThreadPool]: On list_materialize: Close
[0m21:09:22.364993 [debug] [ThreadPool]: Acquiring new materialize connection "list_materialize_public"
[0m21:09:22.370080 [debug] [ThreadPool]: Using materialize connection "list_materialize_public"
[0m21:09:22.370306 [debug] [ThreadPool]: On list_materialize_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "connection_name": "list_materialize_public"} */
select
        d.name as database,
        s.name as schema,
        o.name,
        case when o.type = 'materialized-view' then 'materializedview' else o.type end as type
    from mz_objects o
    join mz_schemas s on o.schema_id = s.id and s.name = 'public'
    join mz_databases d on s.database_id = d.id and d.name = 'materialize'
    where type in ('table', 'source', 'view', 'materialized-view', 'index', 'sink')
  
[0m21:09:22.370534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:09:23.458000 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.09 seconds
[0m21:09:23.468113 [debug] [ThreadPool]: On list_materialize_public: Close
[0m21:09:23.473357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ce21367-91b2-4b16-9dcf-2feda17cb231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff268312fb0>]}
[0m21:09:23.475865 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:09:23.476417 [info ] [MainThread]: 
[0m21:09:23.484263 [debug] [Thread-1 (]: Began running node model.onward_materialize.src_driver_location
[0m21:09:23.485093 [info ] [Thread-1 (]: 1 of 2 START sql source model public.src_driver_location ....................... [RUN]
[0m21:09:23.485848 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.src_driver_location"
[0m21:09:23.486053 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.src_driver_location
[0m21:09:23.486237 [debug] [Thread-1 (]: Compiling model.onward_materialize.src_driver_location
[0m21:09:23.490122 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.src_driver_location"
[0m21:09:23.490810 [debug] [Thread-1 (]: finished collecting timing info
[0m21:09:23.490993 [debug] [Thread-1 (]: Began executing node model.onward_materialize.src_driver_location
[0m21:09:23.510443 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m21:09:23.510839 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */

      drop source if exists "materialize"."public"."src_driver_location" cascade
    
[0m21:09:23.510992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:09:24.684025 [debug] [Thread-1 (]: SQL status: DROP SOURCE in 1.17 seconds
[0m21:09:24.710623 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.src_driver_location"
[0m21:09:24.711742 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.src_driver_location"
[0m21:09:24.711914 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.src_driver_location"} */


CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
  KEY FORMAT BYTES
  VALUE FORMAT BYTES
  ENVELOPE UPSERT
  WITH (SIZE = '3xsmall');


--  CREATE SOURCE IF NOT EXISTS "materialize"."public"."src_driver_location"
--  FROM KAFKA CONNECTION kafka_connection (TOPIC 'driver_location')
----  KEY FORMAT BYTES
----  VALUE FORMAT BYTES
--  FORMAT BYTES
--  WITH (SIZE = '3xsmall');


-- where id is not null
[0m21:09:25.132099 [debug] [Thread-1 (]: SQL status: CREATE SOURCE in 0.42 seconds
[0m21:09:25.162383 [debug] [Thread-1 (]: finished collecting timing info
[0m21:09:25.162802 [debug] [Thread-1 (]: On model.onward_materialize.src_driver_location: Close
[0m21:09:25.163892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ce21367-91b2-4b16-9dcf-2feda17cb231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff268312fb0>]}
[0m21:09:25.164436 [info ] [Thread-1 (]: 1 of 2 OK created sql source model public.src_driver_location .................. [[32mCREATE SOURCE[0m in 1.68s]
[0m21:09:25.167132 [debug] [Thread-1 (]: Finished running node model.onward_materialize.src_driver_location
[0m21:09:25.168141 [debug] [Thread-1 (]: Began running node model.onward_materialize.json_driver_location
[0m21:09:25.168411 [info ] [Thread-1 (]: 2 of 2 START sql materializedview model public.json_driver_location ............ [RUN]
[0m21:09:25.169083 [debug] [Thread-1 (]: Acquiring new materialize connection "model.onward_materialize.json_driver_location"
[0m21:09:25.169262 [debug] [Thread-1 (]: Began compiling node model.onward_materialize.json_driver_location
[0m21:09:25.169438 [debug] [Thread-1 (]: Compiling model.onward_materialize.json_driver_location
[0m21:09:25.173324 [debug] [Thread-1 (]: Writing injected SQL for node "model.onward_materialize.json_driver_location"
[0m21:09:25.174354 [debug] [Thread-1 (]: finished collecting timing info
[0m21:09:25.174555 [debug] [Thread-1 (]: Began executing node model.onward_materialize.json_driver_location
[0m21:09:25.185138 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m21:09:25.185337 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */

      drop materialized view if exists "materialize"."public"."json_driver_location" cascade
    
[0m21:09:25.185514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:09:25.857549 [debug] [Thread-1 (]: SQL status: DROP MATERIALIZED VIEW in 0.67 seconds
[0m21:09:25.871663 [debug] [Thread-1 (]: Writing runtime sql for node "model.onward_materialize.json_driver_location"
[0m21:09:25.875035 [debug] [Thread-1 (]: Using materialize connection "model.onward_materialize.json_driver_location"
[0m21:09:25.875362 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "default", "target_name": "prod", "node_id": "model.onward_materialize.json_driver_location"} */
create materialized view "materialize"."public"."json_driver_location"
  
    in cluster default
  
  as (
    


SELECT
    key,
    data->>'uid' AS uid,
    cast(data->>'timestamp' as timestamp) AS timestamp,
    data->>'latitude' AS latitude,
    data->>'longitude' AS longitude,
    data->>'speed' AS speed
FROM (SELECT CONVERT_FROM(key, 'utf8') as key, CONVERT_FROM(data, 'utf8')::jsonb AS data FROM "materialize"."public"."src_driver_location")
  );
[0m21:09:26.185140 [debug] [Thread-1 (]: SQL status: CREATE MATERIALIZED VIEW in 0.31 seconds
[0m21:09:26.195493 [debug] [Thread-1 (]: finished collecting timing info
[0m21:09:26.196353 [debug] [Thread-1 (]: On model.onward_materialize.json_driver_location: Close
[0m21:09:26.199203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ce21367-91b2-4b16-9dcf-2feda17cb231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff268400f10>]}
[0m21:09:26.200955 [info ] [Thread-1 (]: 2 of 2 OK created sql materializedview model public.json_driver_location ....... [[32mCREATE MATERIALIZED VIEW[0m in 1.03s]
[0m21:09:26.202854 [debug] [Thread-1 (]: Finished running node model.onward_materialize.json_driver_location
[0m21:09:26.206465 [debug] [MainThread]: Acquiring new materialize connection "master"
[0m21:09:26.207228 [info ] [MainThread]: 
[0m21:09:26.207477 [info ] [MainThread]: Finished running 1 source model, 1 materializedview model in 0 hours 0 minutes and 5.39 seconds (5.39s).
[0m21:09:26.207681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:09:26.207781 [debug] [MainThread]: Connection 'model.onward_materialize.json_driver_location' was properly closed.
[0m21:09:26.218895 [info ] [MainThread]: 
[0m21:09:26.219252 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:09:26.219547 [info ] [MainThread]: 
[0m21:09:26.219797 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:09:26.220137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff268374c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2683765c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff268374700>]}
[0m21:09:26.220407 [debug] [MainThread]: Flushing usage events
